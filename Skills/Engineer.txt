Task:
Установка Subversion - система контроля версий
Decision:
# yum list | grep subversion
subversion.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 @AppStream
subversion-libs.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 @AppStream
subversion-devel.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream
subversion-gnome.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream
subversion-javahl.noarch 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream
subversion-perl.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream
subversion-tools.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream
# yum -y install subversion
# svnversion --version
Task:
Обновление рабочей копии
Decision:
svn update
Task:
Внесение изменений
Decision:
svn add
svn delete
svn copy
svn move
Task:
Анализ изменений
Decision:
svn status
svn diff
svn revert
Task:
Слияние изменений, выполненных другими, с вашей рабочей копией
Decision:
svn update
svn resolved
Task:
Фиксация изменений
Decision:
svn commit
Task:
Работаем с репозиторием
Decision:
# vim /etc/xinetd.d/ssh 
# cat /etc/xinetd.d/ssh
service ssh 
{
disable = yes
socket_type = stream
protocol = tcp
port = 22
wait = no
user = root
server = /usr/sbin/sshd
server_args = -i
only_from = 192.168.0.0
}
# systemctl restart xinetd
# systemctl restart sshd
Task:
Для удобства работы я настроил работу по ключам у себя на машине, чтобы не приходилось вводить пароль каждый раз когда его спросят.
Decision:
# ssh-keygen -t rsa
# ssh-copy-id -i ~/.ssh/id_rsa.pub root@localhost
/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@localhost's password:
Number of key(s) added: 1
Now try logging into the machine, with: "ssh 'root@localhost'"
and check to make sure that only the key(s) you wanted were added.
# mkdir /svn
Task:
Создаем репозиторий
Decision:
# svnadmin create /svn/myrepo
# svn info file:///svn/myrepo/
Path: myrepo
URL: file:///svn/myrepo
Relative URL: ^/
Repository Root: file:///svn/myrepo
Repository UUID: bbe1dc47-235c-4cf4-b253-af3d81a943a3
Revision: 0
Node Kind: directory
Last Changed Rev: 0
Last Changed Date: 2020-04-09 21:36:41 -0400 (Чт, 09 апр 2020)
Task:
Репозиторий пустой о чем говорит “Revision: 0”. С каждым новым измением в репозитории номер ревизии будет увеличиваться на единицу.
В каталоге docs я подготовил несколько файлов которые положат начало новому репозиторию
Decision:
# ls -l docs
итого 12
-rw-r--r--. 1 root root 14 апр 9 21:40 file1
-rw-r--r--. 1 root root 14 апр 9 21:40 file2
-rw-r--r--. 1 root root 15 апр 9 21:40 file3
# svn import docs file:///svn/myrepo/ -m "start the dance"
Adding docs/file1
Adding docs/file2
Adding docs/file3
Committing transaction...
Committed revision 1.
# svn info file:///svn/myrepo/
Path: myrepo
URL: file:///svn/myrepo
Relative URL: ^/
Repository Root: file:///svn/myrepo
Repository UUID: bbe1dc47-235c-4cf4-b253-af3d81a943a3
Revision: 1
Node Kind: directory
Last Changed Author: root
Last Changed Rev: 1
Last Changed Date: 2020-04-09 21:41:48 -0400 (Чт, 09 апр 2020)
# svn list file:///svn/myrepo/
file1
file2
file3
Task:
У нас получился репозиторий с тремя файлами. Теперь мы создадим рабочую копию этого репозитория и поработаем с ней.
Decision:
# svn co file:///svn/myrepo/
A myrepo/file1
A myrepo/file2
A myrepo/file3
Checked out revision 1.
# ls -l
итого 0
drwxr-xr-x. 2 root root 45 апр 9 21:40 docs
drwxr-xr-x. 3 root root 57 апр 9 21:43 myrepo
# cd myrepo/
# ls -l
итого 12
-rw-r--r--. 1 root root 14 апр 9 21:43 file1
-rw-r--r--. 1 root root 14 апр 9 21:43 file2
-rw-r--r--. 1 root root 15 апр 9 21:43 file3
# echo "new line" >> file1
# cat myrepo/file1
it is file 1
new line
new line2
# svn commit -m "file1 has been modified"
Sending file1
Transmitting file data .done
Committing transaction...
Committed revision 2.
# ls -l /svn/myrepo
итого 12
drwxr-xr-x. 2 root root 76 апр 9 21:36 conf
drwxr-sr-x. 6 root root 4096 апр 9 21:46 db
-r--r--r--. 1 root root 2 апр 9 21:36 format
drwxr-xr-x. 2 root root 231 апр 9 21:36 hooks
drwxr-xr-x. 2 root root 41 апр 9 21:36 locks
-rw-r--r--. 1 root root 246 апр 9 21:36 README.txt
# ifconfig
...
inet 192.168.0.104
...
Decision:
# yum -y install subversion
# pwd
/home/linux
Task:
Получение копии репозитория с удаленного сервера где у вас есть аккаунт
Убедитесь, что пользователь включен в нужную группу для доступа к репозиториям.
Decision:
# svn co svn+ssh://root@192.168.0.104/svn/myrepo
root@192.168.0.104's password:
A myrepo/file1
A myrepo/file2
A myrepo/file3
Получена редакция 3.
# ls myrepo/
file1 file2 file3
# cd myrepo/
# cat file2
it is file 2
# vim file2
# cat file2
it is file 2
new modificate 1
# svn commit -m "file2 has been modified"
root@192.168.0.104's password:
Посылаю file2
Передаю данные .done
Committing transaction...
Committed revision 4.
# cat file3
it is file 3
# vim file3
# cat file3
it is file 3
new file3
# svn commit -m "file3 has been modified"
Sending file3
Transmitting file data .done
Committing transaction...
Committed revision 5.
# svn info file:///svn/myrepo
Path: myrepo
URL: file:///svn/myrepo
Relative URL: ^/
Repository Root: file:///svn/myrepo
Repository UUID: bbe1dc47-235c-4cf4-b253-af3d81a943a3
Revision: 5
Node Kind: directory
Last Changed Author: root
Last Changed Rev: 5
Last Changed Date: 2020-04-29 07:43:37 -0400 (Ср, 29 апр 2020)
# cat file3
it is file 3
# vim file3
# cat file3
it is file 3
modified ubuntu3
# svn commit -m "file3 has been modified ubuntu3"
root@192.168.0.104's password:
Посылаю file3
Передаю данные .done
Committing transaction...
svn: E160028: Фиксация не удалась (подробности приведены ниже):
svn: E160028: File '/file3' is out of date
# svn update
Updating '.':
root@192.168.0.104's password:
C file3
Обновлено до редакции 5.
Summary of conflicts:
Text conflicts: 1
Conflict discovered in file 'file3'.
Select: (p) postpone, (df) show diff, (e) edit file, (m) merge,
(mc) my side of conflict, (tc) their side of conflict,
(s) show all options: m
Merging 'file3'.
Conflicting section found during merge:
(1) their version (at line 2) |(2) your version (at line 2)
--------------------------------------+--------------------------------------
new file3 |modified ubuntu3
--------------------------------------+--------------------------------------
Select: (1) use their version, (2) use your version,
(12) their version first, then yours,
(21) your version first, then theirs,
(e1) edit their version and use the result,
(e2) edit your version and use the result,
(eb) edit both versions and use the result,
(p) postpone this conflicting section leaving conflict markers,
(a) abort file merge and return to main menu: 2
Merge of 'file3' completed.
Select: (p) postpone, (df) show diff, (e) edit file, (m) merge,
(r) mark resolved, (mc) my side of conflict,
(tc) their side of conflict, (s) show all options: p
Summary of conflicts:
Text conflicts: 1
# ls
file1 file2 file3 file3.mine file3.r3 file3.r5
# cat file3.r3
it is file 3
# cat file3.r5
it is file 3
new file3
# cat file3.mine
it is file 3
modified ubuntu3
# rm -f file3.r3 file3.r5 file3.mine
# vim file3
# cat file3
it is file 3
modified ubuntu3
# svn commit -m "file3 has been modified ubuntu3"
root@192.168.0.104's password:
Посылаю file3
Передаю данные .done
Committing transaction...
Committed revision 6.
# svn update
Updating '.':
U file3
U file2
Updated to revision 6.
# ls -l
итого 12
-rw-r--r--. 1 root root 33 апр 29 06:47 file1
-rw-r--r--. 1 root root 30 апр 29 07:57 file2
-rw-r--r--. 1 root root 30 апр 29 07:57 file3
# cat file3
it is file 3
modified ubuntu3
Task:
Системный пользователь, который не является членом группы agents
Decision:
# svn list svn+ssh://mybestuser@linuxbox/svn/myrepo 
mybestuser@linuxbox's password:
file1
file2
file3
secret/
# svn list svn+ssh://mybestuser@linuxbox/svn/myrepo/secret
mybestuser@linuxbox's password:
svn: Authorization failed
# svn list svn+ssh://mybestuser@linuxbox/svn/myrepo/secret/public
mybestuser@linuxbox’s password:
file3
Task:
Ограничение доступа
У нас уже есть репозиторий /svn/myrepo и сейчас мы разберемся с правами доступа к нему.
Decision:
# useradd james
# passwd james
# ls -l /svn/myrepo/conf/
итого 20
-rw-r--r--. 1 root root 1080 апр 9 21:36 authz
-rw-r--r--. 1 root root 885 апр 9 21:36 hooks-env.tmpl
-rw-r--r--. 1 root root 309 апр 9 21:36 passwd
-rw-r--r--. 1 root root 4391 апр 29 08:05 svnserve.conf
# vim /svn/myrepo/conf/svnserve.conf
# cat /svn/myrepo/conf/svnserve.conf
...
[general]
anon-access = none
#auth-access = write
#password-db = passwd
authz-db = authz
#realm = Bunch_Of_My_Repos
Task:
Передаваемая информация не шифруется. Этот способ устарел и я не рекомендую его использовать. Чтобы вы примерно понимали что это за файл я вам приведу пример
Decision:
# cat /svn/myrepo/conf/passwd
[users]
# harry = harryssecret
# sally = sallyssecret
# cat /svn/myrepo/conf/passwd
This file is an example password file for svnserve.
### Its format is similar to that of svnserve.conf. As shown in the
### example below it contains one section labelled [users].
### The name and password for each user follow, one account per line.
[users]
#harry = harryssecret
#sally = sallyssecret
james = qaz
Task:
В файле svnserve.conf раскоментируем строку password-db = passwd, в файл authz добавим запись для пользователя harry если общая политика ему не подходит.
Decision:
# vim /svn/myrepo/conf/svnserve.conf
...
[general]
anon-access = none
#auth-access = write
password-db = passwd
authz-db = authz
#realm = Bunch_Of_My_Repos
Task:
Запустим службу svnserve
Decision:
# svnserve -d
# svn list svn://harry@thost1/svn/myrepo
Authentication realm: <svn://thost1:3690> bbe1dc47-235c-4cf4-b253-af3d81a943a3
Password for 'root': *************
Authentication realm: <svn://thost1:3690> bbe1dc47-235c-4cf4-b253-af3d81a943a3
Username: james
Password for 'james': ***
-----------------------------------------------------------------------
ATTENTION! Your password for authentication realm:
<svn://thost1:3690> bbe1dc47-235c-4cf4-b253-af3d81a943a3
can only be stored to disk unencrypted! You are advised to configure
your system so that Subversion can store passwords encrypted, if
possible. See the documentation for details.
You can avoid future appearances of this warning by setting the value
of the 'store-plaintext-passwords' option to either 'yes' or 'no' in
'/root/.subversion/servers'.
-----------------------------------------------------------------------
Store password unencrypted (yes/no)? yes
file1
file2
file3
Task:
В том же каталоге где и svnserve.conf (<путь к репозиторию>/conf/) создаем файл authz и вносим в него конфигурацию
Decision:
# vim /svn/myrepo/conf/authz
# cat /svn/myrepo/conf/authz
agents = james, piter
[/]
*=r
[/secret]
@agents = rw
*=
[/secret/public]
* = rw
Task:
Системный пользователь, который является членом группы agents
Decision:
# svn list svn+ssh://james@192.168.0.104/svn/myrepo
james@linuxbox's password:
file1
file2
file3
secret/
# svn list svn+ssh://james@192.168.0.104/svn/myrepo/secret
james@linuxbox's password:
file1
file2
file3
public/
# svn list svn+ssh://james@192.168.0.104/svn/myrepo/secret/public
james@linuxbox’s password:
file3
Source:
https://www.youtube.com/playlist?list=PLtSGboPf3g50Aejrp6KjQsqqjxvAO4aKw
https://www.youtube.com/playlist?list=PLdEqf7lxtAH--exov42yypdvOi7bDqoBQ
https://losst.ru/proverka-linux-na-virusy
https://www.youtube.com/watch?v=t6wO3qsxrSo&list=PL76C3E97EB0FDB323&index=18&t=0s
https://linuxconfig.org/how-to-install-xinetd-service-in-redhat-8
Task:
Система инициализации systemd
Зайдите в rescue.target, посмотрите содержимое fstab, после чего вернитесь в graphical.target.
Decision:
$ systemctl get-default
graphical.target
$ systemctl list-units --type target --all
  UNIT                                                                          
  ...                                                                 
  graphical.target                                                              
  ...                                                             
  multi-user.target                                                             
  ...                                                           
  rescue.target                                                                                                                              
lines 11-33
$ sudo systemctl set-default rescue.target
Removed /etc/systemd/system/default.target.
Created symlink /etc/systemd/system/default.target → /usr/lib/systemd/system/rescue.target.
$ systemctl get-default
rescue.target
$ cat /usr/lib/systemd/system/rescue.target
#  SPDX-License-Identifier: LGPL-2.1+
#
#  This file is part of systemd.
#
#  systemd is free software; you can redistribute it and/or modify it
#  under the terms of the GNU Lesser General Public License as published by
#  the Free Software Foundation; either version 2.1 of the License, or
#  (at your option) any later version.
[Unit]
Description=Rescue Mode
Documentation=man:systemd.special(7)
Requires=sysinit.target rescue.service
After=sysinit.target rescue.service
AllowIsolate=yes
$ sudo cat /etc/fstab
#
# /etc/fstab
# Created by anaconda on Mon Mar 21 05:33:35 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk/'.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run 'systemctl daemon-reload' to update systemd
# units generated from this file.
#
/dev/mapper/ro_redos-root /                       ext4    defaults        1 1
UUID=2fefa97c-6093-43b9-99f0-23f8a1467990 /boot                   ext4    defaults        1 2
/dev/mapper/ro_redos-swap none                    swap    defaults        0 0
$ sudo systemctl set-default graphical.target
Removed /etc/systemd/system/default.target.
Created symlink /etc/systemd/system/default.target → /usr/lib/systemd/system/graphical.target.
$ systemctl get-default
graphical.target
Task:
Сделайте multi-user.target режимом по умолчанию.
Decision:
$ sudo systemctl set-default multi-user.target
Removed /etc/systemd/system/default.target.
Created symlink /etc/systemd/system/default.target → /usr/lib/systemd/system/multi-user.target.
$ systemctl get-default
multi-user.target
Task:
Управление процессами.
Сохраните в отдельном файле и прокомментируйте данные о процессе init
Decision:
$ ps aux -p 1 > processes.txt
# выводим содержимое файла processes.txt на экран. поле USER отображает имя пользователя, запустившего процесс, PID - идентификатор процесса, %CPU - уровень использования процессора, %MEM - уровень использования памяти, VSZ - объём используемой виртуальной памяти, RSS - объём используемой реальной памяти, TTY - терминал, с которым связан процесс("?" потому, что init это первый системный процесс и он не связан ни с одним терминалом), STAT - состояние выполнения("S" - означает, что процесс бездействует, "s" - то что процесс лидер сеанса), START - время старта, TIME - время исполнения (на процессоре), COMMAND - имя программы.
$ cat processes.txt
USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
root 1 0.7 0.0 1628 536 ? Ss 13:53 0:01 /sbin/init splash
Task:
Сохраните листинг самых ресурсоемких процессов и прокомментируйте его.
Decision:
$ ps aux --sort -pcpu | head -n 3
USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
root 4997 5.5 3.8 127632 40044 ? SLl 11:56 0:16 amarok
root 5304 3.9 0.0 1852 776 ? RN 12:00 0:01 /usr/bin/updatedb
# поле USER отображает имя пользователя, запустившего процесс, PID - идентификатор процесса, %CPU - уровень использования процессора, %MEM - уровень использования памяти, VSZ - объём используемой виртуальной памяти, RSS - объём используемой реальной памяти, TTY - терминал, с которым связан процесс, STAT - состояние выполнения, START - время старта, TIME - время исполнения (на процессоре), COMMAND - имя программы.
# в выводе этого листинга видно, что процесс amarok с PID 4997, созданный пользователем root является самым ресурсоемким по использованию процессора. он использует процессор на 5.5, память на 3.8, его виртуальная память 127632, реальная память 40044, он не прикреплен ни к одному терминалу, его статус: "S" - означает, что процесс бездействует(ожидает выполнения), "L" - означает что это real-time процесс, имеются страницы заблокированные в памяти, время запуска процесса 11 часов 56 минут, время выполнения 16 секунд.
$ ps aux --sort -pmem | head -n 3
USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
root 1 0.2 0.1 1628 536 ? Ss 11:54 0:02 /sbin/init splash
root 2 0.0 0.0 0 0 ? S 11:54 0:00 [migration/0]
# поле USER отображает имя пользователя, запустившего процесс, PID - идентификатор процесса, %CPU - уровень использования процессора, %MEM - уровень использования памяти, VSZ - объём используемой виртуальной памяти, RSS - объём используемой реальной памяти, TTY - терминал, с которым связан процесс, STAT - состояние выполнения, START - время старта, TIME - время исполнения (на процессоре), COMMAND - имя программы.
# в выводе этого листинга видно, что процесс "/sbin/init splash" с PID 1, созданный пользователем root является самым ресурсоемким по использованию оперативной памяти. он использует процессор на 0.2, память на 0.1, его виртуальная память 1628, реальная память 536, он не прикреплен ни к одному терминалу, его статус: "S" - означает, что процесс бездействует, "s" - то что процесс лидер сеанса, время запуска процесса 11 часов 54 минуты, время выполнения 2 секунды.
Task:
Запустите gedit, найдите его pid, найдите pid его родительского процесса и так по цепочке все родительские pid-ы.
Decision:
[centos@cs ~]$ gedit &
[1] 3965
[centos@cs ~]$ ps | grep gedit
3965 pts/1 00:00:01 gedit
[centos@cs ~]$ ps -ef | grep gedit
centos 3965 3218 1 10:01 pts/1 00:00:01 gedit
centos 4039 3218 0 10:03 pts/1 00:00:00 grep --color=auto gedit
[centos@cs ~]$ ps -f 3218
UID PID PPID C STIME TTY STAT TIME CMD
centos 3218 3215 0 09:25 pts/1 Ss 0:00 -bash
[centos@cs ~]$ ps -f 3215
UID PID PPID C STIME TTY STAT TIME CMD
centos 3215 3208 0 09:25 ? S 0:00 sshd: centos@pts/1
[centos@cs ~]$ ps -f 3208
UID PID PPID C STIME TTY STAT TIME CMD
root 3208 1013 0 09:25 ? Ss 0:00 sshd: centos [priv]
[centos@cs ~]$ ps -f 1013
UID PID PPID C STIME TTY STAT TIME CMD
root 1013 1 0 09:17 ? Ss 0:00 /usr/sbin/sshd -D -oCiphers=aes256-gcm@openssh.com,chacha20-poly1
[centos@cs ~]$ ps -f 1
UID PID PPID C STIME TTY STAT TIME CMD
root 1 0 0 09:15 ? Ss 0:05 /usr/lib/systemd/systemd --switched-root --system --deserialize 1
Task:
Запустите форк-бомбу :
:(){ :|:& };:
Затем перезагрузите виртуалку, ограничьте количество процессов у своего пользователя до 50 и заново запустите форк-бомбу.
Decision:
[centos@cs ~]$ :(){ :|:& };:
[2] 4788
[centos@cs ~]$ -bash: fork: retry: Resource temporarily unavailable
-bash: fork: retry: Resource temporarily unavailable
...
-bash: fork: retry: Resource temporarily unavailable
-bash: fork: Resource temporarily unavailable
client_loop: send disconnect: Connection reset
C:\Users\tuser>
C:\Users\tuser>ssh centos@tipcentos
centos@tipcentos's password:
Activate the web console with: systemctl enable --now cockpit.socket
Last login: Sat Jan 22 09:25:45 2022 from tip
[centos@cs ~]$ vim ~/.bash_profile
[centos@cs ~]$ cat ~/.bash_profile
# .bash_profile
# Get the aliases and functions
if [ -f ~/.bashrc ]; then
. ~/.bashrc
fi
# User specific environment and startup programs
# Limits
ulimit -u 50
[centos@cs ~]$ :(){ :|:& };:
Task:
Запустите любой процесс в фоновом режиме (к примеру, gedit). Найдите его родительский процесс. Найдите все дочерние процессы, которые принадлежат этому родительскому процессу. Убейте родительский процесс. Проверьте дочерние процессы и найдите новый родительский процесс.
Decision:
[centos@cs ~]$ gedit &
[1] 5380
[centos@cs ~]$ ps -ef | grep gedit
centos 5215 5164 0 12:30 pts/0 00:00:01 gedit
centos 5387 5285 0 12:34 pts/2 00:00:00 grep --color=auto gedit
[centos@cs ~]$ ps -f 5164
UID PID PPID C STIME TTY STAT TIME CMD
centos 5164 5159 0 12:30 pts/0 Ss+ 0:00 bash
[centos@cs ~]$ ps -ef | grep 5164
centos 5164 5159 0 12:30 pts/0 00:00:00 bash
centos 5215 5164 0 12:30 pts/0 00:00:01 gedit
centos 5406 5285 0 12:35 pts/2 00:00:00 grep --color=auto 5164
[centos@cs ~]$ pstree -p | grep gedit
| |-gnome-terminal-(5159)-+-bash(5164)---gedit(5215)-+-{gedit}(5222)
| | | |-{gedit}(5223)
| | | `-{gedit}(5224)
[centos@cs ~]$ ps -xal | grep gedit
0 1000 5215 5164 20 0 566668 52284 x64_sy Sl pts/0 0:01 gedit
0 1000 5442 5285 20 0 12136 1104 - S+ pts/2 0:00 grep --color=auto gedit
[centos@cs ~]$ kill -KILL 5164
[centos@cs ~]$ ps -ef | grep gedit
centos 5215 2331 0 12:30 ? 00:00:01 gedit
centos 5552 5285 0 12:40 pts/2 00:00:00 grep --color=auto gedit
[centos@cs ~]$ ps 2331
PID TTY STAT TIME COMMAND
2331 ? Ss 0:00 /usr/lib/systemd/systemd --user
[centos@cs ~]$ ps 1
PID TTY STAT TIME COMMAND
1 ? Ss 0:06 /usr/lib/systemd/systemd --switched-root --system --deserialize 17
Task:
получить полный список сигналов
Decision:
$ kill -l
 1) SIGHUP     2) SIGINT     3) SIGQUIT     4) SIGILL     5) SIGTRAP
 6) SIGABRT     7) SIGBUS     8) SIGFPE     9) SIGKILL    10) SIGUSR1
11) SIGSEGV    12) SIGUSR2    13) SIGPIPE    14) SIGALRM    15) SIGTERM
16) SIGSTKFLT    17) SIGCHLD    18) SIGCONT    19) SIGSTOP    20) SIGTSTP
21) SIGTTIN    22) SIGTTOU    23) SIGURG    24) SIGXCPU    25) SIGXFSZ
26) SIGVTALRM    27) SIGPROF    28) SIGWINCH    29) SIGIO    30) SIGPWR
31) SIGSYS    34) SIGRTMIN    35) SIGRTMIN+1    36) SIGRTMIN+2    37) SIGRTMIN+3
38) SIGRTMIN+4    39) SIGRTMIN+5    40) SIGRTMIN+6    41) SIGRTMIN+7    42) SIGRTMIN+8
43) SIGRTMIN+9    44) SIGRTMIN+10    45) SIGRTMIN+11    46) SIGRTMIN+12    47) SIGRTMIN+13
48) SIGRTMIN+14    49) SIGRTMIN+15    50) SIGRTMAX-14    51) SIGRTMAX-13    52) SIGRTMAX-12
53) SIGRTMAX-11    54) SIGRTMAX-10    55) SIGRTMAX-9    56) SIGRTMAX-8    57) SIGRTMAX-7
58) SIGRTMAX-6    59) SIGRTMAX-5    60) SIGRTMAX-4    61) SIGRTMAX-3    62) SIGRTMAX-2
63) SIGRTMAX-1    64) SIGRTMAX
Task:
Предположим вы запустили программы firefox, filezilla и gedit в фоновом режиме. После этого вы выполнили следующие действия: fg %1, Ctrl+С, fg %2, Ctrl+Z, jobs. Информация о каких программах будет показана при выполнении команды jobs?
Decision:
$ firefox &
[1] 8962
$ filezilla &
[2] 9141
$ gedit &
[3] 9184
$ jobs
[1]   Running                 firefox &
[2]-  Running                 filezilla &
[3]+  Running                 gedit &
$ fg %1
firefox
^C[GFX1-]: Receive IPC close with reason=AbnormalShutdown
Exiting due to channel error.
[GFX1-]: Receive IPC close with reason=AbnormalShutdown
Exiting due to channel error.
[GFX1-]: Receive IPC close with reason=AbnormalShutdown
Exiting due to channel error.
$ fg %2
filezilla
^Z
[2]+  Stopped                 filezilla
$ jobs
[2]+  Stopped                 filezilla
[3]-  Running                 gedit &
Task:
Как запустить программу в фоне
Decision:
u@uv:~/Изображения$ packettracer &
[1] 3270
u@uv:~/Изображения$ ps aux | grep packettracer
u      3270  0.0  0.1  18132  3192 pts/1    S    20:27   0:00 /bin/bash /usr/local/bin/packettracer
u      3361  0.0  0.1  17700  2796 pts/1    S+   20:28   0:00 grep --color=auto packettracer
u@uv:~/Изображения$ kill %1
u@uv:~/Изображения$ ps aux | grep packettracer
u      3364  0.0  0.0  17700   660 pts/1    S+   20:28   0:00 grep --color=auto packettracer
[1]+  Завершено      packettracer  
Source:
https://basis.gnulinux.pro/
https://stepik.org/course/73/syllabus
Task:
Если мы хотим посмотреть адрессацию по портам
Decision:
$ cat /proc/ioports
  0000-0cf7 : PCI Bus 0000:00
  0000-001f : dma1
  0020-0021 : pic1
  0040-0043 : timer0
  0050-0053 : timer1
  0060-0060 : keyboard
  0064-0064 : keyboard
  0070-0071 : rtc_cmos
    0070-0071 : rtc0
  0080-008f : dma page reg
  00a0-00a1 : pic2
  00c0-00df : dma2
  00f0-00ff : fpu
  0170-0177 : 0000:00:01.1
    0170-0177 : ata_piix
  01f0-01f7 : 0000:00:01.1
    01f0-01f7 : ata_piix
  0376-0376 : 0000:00:01.1
    0376-0376 : ata_piix
  03c0-03df : vga+
  03f6-03f6 : 0000:00:01.1
    03f6-03f6 : ata_piix
0cf8-0cff : PCI conf1
0d00-ffff : PCI Bus 0000:00
  4000-403f : 0000:00:07.0
    4000-4003 : ACPI PM1a_EVT_BLK
    4004-4005 : ACPI PM1a_CNT_BLK
    4008-400b : ACPI PM_TMR
    4020-4021 : ACPI GPE0_BLK
  4100-410f : 0000:00:07.0
    4100-4108 : piix4_smbus
  d000-d00f : 0000:00:01.1
    d000-d00f : ata_piix
  d010-d01f : 0000:00:02.0
    d010-d01f : vmwgfx probe
  d020-d027 : 0000:00:03.0
    d020-d027 : e1000
  d040-d05f : 0000:00:04.0
  d100-d1ff : 0000:00:05.0
    d100-d1ff : Intel 82801AA-ICH
  d200-d23f : 0000:00:05.0
    d200-d23f : Intel 82801AA-ICH
  d240-d247 : 0000:00:0d.0
    d240-d247 : ahci
  d248-d24b : 0000:00:0d.0
    d248-d24b : ahci
  d250-d257 : 0000:00:0d.0
    d250-d257 : ahci
  d258-d25b : 0000:00:0d.0
    d258-d25b : ahci
  d260-d26f : 0000:00:0d.0
    d260-d26f : ahci
Task:
а если в памяти
Decision:
$ cat /proc/iomem
00000000-00000fff : Reserved
00001000-0009fbff : System RAM
0009fc00-0009ffff : Reserved
000a0000-000bffff : PCI Bus 0000:00
000c0000-000c7fff : Video ROM
000e2000-000e2fff : Adapter ROM
000f0000-000fffff : Reserved
  000f0000-000fffff : System ROM
00100000-7ffeffff : System RAM
  6ee00000-6fc00e80 : Kernel code
  6fc00e81-706507bf : Kernel data
  7090b000-70dfffff : Kernel bss
7fff0000-7fffffff : ACPI Tables
80000000-fdffffff : PCI Bus 0000:00
  f0000000-f7ffffff : 0000:00:02.0
    f0000000-f7ffffff : vmwgfx probe
  f8000000-f81fffff : 0000:00:02.0
    f8000000-f81fffff : vmwgfx probe
  f8200000-f821ffff : 0000:00:03.0
    f8200000-f821ffff : e1000
  f8400000-f87fffff : 0000:00:04.0
    f8400000-f87fffff : vboxguest
  f8800000-f8803fff : 0000:00:04.0
  f8804000-f8804fff : 0000:00:06.0
    f8804000-f8804fff : ohci_hcd
  f8805000-f8805fff : 0000:00:0b.0
    f8805000-f8805fff : ehci_hcd
  f8806000-f8807fff : 0000:00:0d.0
    f8806000-f8807fff : ahci
fec00000-fec00fff : Reserved
  fec00000-fec003ff : IOAPIC 0
fee00000-fee00fff : Local APIC
  fee00000-fee00fff : Reserved
fffc0000-ffffffff : Reserved
Task:
Cмотрим инфу о прерываниях. например какие процессы сейчас запущены
Decision:
$ cat /proc/interrupts
  CPU0     CPU1       
0:  1320048     555  IO-APIC-edge      timer
1:    10224       7  IO-APIC-edge      i8042
7:        0       0  IO-APIC-edge      parport0
8:        2       1  IO-APIC-edge      rtc
10:     3062     21  IO-APIC-fasteoi   acpi
12:      131      2  IO-APIC-edge      i8042
15:    47073      0  IO-APIC-edge      ide1
18:        0      1  IO-APIC-fasteoi   yenta
19:    31056      1  IO-APIC-fasteoi   libata, ohci1394
20:    19042      1  IO-APIC-fasteoi   eth0
21:    44052      1  IO-APIC-fasteoi   uhci_hcd:usb1, uhci_hcd:usb2,...
22:   188352      1  IO-APIC-fasteoi   ra0
23:   632444      1  IO-APIC-fasteoi   nvidia
24:     1585      1  IO-APIC-fasteoi   VIA82XX-MODEM, VIA8237
Task:
использовать утилиту dmesg для установления идентификаторов запросов прерываний, резервируемых для определенных устройств в процессе загрузки системы.
Decision:
$ dmesg | grep "irq 1[45]"
[ 28.930069] ata3: PATA max UDMA/133 cmd 0x1f0 ctl 0x3f6 bmdma 0x2090 irq 14
[ 28.930071] ata4: PATA max UDMA/133 cmd 0x170 ctl 0x376 bmdma 0x2098 irq 15
Task:
Сохраните листинг самых ресурсоемких процессов и прокомментируйте его.
Task:
Как посмотреть список открытых файлов запущенного процесса?
Task:
оценить загрузку CPU
Decision:
$ top
top - 08:00:51 up  2:02,  2 users,  load average: 0.15, 0.12, 0.09
Tasks: 189 total,   2 running, 187 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.2 us,  0.3 sy,  0.0 ni, 99.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :   1987.0 total,     83.6 free,    932.0 used,    971.4 buff/cache
MiB Swap:   2048.0 total,   2033.7 free,     14.3 used.    864.9 avail Mem
PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
765 mysql     20   0 1733056 356604  38296 S   0.7  17.5   0:38.09 mysqld  
...
 15 root      20   0       0      0      0 S   0.0   0.0   0:00.00 cpuhp/1
В третьей строке приводится информация об использовании центрального процессора.
%Cpu(s):  0.2 us,  0.3 sy,  0.0 ni, 99.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
Task:
Как узнать, не нарушая работы программы, к каким системным библиотекам и ресурсам системы она обращается в ходе работы?
Decision:
$ awk '$NF!~/\.so/{next} {$0=$NF} !a[$0]++' /proc/$PID/maps
readelf --dynamic /usr/bin/vim | grep NEEDED
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libtinfo.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libselinux.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libcanberra.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libacl.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libgpm.so.2]
 0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]
 0x0000000000000001 (NEEDED)             Shared library: [libpython3.8.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
	Task:
	Нужно создать еще одну сетевую папку для общего доступа в системе Windows Server 2012 r2
	Decision:
	создайте папку
	Давайте теперь назначим на эту папку разрешения - кликаем по ней правой кнопкой мыши - выбираем пункт "Свойства"
	Ставим галочку напротив надписи: открыть общий доступ к этой папке - добавить пользователей которые будут иметь доступ к этой папке с определенными правами - для того что бы выбрать конкретных пользователей из Active Directory нажмите вкладку "Разрешения"
	Мы попали в настройки разрешения общего доступа, чтобы выбрать пользователя который будет иметь доступ, нажмите "Добавить".
	Например, в AD мы создавали тестового пользователя с именем "Тест". Итак назначим учетной записи Тест полный доступ к этой папке, для этого введите имя "Тест" в поле выбираемых объектов после чего кликаем "Проверить имена". Так же добавляем еще один параметр для общего доступа, для этого нажмите ПКМ по папке и перейдите по пунктам: "Общий доступ" – "Отдельные люди" В появившимся окне в поле для ввода имени вводим "Тест" и кликаем "Добавить" (желательно в данной папке выставить пользователям права на Чтение и запись).
	Как только пользователь определился в чек-боксе разрешить выставим "Полный доступ к данной папке" и нажмем "Ок" Идентичную операцию проделываем с Администраторами
	Самое главное это путь к сетевой папке, для чего он нужен я расскажу чуть ниже, сейчас просто выберете "Свойства" сетевой папки и запомните "Сетевой путь"
	Итак, можно проверить сетевую папку в другом компьютере (другого пользователя)
	Task:
	Добавить в исключения ip 10.99.10.42. У клиента после перезагрузки сбрасываются настройки
	Decision:
	dc-0-regedit-домены-thost-Accounts-thost1-IE11(Настройки)-Изменить (параметры)
	Task:
	Компьютер подключен к интернету с помощью USB 4G модема. В качестве примера будет рассмотрен МТС модем. Одно из необходимых условий функционирования – автоподключение интернета при запуске ОС. При обычном запуске ОС происходит загрузка рабочего стола (процесс explorer), затем запускается программа модема (обычно connect manager), затем выполняется автоподключение интернета. При запуске ОС без рабочего стола программа модема не запускается. Предложите на ваш взгляд способ решения автозапуска в случае отсутствия запуска рабочего стола при загрузке.
Task:
Замена неверного MAC на ПК
Decision:
C:\wMAC(v1.0.87D)>wMAC.exe c 1C57D81543AE
...
Following OUI is support:
000B6Axxxxxx
00138Fxxxxxx
001966xxxxxx
002522xxxxxx
BC5FF4xxxxxx
D05099xxxxxx
0015B2xxxxxx
803773xxxxxx
00045Fxxxxxx
7085C2xxxxxx
DCFE07xxxxxx
1CEEC9xxxxxx
54B203xxxxxx
A8A159xxxxxx
8C0F6Fxxxxxx
9C6B00xxxxxx
ReturnCode:1
              ########    ###    #### ##
              ##         ## ##    ##  ##
              ##        ##   ##   ##  ##
              ######   ##     ##  ##  ##
              ##       #########  ##  ##
              ##       ##     ##  ##  ##
              ##       ##     ## #### ########
C:\wMAC(v1.0.87D)>wMAC.exe c 1CEEC91543AE
...
ReturnCode:0
              ########     ###     ######   ######
              ##     ##   ## ##   ##    ## ##    ##
              ##     ##  ##   ##  ##       ##
              ########  ##     ##  ######   ######
              ##        #########       ##       ##
              ##        ##     ## ##    ## ##    ##
              ##        ##     ##  ######   ######
Task:
Одна сеть работает с 1С, вторая сеть работает с ФИС. Фис взаимодествует с 1С, когда, например, нужно выгрузить из 1Ски сканированные заявления в ФИС. Но две сети не видели друг другa. Нужно использовать локальную сеть с VipNET координатором и через командную строку тут уже нужно будет посмотреть маршрут и прописать маршрут до ФИСа указав шлюз тот, по которому нету координатора
tip - это tip сети фис или тот адрес который в браузере ввожу,
tmask - tmask того адреса 0 или 255 в конце.
tip.1 - адрес того шлюза где нет випнета
Decision:
route print
route add -p tip mask tmask tip.1
route print
Decision:
C:\WINDOWS\system32>route -f
C:\WINDOWS\system32>route print
===========================================================================
IPv4 таблица маршрута
===========================================================================
Активные маршруты:
  Отсутствует
Постоянные маршруты:
  Отсутствует
C:\WINDOWS\system32>route add -p tIp2 mask 255.255.255.255 tIp3
C:\WINDOWS\system32>route print
===========================================================================
IPv4 таблица маршрута
===========================================================================
Активные маршруты:
  Отсутствует
Постоянные маршруты:
  Сетевой адрес            Маска    tip.1      Метрика
         tIp2  255.255.255.255   tIp3       1
C:\WINDOWS\system32>route print
===========================================================================
IPv4 таблица маршрута
===========================================================================
Активные маршруты:
Сетевой адрес           tmask      tip.1       Интерфейс  Метрика
===========================================================================
Постоянные маршруты:
  Сетевой адрес            Маска    tip.1      Метрика
         tIp2  255.255.255.255   tIp3       1
C:\WINDOWS\system32>route add -p tIp1 mask 255.255.255.255 tIp5 metric 35
C:\WINDOWS\system32>route print
===========================================================================
IPv4 таблица маршрута
===========================================================================
Активные маршруты:
Сетевой адрес           tmask      tip.1       Интерфейс  Метрика
     tIp1  255.255.255.255         On-link        tIp5   4261
===========================================================================
Постоянные маршруты:
  Сетевой адрес            Маска    tip.1      Метрика
         tIp2  255.255.255.255   tIp3       1
     tIp1  255.255.255.255       tIp5      35
C:\WINDOWS\system32>route change tIp1 mask 255.255.255.255 tIp4 metric 35
C:\WINDOWS\system32>route print
===========================================================================
IPv4 таблица маршрута
===========================================================================
Активные маршруты:
Сетевой адрес           tmask      tip.1       Интерфейс  Метрика
     tIp1  255.255.255.255        tIp4       tIp5   4261
===========================================================================
Постоянные маршруты:
  Сетевой адрес            Маска    tip.1      Метрика
         tIp2  255.255.255.255   tIp3       1
C:\WINDOWS\system32>route add -p tIp1 mask 255.255.255.255 tIp4 metric 35
C:\WINDOWS\system32>route print
===========================================================================
IPv4 таблица маршрута
===========================================================================
Активные маршруты:
Сетевой адрес           tmask      tip.1       Интерфейс  Метрика
     tIp1  255.255.255.255        tIp4       tIp5   4261
===========================================================================
Постоянные маршруты:
  Сетевой адрес            Маска    tip.1      Метрика
         tIp2  255.255.255.255   tIp3       1
     tIp1  255.255.255.255        tIp4      35
Task:
Я случайно добавил не тот адрес, чтобы удалить его со строки
Decision:
route delete tip, КОТОРОЙ МЫ ХОТИМ УДАЛИТЬ mask tmask tip.1
Task:
Если не работает сеть в компе
Decision:
смотрим IP в свойствах сети (должно быть 10.10.., а не 169 или 125), перезагруж, если таже проблема осталась гуглим - команда для сброса настроек IP (должны быть 3 команды):
netsh WinSook reset
netsh int ip reset c:\reset log.txt
ipconfig /flush dns
 	Task:
Bash.
	Создать скрипт для ротации логов, и не только логов, но и любых файлов. Автоматическое переименование и удаление осуществляется, если файл достигнет заданного размера
	Decision:
	#/bin/bash
	@echo off
	set file=query.log
	set path=»c:\logs\»
	set maxbytesize=268436480
	set filescount=7
	cd %path%
	for /F «usebackq» %%A in (‘%file%’) do set size=%%~zA
	if %size% LSS %maxbytesize% (
	echo «we should do nothing»
	) else (
		setlocal ENABLEDELAYEDEXPANSION
		set /a j=%filescount%-1
 		del /f /q %file%.%filescount%
		for /l %%i in (!j!,-1,0) do (
			set /a k=%%i+1
			ren %file%.%%i %file%.!k!
		)
		endlocal
		ren %file% %file%.0
	)
	Decision:
	Подготовим папку logs с файлами определенного размера query.log и скриптом log-rotation.txt
 	Source:
https://www.youtube.com/playlist?list=PLG-4IrwpAdz7tuB6A9EbDpIb3akCJ1hoe
Task:
Создайте скрипт, который будет создавать файл. После чего скрипт будет прописывать последнюю строчку из сообщений syslog в этот файл. Затем будет отправлять в syslog своё сообщение - «Logs collected».
Decision:
$ vim BASH-LogScript1.sh
$ chmod +x BASH-LogScript1.sh
$ cat BASH-LogScript1.sh
#!/bin/bash
touch LogFile
tail -n 1 /var/log/messages > LogFile
echo 'Logs collected' >> /var/log/messages
$ sudo ./BASH-LogScript1.sh
$ sudo cat /var/log/messages | grep 'Logs collected'
  Logs collected
Task:
Настройте rsyslog, чтобы логи, посланные этим скриптом, сохранялись в отдельном файле «collect.log» в директории /var/log.
Decision:
$ logger -p local4.info "Logs Collected"
$ sudo journalctl -p info | grep 'Logs Collected'
  апр 28 09:21:31 i6.rt.ru ur[5962]: Logs Collected
$ sudo vim /etc/rsyslog.conf
$ cat /etc/rsyslog.conf
....
# Save boot messages also to boot.log
local7.*                                                /var/log/boot.log
local4.*                                                /var/log/collect.log
...
$ sudo systemctl restart rsyslog
$ sudo ./BASH-LogScript1.sh
$ sudo cat /var/log/collect.log
  Apr 28 09:41:29 i6 ur[6135]: Logs Collected
$ logger -p local4.info "Logs Collected"
$ sudo cat /var/log/collect.log
  Apr 28 09:41:29 i6 ur[6135]: Logs Collected
  Apr 28 09:44:28 i6 ur[6162]: Logs Collected
Task:
Настройте ротацию этих логов, чтобы они сохранялись на протяжении месяца с еженедельной ротацией. Запустите скрипт и убедитесь, что все ранее проделанные шаги выполнили свою задачу.
Decision:
$ sudo vim /etc/logrotate.d/collect.conf
$ cat /etc/logrotate.d/collect.conf
/var/log/collect.log
{
  dateext
  weekly
  rotate 4
}
$ logrotate -d /etc/logrotate.d/collect.conf
  WARNING: logrotate in debug mode does nothing except printing debug messages!  Consider using verbose mode (-v) instead if this is not what you want.
  reading config file /etc/logrotate.d/collect.conf
  Reading state from file: /var/lib/logrotate/logrotate.status
  Allocating hash table for state file, size 64 entries
  Handling 1 logs
  rotating pattern: /var/log/collect.log
  weekly (4 rotations)
  empty log files are rotated, old logs are removed
  considering log /var/log/collect.log
  Creating new state
      Now: 2022-04-28 10:14
      Last rotated at 2022-04-28 10:00
      log does not need rotating (log has been already rotated)
$ sudo logrotate -f /etc/logrotate.d/collect.conf
$ ls -l /var/log/colle*
  -rw-------. 1 root root 112 апр 28 09:44 /var/log/collect.log-20220428
$ sudo ./BASH-LogScript1.sh
$ sudo journalctl -e
  ...
  апр 28 10:46:50 i6.rt.ru sudo[6584]:     ur : TTY=pts/1 ; PWD=/home/ur ; ur=root ; COMMAND=./BASH-LogScript1.sh
  ...
$ sudo tail -n 20 /var/log/messages
  ...
  Logs collected
  ...
$ logger -p local4.info "Logs Collected"
$ sudo cat /var/log/collect.log
  cat: /var/log/collect.log: No such file or directory
$ sudo cat /var/log/collect.log-20220428
  Apr 28 09:41:29 i6 ur[6135]: Logs Collected
  Apr 28 09:44:28 i6 ur[6162]: Logs Collected
  Apr 28 10:38:59 i6 ur[6437]: Logs Collected
  Apr 28 10:49:34 i6 ur[6601]: Logs Collected
$ sudo tail -n 20 /var/log/messages
  ...
  Apr 28 10:49:34 i6 ur[6601]: Logs Collected
  ...
Task:
Создайте скрипт, который будет отправлять логи в syslog – This is normal log → debug, This is error → error и This is critical error → crit. Настройте syslog, чтобы записывал эти логи в соответствующие файлы - /var/log/mylog.debug, /var/log/mylog.crit, /var/log/mylog.error. Настройте ротацию этих логов, чтобы они ротировались 5 раз. debug и error должны ротировались ежедневно, debug с сжатием, а error без сжатия. crit должен ротироваться раз в неделю.
Decision:
$ sudo ./BASH-LogScript2.sh
$ sudo cat /etc/rsyslog.conf
# rsyslog configuration file
...
# Save boot messages also to boot.log
local4.*                                                /var/log/collect.log
local7.*                                                /var/log/boot.log
# ### sample forwarding rule ###
...
#Target="remote_host" Port="XXX" Protocol="tcp")
local1.*                                                /var/log/mylog.debug
local2.*                                                                                          /var/log/mylog.error
local3.*                                                                                          /var/log/mylog.crit
$ ls /var/log/mylog.
  mylog.crit-20220428      mylog.debug-20220428.gz  mylog.error-20220428     
$ sudo cat /var/log/mylog.crit-20220428
  Apr 28 11:46:30 i6 root[6943]: This is critical error -> crit
$ sudo cat /var/log/mylog.error-20220428
  Apr 28 11:46:30 i6 root[6942]: This is error -> error
$ cat BASH-LogScript2.sh
#!/bin/bash
logger -p local1.debug "This is normal log -> debug"
echo 'local1.*                                                /var/log/mylog.debug' >> /etc/rsyslog.conf

logger -p local2.err "This is error -> error"
echo 'local2.*                                                                                          /var/log/mylog.error' >> /etc/rsyslog.conf

logger -p local3.crit "This is critical error -> crit"
echo 'local3.*                                                                                          /var/log/mylog.crit' >> /etc/rsyslog.conf

sudo systemctl restart rsyslog
#sudo touch /etc/logrotate.d/mylogdebug.conf
#sudo touch /etc/logrotate.d/mylogerror.conf
#sudo touch /etc/logrotate.d/mylogcrit.conf
echo '/var/log/mylog.debug
{
  dateext
  daily
  rotate 5
  compress
}' > /etc/logrotate.d/mylogdebug.conf
sudo logrotate -f /etc/logrotate.d/mylogdebug.conf

echo '/var/log/mylog.error
{
      dateext
      daily
      rotate 5
  delaycompress
}' > /etc/logrotate.d/mylogerror.conf
sudo logrotate -f /etc/logrotate.d/mylogerror.conf

echo '/var/log/mylog.crit
{
      dateext
      weekly
      rotate 5
}' > /etc/logrotate.d/mylogcrit.conf
sudo logrotate -f /etc/logrotate.d/mylogcrit.conf
$ cat /etc/logrotate.d/mylog
mylogcrit.conf   mylogdebug.conf  mylogerror.conf  
$ cat /etc/logrotate.d/mylogdebug.conf
/var/log/mylog.debug
{
  dateext
  daily
  rotate 5
  compress
}
$ sudo cat /var/log/messages | grep 'This is '
  Apr 28 11:34:58 i6 ur[6745]: This is error -> error
  Apr 28 11:34:58 i6 ur[6746]: This is critical error -> crit
  Apr 28 11:35:31 i6 root[6766]: This is error -> error
  Apr 28 11:35:31 i6 root[6767]: This is critical error -> crit
  Apr 28 11:40:00 i6 root[6828]: This is error -> error
  Apr 28 11:40:00 i6 root[6829]: This is critical error -> crit
  Apr 28 11:42:18 i6 root[6872]: This is error -> error
  Apr 28 11:42:18 i6 root[6873]: This is critical error -> crit
  Apr 28 11:44:04 i6 root[6903]: This is error -> error
  Apr 28 11:44:04 i6 root[6904]: This is critical error -> crit
  Apr 28 11:46:30 i6 root[6942]: This is error -> error
  Apr 28 11:46:30 i6 root[6943]: This is critical error -> crit
$ sudo journalctl -e | grep 'This is '
  апр 28 11:34:58 i6.rt.ru ur[6744]: This is normal log -> debug
  апр 28 11:34:58 i6.rt.ru ur[6745]: This is error -> error
  апр 28 11:34:58 i6.rt.ru ur[6746]: This is critical error -> crit
  апр 28 11:35:31 i6.rt.ru root[6765]: This is normal log -> debug
  апр 28 11:35:31 i6.rt.ru root[6766]: This is error -> error
  апр 28 11:35:31 i6.rt.ru root[6767]: This is critical error -> crit
  апр 28 11:40:00 i6.rt.ru root[6827]: This is normal log -> debug
  апр 28 11:40:00 i6.rt.ru root[6828]: This is error -> error
  апр 28 11:40:00 i6.rt.ru root[6829]: This is critical error -> crit
  апр 28 11:42:18 i6.rt.ru root[6871]: This is normal log -> debug
  апр 28 11:42:18 i6.rt.ru root[6872]: This is error -> error
  апр 28 11:42:18 i6.rt.ru root[6873]: This is critical error -> crit
  апр 28 11:44:04 i6.rt.ru root[6902]: This is normal log -> debug
  апр 28 11:44:04 i6.rt.ru root[6903]: This is error -> error
  апр 28 11:44:04 i6.rt.ru root[6904]: This is critical error -> crit
  апр 28 11:46:30 i6.rt.ru root[6941]: This is normal log -> debug
  апр 28 11:46:30 i6.rt.ru root[6942]: This is error -> error
  апр 28 11:46:30 i6.rt.ru root[6943]: This is critical error -> crit
Task:
Создайте файл /etc/allowedurs, в котором пропишите логин своего пользователя.
Создайте скрипт, который сначала проверит, имеет ли данный текущий пользователь право запускать скрипт (пользователь должен быть в списке /etc/allowedurs). Если прав нету, то следует вывести на экран сообщение «This incident will be reported», а в syslog в секцию error написать «ur urname tried to run this script!». После запуска скрипт должен вывести содержимое директории /data/. После чего предложить пользователю указать имя файла и указать дату и время модификации для смены.
Decision:
$ sudo vim /etc/allowedurs
[sudo] пароль для ur:
$ cat /etc/allowedurs
root
it
$ vim BASH-LogScript3.sh
$ cat BASH-LogScript3.sh
#!/bin/bash
name1=$(whoami)
#echo $name1
cmd1=$(cat /etc/allowedurs | grep $name1)
#echo $cmd1
#for line1 in $(cat /etc/allowedurs)
#do
#    echo 'line1' $line1
  #if [[ $name1 == $line1 ]];
  #then
  #    echo '+'
  #else
  #    echo '-'
  #fi    
#done
if cat /etc/allowedurs | grep $name1
then
  echo '+'
else
  echo 'This incident will be reported'
  logger -p local2.err "ur $name1 tried to run this script!"
fi
ls /data
read -p "specify the file name: " rename
read -p "specify the modification date and time for the shift: " date
$ whoami
  ur
$ ./BASH-LogScript3.sh
  This incident will be reported
  testfile1  testfile2  testfile3  testfile4  testfile5
  specify the file name: ur2
  specify the modification date and time for the shift: 2019.10.12 19:15   
$ sudo journalctl -e | grep 'tried to run this '
  апр 28 16:23:20 i6.rt.ru ur[8491]: ur urname tried to run this script!
  апр 28 16:24:51 i6.rt.ru ur[8513]: ur ur tried to run this script!
  апр 28 16:26:52 i6.rt.ru ur[8534]: ur ur tried to run this script!
  апр 28 16:30:09 i6.rt.ru ur[8556]: ur ur tried to run this script!
  апр 28 16:33:16 i6.rt.ru ur[8567]: ur ur tried to run this script!
  апр 28 16:34:36 i6.rt.ru ur[8591]: ur ur tried to run this script!
Source:
https://www.youtube.com/playlist?list=PLg5SS_4L6LYuu1RAT4l1tCkZrJzkIaNgL
Task:
Сделайте скрипт, который спросит имя пользователя и скажет, является ли пользователь администратором?
Decision:
#!/bin/bash
read -p "Print urname: " user1
user2=$(cat /etc/group | grep wheel | cut -d ':' -f 4)
if [ "$user1" = "$user2" ]
then
  echo "He is Admin"
else
  echo "He is not Admin"
fi
Task:
Сделайте скрипт, который будет спрашивать название и создавать файл, затем спрашивать права для этого файла и задавать их.
Decision:
#!/bin/bash
read -p "Print name: " name
touch $name
read -p "What rights are needed? " rights
chmod $rights $name
Task:
Напишите скрипт на bash, который будет определять в какую возрастную группу попадают пользователи. При запуске скрипт должен вывести сообщение "enter your name:" и ждать от пользователя ввода имени (используйте read, чтобы прочитать его). Когда имя введено, то скрипт должен написать "enter your age:" и ждать ввода возраста (опять нужен read). Когда возраст введен, скрипт пишет на экран "<Имя>, your group is <группа>", где <группа> определяется на основе возраста по следующим правилам:
  младше либо равно 16: "child",
  от 17 до 25 (включительно): "youth",
  старше 25: "adult".
После этого скрипт опять выводит сообщение "enter your name:" и всё начинается по новой. Если в какой-то момент работы скрипта будет введено пустое имя или возраст 0, то скрипт должен написать на экран "bye" и закончить свою работу.
Decision:
#!/bin/bash
while [[ True ]]
do
  echo "enter your name:"
  read name
  if [[ $name == "" ]]
  then
      echo "bye"
      break
  fi
  echo "enter your age:"
  read age
  if [[ $age == 0 ]]
  then    
      echo "bye"
      break
  elif [[ $age -le 16 ]]
  then
      echo "$name, your group is child"
  elif [[ $age -ge 17 && $age -le 25 ]]
  then
      echo "$name, your group is youth"
  else
      echo "$name, your group is adult"
  fi
done
Task:
у пользователя root создайте cron, чтобы он каждую пятницу в 23:30 записывал содержимое директории /data и содержимое архива /backup/archive.tar в файл /var/log/reports/текущаядата.
Decision:
#!/bin/bash
mkdir /var/log/reports
ls -l /data > /var/log/reports/$(date +"%d.%m.%Y")
tar -tf /backup/archive.tar >> /var/log/reports/$(date +"%d.%m.%Y")
Task:
Создайте пользователя backup и настройте для него cron, чтобы тот раз в день находил файлы старее 5 дней в директории /data и добавлял эти файлы в архив /backup/archive.tar, после чего удалял из исходной директории.
Decision:
#!/bin/bash
if find /data/ -type f -mtime +5; then
  cd /data
  tar -cvf /backup/archive.tar testfile*
  rm -rf /data/testfile*
else
      echo "No files"
fi
Task:
Разрешите пользователю helpdesk1 запускать команду Sh-Interview-NewBackup от имени пользователя backup. Команда Sh-Interview-NewBackup должна создавать сжатый архив директории /data и сохранять его в домашней директории пользователя backup с датой в названии.
Decision:
$ sudo useradd backup1
$ sudo passwd backup1
  Изменение пароля пользователя backup1.
  Новый пароль:
  НЕУДАЧНЫЙ ПАРОЛЬ: Пароль должен содержать не менее 8 символов
  Повторите ввод нового пароля:
  passwd: данные аутентификации успешно обновлены.
$ sudo mkdir /data
$ sudo touch /data/testfile{1..5}
$ ls -l /data/
  итого 0
  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile1
  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile2
  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile3
  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile4
  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile5
$ vim bash-script10
$ cat bash-script10
#/bin/bash
#Разрешите пользователю helpdesk1 запускать команду Bash-GnuLinux-NewBackup от имени пользователя backup. Команда Sh-Interview-NewBackup должна создавать сжатый архив директории /data и сохранять его в домашней директории пользователя backup с датой в названии.
#dt=$(date)
#echo "$dt"
#echo "$(date)"
#for line in $(date)
#do
#    echo "$line"
#done
#touch testfile5$(date +%y%m%d)
sudo tar -cjvf /home/backup1/testArchive$(date +%d%m%y).tar.gz /data/
$ bash /home/ur/bash-script10
  tar: Удаляется начальный `/' из имен объектов
  /data/
  /data/testfile5
  /data/testfile1
  /data/testfile3
  /data/testfile2
  /data/testfile4
$ sudo r-t -rf /home/backup1/testArchive150422.tar.gz
$ mv bash-script10 Bash-GnuLinux-NewBackup
$ sudo cp Bash-GnuLinux-NewBackup /usr/bin/
$ sudo cat /etc/sudoers
  ...
  ## Allow root to run any commands anywhere
  root    ALL=(ALL)     ALL
  sysadmin        ALL=(ALL)       ALL
  netadmin        ALL=(root)      /usr/bin/nmtui
  #helpdesk1       ALL=(ALL)   /usr/bin/passwd, !/usr/bin/passwd sysadmin, !/usr/bin/passwd root
  ...
$ sudo visudo
$ sudo cat /etc/sudoers
  ...
  ## Allow root to run any commands anywhere
  root    ALL=(ALL)     ALL
  sysadmin        ALL=(ALL)       ALL
  netadmin        ALL=(root)      /usr/bin/nmtui
  #helpdesk1       ALL=(ALL)   /usr/bin/passwd, !/usr/bin/passwd sysadmin, !/usr/bin/passwd root
  backup1     ALL=(ALL)    ALL
  helpdesk1     ALL=(backup1)    /usr/bin/Bash-GnuLinux-NewBackup
  ...
$ su - helpdesk1
$ su - backup1 -c "sudo Bash-GnuLinux-NewBackup"
  sudo: a ter-tinal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
$ su - helpdesk1
  Последний вход в систему: Пт апр 15 14:24:48 +08 2022 на pts/0
$ su - backup1 Bash-GnuLinux-NewBackup
  Последний вход в систему: Пт апр 15 14:27:43 +08 2022 на pts/0
  tar: Удаляется начальный `/' из имен объектов
  /data/
  /data/testfile5
  /data/testfile1
  /data/testfile3
  /data/testfile2
  /data/testfile4
$ exit
  выход
$ sudo ls -l /home/backup1/
  итого 4
  -rw-r--r--. 1 root    root    183 апр 15 14:28 testArchive150422.tar.gz
Task:
Cконструируем сценарий, вычисляющий сумму ежемесячных платежей по кредиту. Для передачи сценария программе bc в следующем примере используется встроенный документ. loan-calc : сценарий вычисления суммы ежемесячных платежей по кредиту
Decision:
#!/bin/bash
PROGNAME=$(basename $0)
usage () {
  cat <<- EOF
  Usage: $PROGNAME PRINCIPAL INTEREST MONTHS
  Where:
  PRINCIPAL is the amount of the loan.
  INTEREST is the APR as a number (7% = 0.07).
  MONTHS is the length of the loan's term.
  EOF
}
if (($# != 3)); then
  usage
  exit 1
fi
principal=$1
interest=$2
months=$3
bc <<- EOF
  scale = 10
  i = $interest / 12
  p = $principal
  n = $months
  a = p * ((i * ((1 + i) ^ n)) / (((1 + i) ^ n) - 1))
  print a, "\n"
  EOF
Task:
Определить файл или директория ваши данные
Decision:
#!/bin/bash
dir=/home/ik/* # your data
for file in $dir
do
if [ -d "$file" ]
then
echo "$file - директория"
elif [ -f "$file" ]
then
echo "$file - файл"
else
echo "Неизвестный файл"
fi
done
Task:
Бэкап архив всех файлов
Decision:
#!/bin/bash
BACKUPFILE=backup
archive=${1:-$BACKUPFILE}
find . -mtime -1 -type f -print0 | xargs -0 tar rvf "$archive.tar"
echo "Каталог $PWD заархивирован в файл \"$archive.tar\"."
exit 0
Task:
Напишите сценарий, который выводит дату, время, список зарегистрировавшихся пользователей, и uptime системы и сохраняет эту информацию в системном журнале.
Decision:
$ vim Bash-GnuLinux-AboutUserLogFile.sh
$ cat Bash-GnuLinux-AboutUserLogFile.sh
#!/bin/bash
echo "выводит число секунд прошедших с начала эпохи unix:"
date '+%s'
echo "выводит локальное время:"
date '+%F %T'
echo "список зарегистрировавшихся обычных пользователей, которые создаются с UID от UID_MIN до UID_MAX которые определены в файле /etc/login.defs:"
awk '/^UID/{print $1"="$2}' /etc/login.defs
echo "из файла /etc/passwd выбрать только тех пользователей у которых UID (третий столбик :) из этого диапазона:"
eval $(awk '/^UID/{print $1"="$2}' /etc/login.defs)
awk -v min=$UID_MIN -v max=$UID_MAX -F: '$3>=min && $3<=max {print $1}' /etc/passwd
echo "uptime системы:"
uptime -p
$ ./Bash-GnuLinux-AboutUserLogFile.sh
  выводит число секунд прошедших с начала эпохи unix:
  1633836259
  выводит локальное время:
  2021-10-09 22:24:19
  список зарегистрировавшихся обычных пользователей, которые создаются с UID от UID_MIN до UID_MAX которые определены в файле /etc/login.defs:
  UID_MIN=1000
  UID_MAX=60000
  из файла /etc/passwd выбрать только тех пользователей у которых UID (третий столбик :) из этого диапазона:
  ubuntu
  uptime системы:
  up 21 minutes
$ cat Bash-GnuLinux-AboutUserLogFile.sh
#!/bin/bash
echo -e "Дата и Время:;$(date '+%F %T')\nПользователи:;$(eval $(awk '/^UID/{print $1"="$2}' /etc/login.defs) && awk -v min=$UID_MIN -v max=$UID_MAX -F: '$3>=min && $3<=max {print $1}' /etc/passwd)\nВремя работы (начало):;$(uptime -s)\nВремя работы (прошло):;$(uptime -p)" | column -t -s ";" | systemd-cat --identifier="задача3"
$ ./Bash-GnuLinux-AboutUserLogFile.sh
$ journalctl SYSLOG_IDENTIFIER="задача3"
  -- Logs begin at Fri 2021-05-21 06:21:13 CDT, end at Sat 2021-10-09 22:33:30 CDT. --
  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Дата и Время:           2021-10-09 22:25:25
  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Пользователи:           ubuntu
  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Время работы (начало):  2021-10-09 22:02:57
  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Время работы (прошло):  up 22 minutes
  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Дата и Время:           2021-10-09 22:26:23
  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Пользователи:           ubuntu
  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Время работы (начало):  2021-10-09 22:02:57
  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Время работы (прошло):  up 23 minutes
  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Дата и Время:           2021-10-09 22:29:41
  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Пользователи:           ubuntu
  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Время работы (начало):  2021-10-09 22:02:57
  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Время работы (прошло):  up 26 minutes
  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Дата и Время:           2021-10-09 22:31:48
  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Пользователи:           ubuntu
  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Время работы (начало):  2021-10-09 22:02:57
  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Время работы (прошло):  up 28 minutes
  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Дата и Время:           2021-10-09 22:33:30
  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Пользователи:           ubuntu
  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Время работы (начало):  2021-10-09 22:02:57
  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Время работы (прошло):  up 30 minutes
Task:
Создайте функции просмотра информации о пользователе(1), создания пользователя(2), удаления пользователя (3). Используйте case и select для использования этих функций в виде меню.
Decision:
$ cat Bash-GnuLinux-AboutUser1.sh
#/bin/bash
aboutuser() {
  read -p "About user: " line
  cat /etc/passwd | grep -w $line
}
adduser(){
  read -p "Add user: " name
      #cut -d':' -f1 /etc/passwd | grep -w $name
}
deleteuser(){
      read -p "Delete user: " name
      #cut -d':' -f1 /etc/passwd | grep -w $name
}
user() {
  select option in "About user" "Add user" "Delete user" "Exit"
  do
      case $option in
          "About user") aboutuser ;;
          "Add user") adduser ;;
          "Delete user") deleteuser ;;
          "Exit") break ;;
          *) echo Wrong option ;;
      esac
  done
}
user
$ ./Bash-GnuLinux-AboutUser1.sh
1) About user
2) Add user
3) Delete user
4) Exit
#? 1
About user: d
d:x:1000:1000:,,,:/home/d:/bin/bash
#? 4
Task:
Создайте скрипт, который запрашивает имя пользователя, а в ответ выводит информацию о пользователе – его uid, домашнюю директорию, список групп, в которых он состоит.
После этого скрипт должен спросить, что следует поменять – uid, домашнюю директорию или группу.
Если uid, то сначала проверить, доступен ли такой uid, если нет – то один раз предложить ввести заново.
Если домашнюю директорию, то спросить, на какую директорию следует сменить, а также следует ли перемещать домашнюю директорию.
После чего следует вывести на экран итоговую команду.
Decision:
$ cat Bash-GnuLinux-AboutUser.sh
#/bin/bash
read -p "Print username: " user
#idd=$(id -u $user)
id1=$(cat /etc/passwd | grep $user | cut -d ':' -f 4)
home1=$(cat /etc/passwd | grep $user | cut -d ':' -f 6)
group1=$(cat /etc/group | grep $user | cut -d ':' -f 1)
echo "uid = $id1"
echo "home = $home1"
echo "group = $group1"
read -p "What should be changed? (uid/home/group): " change
#echo "$change"
if [ $change == "uid" ]
then
  read -p "Write youser own version: " id2
  if cut -d':' -f3 /etc/passwd | grep -w $id2
  then
      echo "there is such a user"
  else
      #echo "there is no such user"
      read -p "Re-Enter. Write youser own version: " id2
      if cut -d':' -f3 /etc/passwd | grep -w $id2
          then
                  echo "there is such a user"
      fi
  fi
elif [ $change == "home" ]
then
  read -p "Write youser own version: " home2
  if cut -d':' -f6 /etc/passwd | grep -w $home2
      then
      echo "Such a directory already exists"
  else
      echo "This is a unique home directory"
  fi
elif [ $change == "group" ]
then
  read -p "Write youser own version: " group2
  if cut -d':' -f1 /etc/group | grep -w $group2
  then
      echo "+"
  else
      echo "-"
  fi
else
  echo "command not found"
fi
$ ./Bash-GnuLinux-AboutUser.sh
Print username: tuser
uid = 1000
home = /home/tuser
group = dialout
cdrom
floppy
sudo
audio
dip
video
plugdev
netdev
What should be changed? (uid/home/group): uid
Write youser own version: 45435
Re-Enter. Write youser own version: 34534
Task:
async-child : пример асинхронного выполнения (потомок)
Decision:
#!/bin/bash
echo "Child: child is running..."
sleep 5
echo "Child: child is done. Exiting."
Task:
пример асинхронного выполнения (родитель)
Decision:
#!/bin/bash
# async-parent : 
echo "Parent: starting..."
echo "Parent: launching child script..."
async-child &
pid=$!
echo "Parent: child (PID= $pid) launched."
echo "Parent: continuing..."
sleep 2
echo "Parent: pausing to wait for child to finish..."
wait $pid
echo "Parent: child is finished. Continuing..."
echo "Parent: parent is done. Exiting."
Task:
программа вывода системной информации, управляемая с помощью меню
Decision:
#!/bin/bash
# case-menu: 
clear
echo "
Please Select:
1. Display System Information
2. Display Disk Space
3. Display Home Space Utilization
0. Quit
"
read -p "Enter selection [0-3] > "
case $REPLY in
  q|Q)    echo "Program terminated."
          exit
          ;;
  a|A)    echo "Hostname: $HOSTNAME"
          uptime
          ;;
  b|B)    df -h
          ;;
  c|C)    if [[ $(id -u) -eq 0 ]]; then
              echo "Home Space Utilization (All Users)"
              du -sh /home/*
          else
              echo "Home Space Utilization ($USER)"
              du -sh $HOME
          fi
          ;;
  *)      echo "Invalid entry." >&2
          exit 1
          ;;
esac
Task:
простая программа получения информации о файле
Decision:
#!/bin/bash
# file_info: 
PROGNAME=$(basename $0)
if [[ -e $1 ]]; then
  echo -e "\nFile Type:"
  file $1
  echo -e "\nFile Status:"
  stat $1
else
  echo "$PROGNAME: usage: $PROGNAME file" >&2
  exit 1
fi
Task:
сценарий для подсчета файлов по времени изменения
Decision:
#/bin/bash
# hours : 
usage () {
  echo "usage: $(basename $0) directory" >&2
}
# Убедиться, что аргумент является каталогом
if [[ ! -d $1 ]]; then
  usage
  exit 1
fi
# Инициализировать массив
for i in {0..23}; do hours[i]=0; done
# Собрать данные
for i in $(stat -c %y "$1"/* | cut -c 12-13); do
  j=${i/#0}
  ((++hours[j]))
  ((++count))
done
# Вывести данные
echo -e "Hour\tFiles\tHour\tFiles"
echo -e "----\t-----\t----\t-----"
for i in {0..11}; do
  j=$((i + 12))
  printf "%02d\t%d\t%02d\t%d\n" $i ${hours[i]} $j ${hours[j]}
done
printf "\nTotal files = %d\n" $count
Task:
демонстрация подстановки процессов
Decision:
#/bin/bash
# pro-sub : 
while read attr links owner group size date time filename; do
  cat <<- EOF
      Filename:   $filename
      Size:       $size
      Owner:      $owner
      Group:      $group
      Modified:   $date $time
      Links:      $links
      Attributes: $attr
  EOF
done < <(ls -l | tail -n +2)
Task:
чтение полей из файла
Decision:
#!/bin/bash
# read-ifs: 
FILE=/etc/passwd
read -p "Enter a username > " user_name
file_info=$(grep "^$user_name:" $FILE)
if [ -n "$file_info" ]; then
  IFS=":" read user pw uid gid name home shell <<< "$file_info"
  echo "User = '$user'"
  echo "UID = '$uid'"
  echo "GID = '$gid'"
  echo "Full Name = '$name'"
  echo "Home Dir. = '$home'"
  echo "Shell = '$shell'"
else
  echo "No such user '$user_name'" >&2
  exit 1
fi
Task:
программа вывода системной информации, управляемая с помощью меню
Decision:
#!/bin/bash
# read-menu: 
clear
echo "
Please Select:
1. Display System Information
2. Display Disk Space
3. Display Home Space Utilization
0. Quit
"
read -p "Enter selection [0-3] > "
if [[ $REPLY =~ ^[0-3]$ ]]; then
  if [[ $REPLY == 0 ]]; then
      echo "Program terminated."
      exit
  fi
  if [[ $REPLY == 1 ]]; then
      echo "Hostname: $HOSTNAME"
      uptime
      exit
  fi
  if [[ $REPLY == 2 ]]; then
      df -h
      exit
  fi
  if [[ $REPLY == 3 ]]; then
      if [[ $(id -u) -eq 0 ]]; then
          echo "Home Space Utilization (All Users)"
          du -sh /home/*
      else
          echo "Home Space Utilization ($USER)"
          du -sh $HOME
      fi
      exit
  fi
else
  echo "Invalid entry." >&2
  exit 1 fi
Task:
ввод секретного пароля
Decision:
#!/bin/bash
# read-secret: 
if read -t 10 -sp "Enter secret passphrase > " secret_pass; then
  echo -e "\nSecret passphrase = '$secret_pass'"
else
  echo -e "\nInput timed out" >&2
  exit 1
fi
Task:
проверка ввода
Decision:
#!/bin/bash
# read-validate: 
invalid_input () {
  echo "Invalid input '$REPLY'" >&2
  exit 1
}
read -p "Enter a single item > "
# пустой ввод (недопустимо)
[[ -z $REPLY ]] && invalid_input
# ввод множества элементов (недопустимо)
(( $(echo $REPLY | wc -w) > 1 )) && invalid_input
# введено допустимое имя файла?
if [[ $REPLY =~ ^[-[:alnum:]\._]+$ ]]; then
  echo "'$REPLY' is a valid filename."
  if [[ -e $REPLY ]]; then
      echo "And file '$REPLY' exists."
  else
      echo "However, file '$REPLY' does not exist."
  fi
  # введено вещественное число?
  if [[ $REPLY =~ ^-?[[:digit:]]*\.[[:digit:]]+$ ]]; then
      echo "'$REPLY' is a floating point number."
  else
      echo "'$REPLY' is not a floating point number."
  fi
  # введено целое число?
  if [[ $REPLY =~ ^-?[[:digit:]]+$ ]]; then
      echo "'$REPLY' is an integer."
  else
      echo "'$REPLY' is not an integer."
  fi
else
  echo "The string '$REPLY' is not a valid filename."
fi
Task:
Программа вывода страницы с информацией о системе
Decision:
#/bin/bash
PROGNAME=$(basename $0)
TITLE="System Information Report For $HOSTNAME"
CURRENT_TIME=$(date +"%x %r %Z")
TIME_STAMP="Generated $CURRENT_TIME, by $USER"
report_uptime () {
  cat <<- _EOF_
      <H2>System Uptime</H2>
      <PRE>$(uptime)</PRE>
      _EOF_
  return
}
report_disk_space () {
  cat <<- _EOF_
      <H2>Disk Space Utilization</H2>
      <PRE>$(df -h)</PRE>
      _EOF_
  return
}
report_home_space () {
  local format="%8s%10s%10s\n"
  local i dir_list total_files total_dirs total_size user_name
  if [[ $(id -u) -eq 0 ]]; then
      dir_list=/home/*
      user_name="All Users"
  else
      dir_list=$HOME
      user_name=$USER
  fi
  echo "<H2>Home Space Utilization ($user_name)</H2>"
  for i in $dir_list; do   
      total_files=$(find $i -type f | wc -l)
      total_dirs=$(find $i -type d | wc -l)
      total_size=$(du -sh $i | cut -f 1)
      echo "<H3>$i</H3>"
      echo "<PRE>"
      printf "$format" "Dirs" "Files" "Size"
      printf "$format" "----" "-----" "----"
      printf "$format" $total_dirs $total_files $total_size
      echo "</PRE>"
  done
  return
}
usage () {
  echo "$PROGNAME: usage: $PROGNAME [-f file | -i]"
  return
}
write_html_page () {
  cat <<- _EOF_
  <HTML>
      <HEAD>
          <TITLE>$TITLE</TITLE>
      </HEAD>
      <BODY>
          <H1>$TITLE</H1>
          <P>$TIME_STAMP</P>
          $(report_uptime)
          $(report_disk_space)
          $(report_home_space)    
      </BODY>
  </HTML>
  _EOF_
  return
}
# обработка параметров командной строки
interactive=
filename=
while [[ -n $1 ]]; do
  case $1 in
  -f | --file)        shift
              filename=$1
              ;;
  -i | --interactive) interactive=1
              ;;
  -h | --help)        usage
              exit
              ;;
  *)          usage >&2
              exit 1
              ;;
  esac
  shift
done
# интерактивный режим
if [[ -n $interactive ]]; then
  while true; do
  read -p "Enter name of output file: " filename
      if [[ -e $filename ]]; then
          read -p "'$filename' exists. Overwrite? [y/n/q] > "
          case $REPLY in
              Y|y)    break
                  ;;
              Q|q)    echo "Program terminated."
                  exit
                  ;;
              *)  continue
                  ;;
          esac
      fi
  done
fi
# вывод страницы html
if [[ -n $filename ]]; then
  if touch $filename && [[ -f $filename ]]; then
      write_html_page > $filename
  else
      echo "$PROGNAME: Cannot write file '$filename'" >&2
      exit 1
  fi
else
  write_html_page
fi
Task:
сценарий для демонстрации распространенных видов ошибок
Decision:
#!/bin/bash
# trouble: 
number=1
echo "number=$number" # ОТЛАДКА
set -x # Включить трассировку
if [ $number = 1 ]; then
echo "Number is equal to 1."
else
echo "Number is not equal to 1."
fi
set +x # Выключить трассировку
Task:
программа вывода системной информации, управляемая с помощью меню
Decision:
#!/bin/bash
# while-menu: 
DELAY=3 # Время отображения результатов на экране (в секундах)
while [[ $REPLY != 0 ]]; do
clear
cat <<- _EOF_
Please Select:
1. Display System Information
2. Display Disk Space
3. Display Home Space Utilization
4. Quit
_EOF_
read -p "Enter selection [0-3] > "
if [[ $REPLY =~ ^[0-3]$ ]]; then
if [[ $REPLY == 1 ]]; then
echo "Hostname: $HOSTNAME"
uptime
sleep $DELAY
fi
if [[ $REPLY == 2 ]]; then
df -h
sleep $DELAY
fi
if [[ $REPLY == 3 ]]; then
if [[ $(id -u) -eq 0 ]]; then
echo "Home Space Utilization (All Users)"
du -sh /home/*
else
echo "Home Space Utilization ($USER)"
du -sh $HOME
fi
sleep $DELAY
fi
else
echo "Invalid entry."
sleep $DELAY
fi
done
echo "Program terminated."
Task:
программа вывода системной информации, управляемая с помощью меню
Decision:
#!/bin/bash
# while-menu2: 
DELAY=3 # Время отображения результатов на экране (в секундах)
while true; do
clear
cat <<- _EOF_
Please Select:
1. Display System Information
2. Display Disk Space
3. Display Home Space Utilization
4. Quit
_EOF_
read -p "Enter selection [0-3] > "
if [[ $REPLY =~ ^[0-3]$ ]]; then
if [[ $REPLY == 1 ]]; then
echo "Hostname: $HOSTNAME"
uptime
sleep $DELAY
continue
fi
if [[ $REPLY == 2 ]]; then
df -h
sleep $DELAY
continue
fi
if [[ $REPLY == 3 ]]; then
if [[ $(id -u) -eq 0 ]]; then
echo "Home Space Utilization (All Users)"
du -sh /home/*
else
echo "Home Space Utilization ($USER)"
du -sh $HOME
fi
sleep $DELAY
continue
fi
if [[ $REPLY == 0 ]]; then
break
fi
else
echo "Invalid entry."
sleep $DELAY
fi
done
echo "Program terminated."
Task:
Напишите bash-скрипт, сохраняющий подробное описание объектов, расположенных в каталоге /home/de13ma, но не принадлежащих пользователю de13ma (владелец не de13ma) в файл description.txt. В задаче есть допущение что имя файла или группы не может содержать слово de13ma.
Decision:
$ cat Linux-Description4.sh
#!/bin/bash
ls -l /home/de13ma | grep -v "de13ma" > /tdir/description.txt
Task:
Напишите bash-скрипт, сохраняющий все запущенные процессы пользователя de13ma в файл processes.txt. В задаче есть допущение что имя процесса не может содержать слово de13ma.
Decision:
$ cat Linux-Processes4.sh
#!/bin/bash
ps -fu de13ma > processes.txt
Task:
Записать строку в конец файла linux 
Decision:
$ cat testfile
Hey
$ cat testscript.sh
#!/bin/bash
echo USERSPASSWORD | sudo -S sudo sh -c "echo 'bro' >> /home/dato/testdir/testfile"
$ ./testscript.sh
$ ./testscript.sh
$ cat testfile
Hey
bro
bro
Source:
https://jeka.by/ask/165/bash-add-string-in-file/
Task:
Напишите скрипт на bash, который принимает на вход два аргумента и выводит на экран строку следующего вида:
Arguments are: $1=первый_аргумент $2=второй_аргумент
Decision:
$ cat Linux-StandartStreams.sh
#/bin/bash
var1=$1
var2=$2
echo "Arguments are:" \$1=$var1 \$2=$var2
Task:
Напишите скрипт на bash, который принимает на вход один аргумент (целое число от 0 до бесконечности), который будет обозначать число студентов в аудитории. В зависимости от значения числа нужно вывести разные сообщения.
Соответствие входа и выхода должно быть таким:
  0 -->  No students
  1 -->  1 student
  2 -->  2 students
  3 -->  3 students
  4 -->  4 students
  5 и больше --> A lot of students
Decision:
$ cat Linux-StandartStreams2.sh
#!/bin/bash
number=student
case $1 in
0) result="No ${number}s";;
1) result="$1 ${number}";;
[2-4]) result="$1 ${number}s";;
*) result="A lot of ${number}s";;
esac
echo "$result"
Task:
Предположим, вы пишете скрипт на bash и хотите использовать в нем конструкцию if в следующем фрагменте:
  if [[ ... ]]
  then
      echo "True"
  fi
Вы можете вписать вместо "..." (внутри [[ ]] и не забудьте про пробелы после [[ и перед ]]!) любое из перечисленных ниже условий.
1) $# -ge 0
2) $var1 == $var2 && $var1 != $var2
3) -e $0
4) -z " "
5) -s $0
6) $var1 == $var2 || $var1 != $var2
Однако мы просим вас выбрать только те из них, при которых echo напечатает на экран True вне зависимости от того, с какими параметрами был запущен ваш скрипт и какие в нем есть переменные.
#Например, условие 0 -eq 0 подходит, т.к. ноль всегда равен нулю вне зависимости от аргументов и переменных внутри скрипта и на экран будет напечатано True.  В то же время условие $var1 -eq 0 не подходит, так как в переменной var1 как может быть записан ноль (тогда будет напечатано True), так его может и не быть (тогда ничего напечатано не будет).
Decision:
$ cat Linux-StandartStreams1.sh
#!/bin/bash
if [[ $# -ge 0 ]] # -ge больше или равно
then
  echo "True1"
fi
if [[ $var1 == $var2 && $var1 != $var2 ]]
then
  echo "True2"
fi
if [[ -e $0 ]] # -e <путь> путь существует
then
  echo "True3"
fi
if [[ -z " " ]] # -z <строка> строка пуста
then
  echo "True4"
fi
if [[ -s $0 ]] # -s <путь> размер файла больше 0
then
  echo "True5"
fi
if [[ $var1 == $var2 || $var1 != $var2 ]]
then
  echo "True6"
fi
Task:
Создайте файл со списком пользователей. С помощью for выведите на экран текст: «Creating new ur: uradd имя_пользователя».
Decision:
$ cat Linux-CreatingNewUser.sh
#/bin/bash
cut -d':' -f1 /etc/passwd >> testfile4
for line in $(cat testfile4)
do echo "Creating new ur: uradd $line"
done
Task:
Определить, что является файлом, а что папкой в заданном каталоге
Decision:
$ cat Linux-LsLtAFileOrADirectory.sh
#!/bin/bash
dir=/home/*
for file in $dir
do
if [ -d "$file" ]
then
echo "$file - директория"
elif [ -f "$file" ]
then
echo "$file - файл"
else
echo "Неизвестный файл"
fi
done
Task:
Что делает следующий скрипт:
#!/bin/bash
Filial="CH"
EXT="VF_CHR"
Period="201502" 
DIRIN="/home/siu01/ITC/${Filial}/2015/02"
FNAME="${Filial}_${Period}"
rm -f ${FNAME}.*
for FN in `find ${DIRIN} -type f -name '*'${EXT} | grep -E '_TrunkB.*'${EXT}'|_02.*'${EXT} | sort`
do
echo ${FN} >> ${FNAME}.txt
cat ${FN} | awk -F "," 'substr($7,2,6)=="800505" || substr($7,2,6)=="800777" {print $0}' >> ${FNAME}.dat1
done
cat ${FNAME}.dat1 | sort -u | sort -t "," -k 7 > ${FNAME}.dat
rm -f ${FNAME}.dat1
cat ${FNAME}.dat | awk -F "," -v fl=${Filial} \
'{if(substr($7,2,6)=="800505") {DUR += $9; Q++;}} END {printf "%-5s\t%5s\t%10s\n",fl,Q,DUR}' >> 800505_${Period}.txt
cat ${FNAME}.dat | awk -F "," -v fl=${Filial} \
'{if(substr($7,2,6)=="800777") {DUR += $9; Q++;}} END {printf "%-5s\t%5s\t%10s\n",fl,Q,DUR}' >> 800777_${Period}.txt
	Task:
Работа с дисками.
	Нужно обойти восстановление при загрузке Windows 7. Во время запуска появляется восстановление загрузки. Даже когда запускаем в бут меню с обычной загрузки.
	Decision:
	    Иногда достаточно просто вставить установочный диск Windows 7  -> перезагрузить компьютер  -> нажать любую клавишу при появлении запроса  -> выберать ваши языковые настройки ->Далее  -> Ремонт вашего компьютера -> в командной строке открыли доступ к папке с файлами, которые следует заменить C:\Windows\System32\Config
	cd windows 
	cd system32
	cd config
	dir
Было 5 файлов с окончанием .gbck, и 5 файлов без какого-либо завершения. Это следующие файлы: DEFAULT, SAM, SECURITY, SOFTWARE и SYSTEM ->Переименуйте все файлы без завершения в .bak один за другим. просто так: ren COMPONENTS COMPONENTS.bak (вы должны сделать это для остальных 4 файлов) ->Переименуйте все .gbck в один без завершения. просто так: ren COMPONENTS.gbck COMPONENTS (вы должны сделать это для остальных 4 файлов)  -> Введите dir , чтобы увидеть, были ли имена файлов именно такими, как вы ожидаете  -> Перезагрузите компьютер.
Но в моем случае не было установочного диска Windows 7 -> Зато у меня есть загрузочная флешка, с помощью которой можно устаналивать, например, винду, или есть программа акронис с помощью которого можно упралятть жестким диском (удалять разделы, добавлять), или есть прорграмма тотал командер, в нашем случае, как раз, она и нужна, чтобы заменить конфиги windows - system32 - config - выделяем Default, SAM, Security, software, system - это нужно удалить, не выделенные оставляем - и вставляем в папку regpack удаленныефайлы, windows - system32 - config - Regpack - перезагружаемся.
	Task:
	Windows 10 запускается с ошибкой UNMOUNTABLE BOOT VOLUME
	Decision:
	загрузившись с загрузочной флешки или диска с Windows 10 (8 и 7 тоже подойдут, несмотря на установленную десятку, для быстрой загрузки с флешки проще всего использовать Boot Menu) - клавиши Shift+F10 - на экране установки, должна появиться командная строка. Если не появится, на экране выбора языка выберите «Далее», а на втором экране внизу слева – «Восстановление системы» и найдите в средствах восстановления пункт «Командная строка».
	diskpart
	list volume
	в результате команды вы увидите список разделов на ваших дисках. Обратите внимание на букву раздела, на котором установлена Windows 10, она может отличаться от привычной буквы C во время работы в среде восстановления, в моем случае на скриншоте это буква D
	exit
	chkdsk D: /r
	закройте командную строку - перезагрузите компьютер с жесткого диска
	Task:
	Был такой случай, что компьютер не видит мою флешку. Хотя вчера я прекрасно работал с флешкой. Сначала проверил, работает ли флешка в других USB-портах. Потом вставил флешку в другой компьютер и он загрузился. Получается, что один компьютер видит флешку, а другой — нет.
	Decision:
	Вставляю флешку в компьютер -> Мой компьютер -> Управление дисками -> видим диски С и диск без имени — это флешка -> Изменить имя диска -> в открывшемся окне система предложит букву диску (обычно «i» ) -> ок
	Task:
	После запуска любой программы (чат, Фемида) выходит такая ошибка:
	«Ошибочный образ C:\Program Files\Windows Portable Devices\netapi.dll не предназначен для выполнения под управлением Windows или содержит ошибку» 
	Decision:
	> sfc /scannow
	> shutdown /r
Task:
Перемещение папки /var на другой физический диск
Decision:
$ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
...
sdc           8:32   0 931,5G  0 disk 
$ sudo fdisk /dev/sdc
...
Команда (m для справки): n
...
Выберите (по умолчанию - p):p
Номер раздела (1-4, default 1): 
Первый сектор (2048-1953525167, default 2048): 
Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-1953525167, default 1953525167): 
...
Do you want to remove the signature? [Y] Да/[N] Нет: Y
...
Команда (m для справки): w
$ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
...
sdc           8:32   0 931,5G  0 disk 
└─sdc1        8:33   0 931,5G  0 part 
$ sudo mkfs -t ext4 /dev/sdc1
mke2fs 1.46.5 (30-Dec-2021)
...
Allocating group tables: done                            
Writing inode tables: done                            
Creating journal (262144 blocks): done
Writing superblocks and filesystem accounting information: done
$ sudo mount /dev/sdc1 /mnt
$ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
...
sdc           8:32   0 931,5G  0 disk 
└─sdc1        8:33   0 931,5G  0 part /mnt
$ shopt -s dotglob
$ sudo rsync -aulvXpogtr /var/* /mnt
sending incremental file list
...
total size is 63,868,813,893  speedup is 1.00
$ ls -Zd /var
system_u:object_r:var_t:s0 /var
$ ls -Zd /mnt
system_u:object_r:unlabeled_t:s0 /mnt
$ sudo chcon -t var_t /mnt
$ ls -Zd /mnt
system_u:object_r:var_t:s0 /mnt
$ sudo umount /mnt
$ sudo blkid | grep sdc
/dev/sdc1: UUID="823ae1fa-...-b71dbb654f1f" TYPE="ext4" PARTUUID="3d352be0-01"
$ sudo vim /etc/fstab
$ sudo cat /etc/fstab | grep ext4
UUID=823ae1fa-...-b71dbb654f1f   /var  ext4  defaults,noatime,nofail 0 2
$ sudo mv /var /var.back
$ sudo mkdir /var
$ sudo mount -av
/                        : ignored
...
/var                     : successfully mounted
$ ls /var
account  crash  ftp       lib    log         nis       run    yp
adm      db     games     local  lost+found  opt       spool
cache    empty  kerberos  lock   mail        preserve  tmp
$ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
...
sdc           8:32   0 931,5G  0 disk 
└─sdc1        8:33   0 931,5G  0 part /var
Source:
http://sysengineering.ru/notes/peremeschenie-papok-linux-na-drugoy-disk?ysclid=lisfix46x1712981898
https://losst.pro/kakuyu-fajlovuyu-sistemu-vybrat-dlya-linux?ysclid=lishte72fq279374732
Task:
Анализ занятого места и его освобождение
Decision:
$ sudo apt-get -y install ncdu
$ ncdu
Task:
Поиск процессов, которые "держат" удаленные файлы
Decision:
$ lsof | grep deleted
  pulseaudi 2309                          ubuntu    6u      REG                0,1  67108864      34867 /memfd:pulseaudio (deleted)
  gnome-she 2601 2612 gmain               ubuntu   32r      REG                8,5     32768     414249 /home/ubuntu/.local/share/gvfs-metadata/root-91a6702b.log (deleted)
  ...
  Web\x20Co 4259 4279 ProfilerC           ubuntu   68r      REG                0,1     19462      49425 /memfd:mozilla-ipc (deleted)
  Web\x20Co 4259 4279 ProfilerC           ubuntu   69r      REG                0,1      9566      49427 /memfd:mozilla-ipc (deleted)
Task:
Найдите самую большую директорию в корне
Decision:
$ sudo du -sh /* | sort -h | tail -3
Task:
Напишите команду, которая выведет сколько места на диске занимает текущая директория (при этом размер нужно вывести в удобном для чтения формате (например, вместо 2048 байт надо выводить 2.0К) и больше на экран выводить ничего не нужно).
Decision.
$ du -hs
  938M
Task:
Как очистить раздел от мусора в командной строке?
Decision:
Это файлы с расширениями .tmp,.trace,*.out и файлы старше 7 дней
find /opt/test -iname "*.out" -daystart -atime +7 -exec rm {} \;
Запись в cron:
1 1 * * * /usr/bin/find /opt/test -iname "*.out" -daystart -atime +7 -exec rm {} \;
/opt/test замени на то где нужно чистить
Task:
Сделать резервное копирование диска через Acronis
Decision:
Для начала нам нужнa программа Stop SMS Uni Boot — Загрузочные образы CD & USB . Сборки имеют достаточное количество программ для работы с разделами HDD, восстановления системы, создания настроенного образа системы и для решения других проблем.
Установить образ на флешку можно через Rufus - Запускаемся через флешку - Тут в меню нужно выбрать HDD++ - Acronis - True image premium - Далее выбираем резервное копирование - диски - Выбираем нужный диск - Выбираем путь в обзоре, куда мы хотим сохранить копию диска - В следующем шаге параметра выбираем метод резервного копирования с режимом полное резервное копирование. По умолчанию стоит «инкрементное». Можно оставить этот метод. Но я выберу «полное». - Можно приступить, после чего пойдет загрузка.
Task:
устанавить винду 8 на жесткий диск через Acronis, Bootice Rus, WinNTSetup. После обновлю до винды 10
Decision:
У меня уже есть загрузочная флешка с нужными программами Acronis, Bootice Rus, WinNTSetup (ссылка на загрузочные образы — https://usbtor.ru/viewtopi-c.php?t=1728 ) и ISO образ с виндой 8.1.  - запуститься с загрузочной флешки в Boot Menu через bios. -  Откроем выбор дополнительных программ -Акронис в меню Hdd ++ - Acronis - Acronis Disk Director - Очистим диск - Инициализировать - Создать том - Выбираем размер создаваемого тома - Выбираем тип тома: Основной: активный - Если нужен второй том, тогда после создания основного тома создаем еще один том и выбираем логический тип тома. Но мне не нужен второй том, поэтому я пропускаю данную функцию - Завершить и применить ожидающие операции - Перезагрузимся - также с флешки и откроем 78setup -тут же нажмем Windows NT Setup - правильно выбрать диск, на который будет установлен загрузчик, в моем случае, это новый том Q - отформатируем его - Еще мы видим, что МБР горит желтым - 78setup - Booti-ce Rus - Physi-cal disk - правильный диск назначения (в моем случае это том Q) - в управлении MBR ставим галочку на Windows NT - Инсталяция/конфигурация - выбираем Windows NT 6.x MBR - 78setup - WIndows NT Setup -путь к установочным файлам Windows - прописываем тот путь где находится сам файл с Wim образом windows. - диск на который будет установлена ОС - выбираем нужный диск. В моем случае диск Q.- Установка. - перезапускаемся - установка винды 8.1 -Настраиваем часовой пояс - Придумываем имя компа - Имя пользователя, если нужно пароли - Ждем завершение настроек
Task:
Клонирование дисков
Представьте, что у вас есть два флеш-диска USB одинакового размера и вам нужно создать точную копию первого диска на втором. Допустим, что после подключения к компьютеру им назначаются имена устройств /dev/sdb и /dev/sdc соответственно. То есть нужно скопировать содержимое первого диска на второй.
Decision:
# dd if=/dev/sdb of=/dev/sdc
Task:
Как вариант, если к компьютеру подключено только первое устройство, можно скопировать его содержимое в обычный файл, который впоследствии использовать для восстановления или копирования
Decision:
# dd if=/dev/sdc of=flash_drive.img
Task:
Подсчет занимаемого места
определить в текущей папке занимаемое место всеми подкаталогами и файлами
Decision:
$ du -sm *
Task:
отсортировать результаты, чтобы выяснить, чем занято место в конкретной папке или на всем разделе
Decision:
$ du -sm * | sort -n
$ du -smh *
Task:
Просмотр списка смонтированных файловых систем
Для монтирования файловых систем вывести список файловых систем, смонтированных в настоящий момент
Для первого эксперимента возьмем флешку. Сначала посмотрим, что имеется в системе, перед тем как вставить флешку:
Decision:
~$ mount
  sysfs on /sys type sysfs (rw)
  proc on /proc type proc (rw)
  udev on /dev type devtmpfs (rw)
  ...
  /dev/fuse on /run/user/1000/doc type fuse (rw)
  tmpfs on /run/snapd/ns type tmpfs (rw)
  nsfs on /run/snapd/ns/snap-store.mnt type nsfs (rw)
Task:
Вставим флешку
Decision:
~$ mount
  sysfs on /sys type sysfs (rw)
  proc on /proc type proc (rw)
  udev on /dev type devtmpfs (rw)
  ...
  /dev/fuse on /run/user/1000/doc type fuse (rw)
  tmpfs on /run/snapd/ns type tmpfs (rw)
  nsfs on /run/snapd/ns/snap-store.mnt type nsfs (rw)
  /dev/sdc1 on /media/asus/BOOT_MENU type vfat (rw,nosuid,nodev,relatime,uid=1000,gid=1000,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,showexec,utf8,flush,errors=remount-ro,uhelper=udisks2)
Task:
Теперь, когда мы знаем имя устройства флешки, размонтируем ее и повторно смонтируем его в другой каталог в дереве файловой системы.
Decision:
# umount /dev/sdc1
Task:
Создать новую точку монтирования диска.
Decision:
# mkdir /mnt/flash
# ls /mnt
  flash
Task:
Смонтируем флешку в новую точку монтирования.
Decision:
# mount -t vfat /dev/sdc1 /mnt/flash
# cd /mnt/flash/
/mnt/flash# ls
  '???'          autorun.inf   bootmgr       efi      'System Volume Information'
   autorun.ico   boot          bootmgr.efi   sources
# umount /dev/sdc1
Task:
Создание образа-копии компакт-диска
у нас есть компакт-диск с дистрибутивом Ubuntu, и мы хотим создать файл ISO-образа, который потом можно будет использовать для создания нескольких копий.
Decision:
Вставив компакт-диск в привод CD-ROM и определив имя устройства (пусть это будет /dev/cdrom), мы сможем создать файл ISO-образа следующим способом:
~$ dd if=/dev/cdrom of=ubuntu.iso
  119104+0 records in
  119104+0 records out
  60981248 bytes (61 MB, 58 MiB) copied, 2.66461 s, 22.9 MB/s
Task:
Создание образа из коллекции файлов
Создать файл ISO-образа, включающий содержимое некоего каталога с помощью программы enisoimage
Decision:
сначала создадим каталог (~/folder) со всеми необходимыми файлами для включения в образ:
~$ ls folder
  1.txt  3.txt
~$ genisoimage -o folder.iso -R -J ~/folder
  I: -input-charset not specified, using utf-8 (detected in locale settings)
  Total translation table size: 0
  Total rockridge attributes bytes: 323
  Total directory bytes: 474
  Path table size(bytes): 10
  Max brk space used 0
  181 extents written (0 MB)
~$ ls -l folder.iso
  -rw-rw-r-- 1 s s 370688 Nov 18 20:14 folder.iso
Task:
Сетевая файловая система - NFS
Скорее всего NFS уже есть в системе. Если же nfs в системе не обнаружен то ставим из репозитория
Decision:
[tuser1@thost1 Centos]# yum list | grep nfs
[tuser1@thost1 Centos]# yum -y install nfs-utils
[tuser1@thost1 Centos]# systemctl enable nfs-s.
[tuser1@thost1 Centos]# systemctl start nfs-s
[tuser1@thost1 Centos]# systemctl status nfs-s
Task:
В своей работе NFS использует RPC-вызовы, а значит работоспособность службы можно проверить с помощью portmapper (он тоже должен быть запущен на сервере где выполняются программы использующие RPC Calls).
Decision:
[tuser1@thost1 Centos]# rpcinfo -p localhost | grep nfs
  100003 3 tcp 2049 nfs
  100003 4 tcp 2049 nfs
  100227 3 tcp 2049 nfs_acl
[tuser1@thost1 Centos]# rpcinfo -p localhost
  program vers proto port service
  100000 4 tcp 111 portmapper
  100000 3 tcp 111 portmapper
  100000 2 tcp 111 portmapper
  100000 4 udp 111 portmapper
  100000 3 udp 111 portmapper
  100000 2 udp 111 portmapper
  100005 1 udp 20048 mountd
  100005 1 tcp 20048 mountd
  100005 2 udp 20048 mountd
  100005 2 tcp 20048 mountd
  100005 3 udp 20048 mountd
  100005 3 tcp 20048 mountd
  100024 1 udp 35314 status
  100024 1 tcp 45161 status
  100003 3 tcp 2049 nfs
  100003 4 tcp 2049 nfs
  100227 3 tcp 2049 nfs_acl
  100021 1 udp 48717 nlockmgr
  100021 3 udp 48717 nlockmgr
  100021 4 udp 48717 nlockmgr
  100021 1 tcp 35773 nlockmgr
  100021 3 tcp 35773 nlockmgr
  100021 4 tcp 35773 nlockmgr
Task:
Сделаем так чтобы при включении thost3 автоматически монтировался. разрешим монтировать /home на сервере tip в режиме rw. То есть, что вы хотите отдавать(home), кому (tip), какие права (rw).
Decision:
tuser3@thost3:~# ifconfig
  ...
  tip
  ...
[tuser1@thost1 Centos]# vim /etc/exports
[tuser1@thost1 Centos]# cat /etc/exports
/home tip(rw,no_root_squash)
Task:
Проверим список экспортированных файловая система
Decision:
[tuser1@thost1 Centos]# exportfs
Task:
Перечитываем файл чтобы внесенные изменения начали действовать.
Decision:
[tuser1@thost1 Centos]# exportfs -r
Task:
Проверим список экспортированных файловая система
Decision:
[tuser1@thost1 Centos]# exportfs
  /home tip
Task:
Теперь на сервере tip попробуем примонтировать файловая система /home экспортированную на 192.168.0.104. Создаем каталог куда будем монтировать
Decision:
tuser3@thost3:~# mkdir /mnt/nfs
Task:
Монитруем
Decision:
[tuser1@thost1 Centos]# ifconfig
  ...
  192.168.0.104
  ...
[tuser1@thost1 Centos]# ls -l /home
  итого 8
  drwx------. 3 bestuser bestuser 92 апр 10 00:34 bestuser
  drwx------. 18 Centos Centos 4096 апр 26 20:44 Centos
  drwx------. 3 dmosk dmosk 113 апр 18 00:46 dmosk
  drwx------. 4 sk sk 145 апр 20 22:50 sk
  drwx------. 8 user1 user1 4096 апр 24 09:58 user1
  drwx------. 3 user3 managers 113 апр 18 00:28 user3
  drwx------. 4 webby webby 111 апр 24 09:58 webby
tuser3@thost3:~# mount -t nfs 192.168.0.104:/home /mnt/nfs
  mount: /mnt/nfs: bad option; for several filesystems (e.g. nfs, cifs) you might need a /sbin/mount.<type> helper program.
tuser3@thost3:~# apt-get -y install nfs-common
tuser3@thost3:~# mount -t nfs 192.168.0.104:/home /mnt/nfs
  mount.nfs: Connection timed out
Task:
Видим, что не пропускают нас, потому что мы не настроили правила iptables. исправим это
Decision:
tuser3@thost3:~# nmap 192.168.0.104
  Starting Nmap 7.60 ( https://nmap.org ) at 2020-04-27 05:05 MSK
  Nmap scan report for thost1 (192.168.0.104)
  Host is up (0.0011s latency).
  Not shown: 992 filtered ports
  PORT STATE SERVICE
  21/tcp open ftp
  22/tcp open ssh
  23/tcp open telnet
  25/tcp closed smtp
  53/tcp closed domain
  80/tcp closed http
  143/tcp closed imap
  443/tcp closed https
  MAC Address: 08:00:27:77:A2:2C (Oracle VirtualBox virtual NIC)
  Nmap done: 1 IP address (1 host up) scanned in 16.81 seconds
[tuser1@thost1 Centos]# cat /etc/sysconfig/iptables
Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*security
:INPUT ACCEPT [3250:11558237]
:FORWARD ACCEPT [0:0]
:Сonclusion ACCEPT [3352:417020]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*raw
:PREROUTING ACCEPT [13311:12009098]
:Сonclusion ACCEPT [3352:417020]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*mangle
:PREROUTING ACCEPT [13310:12009046]
:INPUT ACCEPT [13310:12009046]
:FORWARD ACCEPT [0:0]
:Сonclusion ACCEPT [3352:417020]
:POSTROUTING ACCEPT [3354:417084]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*nat
:PREROUTING ACCEPT [10075:443825]
:INPUT ACCEPT [66:2904]
:POSTROUTING ACCEPT [324:21812]
:Сonclusion ACCEPT [324:21812]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*filter
:INPUT DROP [7022:316384]
:FORWARD DROP [0:0]
:Сonclusion DROP [2480:339285]
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m multiport --dports 21 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 22 -j ACCEPT
-A INPUT -p tcp -m state --state NEW --dport 23 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 25 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 53 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 80 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 143 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 443 -j ACCEPT
-A INPUT -p udp -m multiport --dports 53 -j ACCEPT
-A INPUT -p udp -m multiport --dports 21 -j ACCEPT
-A INPUT -p udp -m multiport --dports 20 -j ACCEPT
-A INPUT -p udp -m multiport --dports 69 -j ACCEPT
-A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT
-A Сonclusion -o lo -j ACCEPT
-A Сonclusion -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
[tuser1@thost1 Centos]# vim /etc/sysconfig/iptables
[tuser1@thost1 Centos]# cat /etc/sysconfig/iptables
Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*security
:INPUT ACCEPT [3250:11558237]
:FORWARD ACCEPT [0:0]
:Сonclusion ACCEPT [3352:417020]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*raw
:PREROUTING ACCEPT [13311:12009098]
:Сonclusion ACCEPT [3352:417020]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*mangle
:PREROUTING ACCEPT [13310:12009046]
:INPUT ACCEPT [13310:12009046]
:FORWARD ACCEPT [0:0]
:Сonclusion ACCEPT [3352:417020]
:POSTROUTING ACCEPT [3354:417084]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*nat
:PREROUTING ACCEPT [10075:443825]
:INPUT ACCEPT [66:2904]
:POSTROUTING ACCEPT [324:21812]
:Сonclusion ACCEPT [324:21812]
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
# Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020
*filter
:INPUT DROP [7022:316384]
:FORWARD DROP [0:0]
:Сonclusion DROP [2480:339285]
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m multiport --dports 21 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 22 -j ACCEPT
-A INPUT -p tcp -m state --state NEW --dport 23 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 25 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 53 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 80 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 143 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 443 -j ACCEPT
-A INPUT -p tcp -m multiport --dports 2049 -j ACCEPT
-A INPUT -p udp -m multiport --dports 53 -j ACCEPT
-A INPUT -p udp -m multiport --dports 21 -j ACCEPT
-A INPUT -p udp -m multiport --dports 20 -j ACCEPT
-A INPUT -p udp -m multiport --dports 69 -j ACCEPT
-A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT
-A Сonclusion -o lo -j ACCEPT
-A Сonclusion -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
COMMIT
# Completed on Sun Apr 12 01:33:36 2020
[tuser1@thost1 Centos]# systemctl restart iptables.service
tuser3@thost3:~# nmap 192.168.0.104
  Starting Nmap 7.60 ( https://nmap.org ) at 2020-04-27 05:08 MSK
  Nmap scan report for thost1 (192.168.0.104)
  Host is up (0.0012s latency).
  Not shown: 991 filtered ports
  PORT STATE SERVICE
  21/tcp open ftp
  22/tcp open ssh
  23/tcp open telnet
  25/tcp closed smtp
  53/tcp closed domain
  80/tcp closed http
  143/tcp closed imap
  443/tcp closed https
  2049/tcp open nfs
  MAC Address: 08:00:27:77:A2:2C (Oracle VirtualBox virtual NIC)
  Nmap done: 1 IP address (1 host up) scanned in 21.98 seconds
tuser3@thost3:~# mount -t nfs 192.168.0.104:/home /mnt/nfs
Task:
Теперь проверим каталоги у двух систем.
Decision:
tuser3@thost3:~# ls -l /mnt/nfs
  итого 8
  drwx------ 3 1001 1001 92 апр 10 07:34 bestuser
  drwx------ 18 linux linux 4096 апр 27 03:44 Centos
  drwx------ 3 1004 1005 113 апр 18 07:46 dmosk
  drwx------ 4 1006 1007 145 апр 21 05:50 sk
  drwx------ 8 1002 1002 4096 апр 24 16:58 user1
  drwx------ 3 1003 1003 113 апр 18 07:28 user3
  drwx------ 4 1007 1008 111 апр 24 16:58 webby
[tuser1@thost1 Centos]# ls -l /home
  итого 8
  drwx------. 3 bestuser bestuser 92 апр 10 00:34 bestuser
  drwx------. 18 Centos Centos 4096 апр 26 20:44 Centos
  drwx------. 3 dmosk dmosk 113 апр 18 00:46 dmosk
  drwx------. 4 sk sk 145 апр 20 22:50 sk
  drwx------. 8 user1 user1 4096 апр 24 09:58 user1
  drwx------. 3 user3 managers 113 апр 18 00:28 user3
  drwx------. 4 webby webby 111 апр 24 09:58 webby
[tuser1@thost1 Centos]# vim /home/myestfile.txt
[tuser1@thost1 Centos]# cat /home/myestfile.txt
  hust text
[tuser1@thost1 Centos]# ls -l /home
  итого 12
  drwx------. 3 bestuser bestuser 92 апр 10 00:34 bestuser
  drwx------. 18 Centos Centos 4096 апр 26 20:44 Centos
  drwx------. 3 dmosk dmosk 113 апр 18 00:46 dmosk
  -rw-r--r--. 1 root root 10 апр 26 22:17 myestfile.txt
  drwx------. 4 sk sk 145 апр 20 22:50 sk
  drwx------. 8 user1 user1 4096 апр 24 09:58 user1
  drwx------. 3 user3 managers 113 апр 18 00:28 user3
  drwx------. 4 webby webby 111 апр 24 09:58 webby
tuser3@thost3:~# ls -l /mnt/nfs
  итого 12
  drwx------ 3 1001 1001 92 апр 10 07:34 bestuser
  drwx------ 18 linux linux 4096 апр 27 03:44 Centos
  drwx------ 3 1004 1005 113 апр 18 07:46 dmosk
  -rw-r--r-- 1 root root 10 апр 27 05:17 myestfile.txt
  drwx------ 4 1006 1007 145 апр 21 05:50 sk
  drwx------ 8 1002 1002 4096 апр 24 16:58 user1
  drwx------ 3 1003 1003 113 апр 18 07:28 user3
  drwx------ 4 1007 1008 111 апр 24 16:58 webby
Task:
Посмотрим, что примонтированно в системе
Decision:
tuser3@thost3:~# mount
  ...
  192.168.0.104:/home on /mnt/nfs type nfs4 (rw,relatime,vers=4.2,rsize=524288,wsize=524288,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=tip,local_lock=none,addr=192.168.0.104)
tuser3@thost3:~# vim /mnt/nfs/myestfile.txt
tuser3@thost3:~# cat /mnt/nfs/myestfile.txt
  hust text
  new line
[tuser1@thost1 Centos]# cat /home/myestfile.txt
  hust text
  new line
Task:
Если файловая система экспортированы на сервере который работает круглосуточно (24 часа в сутки)б то монтирование разделов можно добавить в конце /etc/fstab тем самым автоматизировав процедуру при старте компьютера.
Decision:
[tuser1@thost1 Centos]# ifconfig
  ...
  192.168.0.104
  ...
tuser3@thost3:~# cat /etc/fstab
/etc/fstab: static file system information.
#
# Use 'blkid' to print the universally unique identifier for a
# device; this may be used with UUID= as a more robust way to name devices
# that works even if disks are added and removed. See fstab(5).
#
# <file system> <mount point> <type> <options> <dump> <pass>
# / was on /dev/sda1 during installation
UUID=4020996d-6502-4a36-b7bc-aec4a74d5aa9 / ext4 errors=remount-ro 0 1
/swapfile none swap sw 0 0
tuser3@thost3:~# vim /etc/fstab
tuser3@thost3:~# cat /etc/fstab
/etc/fstab: static file system information.
#
# Use 'blkid' to print the universally unique identifier for a
# device; this may be used with UUID= as a more robust way to name devices
# that works even if disks are added and removed. See fstab(5).
#
# <file system> <mount point> <type> <options> <dump> <pass>
# / was on /dev/sda1 during installation
UUID=4020996d-6502-4a36-b7bc-aec4a74d5aa9 / ext4 errors=remount-ro 0 1
/swapfile none swap sw 0 0
192.168.0.104:/home /mnt/nfs nfs defaults 0 0
Task:
Еще пример
Decision:
tuser3@thost3:~# mkdir /mnt/share
tuser3@thost3:~# vim /mnt/share/share.txt
tuser3@thost3:~# cat /mnt/share/share.txt
  for share
tuser3@thost3:~# apt list | grep nfs
  ...
  nfs-common/bionic-updates,now 1:1.3.4-2.1ubuntu5.2 amd64 [установлен]
  ...
  nfs-kernel-s/bionic-updates 1:1.3.4-2.1ubuntu5.2 amd64
  ...
tuser3@thost3:~# apt install -y nfs-kernel-s
tuser3@thost3:~# systemctl enable nfs-kernel-s
  Synchronizing state of nfs-kernel-s.service with SysV service script with /lib/systemd/systemd-sysv-install.
  Executing: /lib/systemd/systemd-sysv-install enable nfs-kernel-s
tuser3@thost3:~# systemctl start nfs-kernel-s
tuser3@thost3:~# systemctl status nfs-kernel-s
  ● nfs-s.service - NFS s and services
  Loaded: loaded (/lib/systemd/system/nfs-s.service; enabled; vendor preset: enabled)
  Active: active (exited) since Mon 2020-04-27 05:34:56 MSK; 2min 14s ago
  Main PID: 5681 (code=exited, status=0/SUCCESS)
  Tasks: 0 (limit: 2327)
  CGroup: /system.slice/nfs-s.service
  апр 27 05:34:54 thost3 systemd[1]: Starting NFS s and services...
  апр 27 05:34:56 thost3 systemd[1]: Started NFS s and services.
Task:
Здесь допустим нету никаких секретов, поэтому сделаем этот файл доcтупным для всех. то есть всем разрешено его монтировать
Decision:
tuser3@thost3:~# rpcinfo -p localhost
  program vers proto port service
  100000 4 tcp 111 portmapper
  100000 3 tcp 111 portmapper
  100000 2 tcp 111 portmapper
  100000 4 udp 111 portmapper
  100000 3 udp 111 portmapper
  100000 2 udp 111 portmapper
  100005 1 udp 33609 mountd
  100005 1 tcp 35179 mountd
  100005 2 udp 53486 mountd
  100005 2 tcp 36927 mountd
  100005 3 udp 51351 mountd
  100005 3 tcp 48353 mountd
  100003 3 tcp 2049 nfs
  100003 4 tcp 2049 nfs
  100227 3 tcp 2049
  100003 3 udp 2049 nfs
  100227 3 udp 2049
  100021 1 udp 55641 nlockmgr
  100021 3 udp 55641 nlockmgr
  100021 4 udp 55641 nlockmgr
  100021 1 tcp 45397 nlockmgr
  100021 3 tcp 45397 nlockmgr
  100021 4 tcp 45397 nlockmgr
tuser3@thost3:~# vim /etc/exports
tuser3@thost3:~# cat /etc/exports
/mnt/share *(rw)
tuser3@thost3:~# exportfs -r
  exportfs: /etc/exports [1]: Neither 'subtree_check' or 'no_subtree_check' specified for export "*:/mnt/share".
  Assuming default behaviour ('no_subtree_check').
  NOTE: this default has changed since nfs-utils version 1.0.x
tuser3@thost3:~# exportfs
  /mnt/share <world>
tuser3@thost3:~# ifconfig
  ...
  tip
  ...
[tuser1@thost1 Centos]# ls -l /mnt/
  итого 0
[tuser1@thost1 Centos]# mount -t nfs tip:/mnt/share /mnt
[tuser1@thost1 Centos]# ls -l /mnt/
  итого 4
  -rw-r--r--. 1 root root 10 апр 26 22:27 share.txt
Task:
Создайте директорию ~/myfiles, скопируйте туда /etc/passwd и /etc/group. Создайте раздел с файловая система ext4. Перенесите данные из директории myfiles на эту файловую систему. Настройте автомонтирование этой файловой системы в эту директорию.
Decision:
[tuser1@thost1 Centos]#  mkdir  ~/myfiles
[tuser1@thost1 Centos]#  cp /etc/passwd ~/myfiles
[tuser1@thost1 Centos]#  cp /etc/group ~/myfiles
[tuser1@thost1 Centos]#  ls -l myfiles/
  total 8
  -rw-r--r--. 1 cs cs 1457 Feb 10 10:24 group
  -rw-r--r--. 1 cs cs 3614 Feb 10 10:24 passwd
[tuser1@thost1 Centos]#  sudo mkfs.ext4 /dev/sdb1
  mke2fs 1.45.6 (20-Mar-2020)
  Creating filesystem with 51200 1k blocks and 12824 inodes
  Filesystem UUID: 8f4688cc-def1-44aa-9fc5-7c1793fda09c
  Superblock backups stored on blocks:
          8193, 24577, 40961
  Allocating group tables: done
  Writing inode tables: done
  Creating journal (4096 blocks): done
  Writing superblocks and filesystem accounting information: done
[tuser1@thost1 Centos]#  sudo tune2fs -l /dev/sdb1
  tune2fs 1.45.6 (20-Mar-2020)
  Filesystem volume name:   <none>
  Last mounted on:          <not available>
  Filesystem UUID:          8f4688cc-def1-44aa-9fc5-7c1793fda09c
  Filesystem magic number:  0xEF53
  Filesystem revision #:    1 (dynamic)
  Filesystem features:      has_journal ext_attr resize_inode dir_index filetype extent 64bit flex_bg sparse_super large_file huge_file dir_nlink extra_isize metadata_csum
  Filesystem flags:         signed_directory_hash
  Default mount options:    user_xattr acl
  Filesystem state:         clean
  Errors behavior:          Continue
  Filesystem OS type:       Linux
  Inode count:              12824
  Block count:              51200
  Reserved block count:     2560
  Free blocks:              44440
  Free inodes:              12813
  First block:              1
  Block size:               1024
  Fragment size:            1024
  Group descriptor size:    64
  Reserved GDT blocks:      256
  Blocks per group:         8192
  Fragments per group:      8192
  Inodes per group:         1832
  Inode blocks per group:   229
  Flex block group size:    16
  Filesystem created:       Thu Feb 10 10:30:30 2022
  Last mount time:          n/a
  Last write time:          Thu Feb 10 10:30:30 2022
  Mount count:              0
  Maximum mount count:      -1
  Last checked:             Thu Feb 10 10:30:30 2022
  Check interval:           0 (<none>)
  Lifetime writes:          278 kB
  Reserved blocks uid:      0 (user root)
  Reserved blocks gid:      0 (group root)
  First inode:              11
  Inode size:               128
  Journal inode:            8
  Default directory hash:   half_md4
  Directory Hash Seed:      334a5650-55c0-4327-97ce-256db7bb0bba
  Journal backup:           inode blocks
  Checksum type:            crc32c
  Checksum:                 0x656632a3
  разлогиниться - ctl+alt+f3
[tuser1@thost1 Centos]#  lsof +D /home/cs/myfiles/
[tuser1@thost1 Centos]#  du -h /home/cs/myfiles/
  8.0K    /home/cs/myfiles/
[tuser1@thost1 Centos]#  fdisk -l /dev/sdb1
  Disk /dev/sdb1: 50 MiB, 52428800 bytes, 102400 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
[tuser1@thost1 Centos]#  mount /dev/sdb1 /mnt/
[tuser1@thost1 Centos]#  df -h
  Filesystem           Size  Used Avail Use% Mounted on
  devtmpfs             881M     0  881M   0% /dev
  tmpfs                909M     0  909M   0% /dev/shm
  tmpfs                909M  9.1M  900M   2% /run
  tmpfs                909M     0  909M   0% /sys/fs/cgroup
  /dev/mapper/cl-root   47G  5.5G   42G  12% /
  /dev/sda1           1014M  346M  669M  35% /boot
  Downloads            931G  321G  611G  35% /media/sf_Downloads
  tmpfs                182M   12K  182M   1% /run/user/42
  tmpfs                182M     0  182M   0% /run/user/0
  /dev/sdb1             45M  1.1M   40M   3% /mnt
[tuser1@thost1 Centos]#  mv -v /home/cs/myfiles/* /mnt
  copied '/home/cs/myfiles/group' -> '/mnt/group'
  removed '/home/cs/myfiles/group'
  copied '/home/cs/myfiles/passwd' -> '/mnt/passwd'
  removed '/home/cs/myfiles/passwd'
[tuser1@thost1 Centos]#  ll /mnt /home/cs/myfiles/
  /home/cs/myfiles/:
  total 0
  /mnt:
  total 20
  -rw-r--r--. 1 cs cs  1457 Feb 10 10:24 group
  drwx------. 2 root   root   12288 Feb 10 10:30 lost+found
  -rw-r--r--. 1 cs cs  3614 Feb 10 10:24 passwd
[tuser1@thost1 Centos]#  ll /mnt/
  total 20
  -rw-r--r--. 1 cs cs  1457 Feb 10 10:24 group
  drwx------. 2 root   root   12288 Feb 10 10:30 lost+found
  -rw-r--r--. 1 cs cs  3614 Feb 10 10:24 passwd
[tuser1@thost1 Centos]#  du -h /mnt | tail -1
  21K     /mnt
[tuser1@thost1 Centos]#  cat /etc/fstab
#
# /etc/fstab
# Created by anaconda on Fri Jan 14 04:46:51 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk/'.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run 'systemctl daemon-reload' to update systemd
# units generated from this file.
#
/dev/mapper/cl-root     /                       xfs     defaults        0 0
UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot                   xfs     defaults        0 0
/dev/mapper/cl-swap     none                    swap    defaults        0 0
[tuser1@thost1 Centos]#  blkid /dev/sdb1
  /dev/sdb1: UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c" BLOCK_SIZE="1024" TYPE="ext4" PARTUUID="87f777ab-01"
[tuser1@thost1 Centos]#  blkid /dev/sdb1 | cut -d' ' -f2
  UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c"
[tuser1@thost1 Centos]#  cp /etc/fstab{,.bkp}
[tuser1@thost1 Centos]#  ls -l /etc/fstab*
  -rw-r--r--. 1 root root 579 Jan 14 12:46 /etc/fstab
  -rw-r--r--. 1 root root 579 Feb 10 10:56 /etc/fstab.bkp
[tuser1@thost1 Centos]#  blkid /dev/sdb1 | cut -d' ' -f2 >> /etc/fstab
[tuser1@thost1 Centos]#  cat /etc/fstab
#
# /etc/fstab
# Created by anaconda on Fri Jan 14 04:46:51 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk/'.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run 'systemctl daemon-reload' to update systemd
# units generated from this file.
#
/dev/mapper/cl-root     /                       xfs     defaults        0 0
UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot                   xfs     defaults        0 0
/dev/mapper/cl-swap     none                    swap    defaults        0 0
UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c"
[tuser1@thost1 Centos]#  vim /etc/fstab
[tuser1@thost1 Centos]#  cat /etc/fstab
#
# /etc/fstab
# Created by anaconda on Fri Jan 14 04:46:51 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk/'.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run 'systemctl daemon-reload' to update systemd
# units generated from this file.
#
/dev/mapper/cl-root     /                       xfs     defaults        0 0
UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot                   xfs     defaults        0 0
/dev/mapper/cl-swap     none                    swap    defaults        0 0
UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c" /home/cs/myfiles ext4 defaults,auto 0 1
[tuser1@thost1 Centos]#  df -h
Filesystem           Size  Used Avail Use% Mounted on
devtmpfs             881M     0  881M   0% /dev
tmpfs                909M     0  909M   0% /dev/shm
tmpfs                909M  9.1M  900M   2% /run
tmpfs                909M     0  909M   0% /sys/fs/cgroup
/dev/mapper/cl-root   47G  5.5G   42G  12% /
/dev/sda1           1014M  346M  669M  35% /boot
Downloads            931G  321G  611G  35% /media/sf_Downloads
tmpfs                182M   12K  182M   1% /run/user/42
tmpfs                182M     0  182M   0% /run/user/0
/dev/sdb1             45M  1.1M   40M   3% /mnt
[tuser1@thost1 Centos]#  mount /home/cs/myfiles
  mount: /home/cs/myfiles: /dev/sdb1 already mounted on /mnt.
  залогиниться - ctl+f1
[tuser1@thost1 Centos]#  df -h
  Filesystem           Size  Used Avail Use% Mounted on
  devtmpfs             881M     0  881M   0% /dev
  tmpfs                909M     0  909M   0% /dev/shm
  tmpfs                909M  9.2M  900M   2% /run
  tmpfs                909M     0  909M   0% /sys/fs/cgroup
  /dev/mapper/cl-root   47G  5.5G   42G  12% /
  /dev/sda1           1014M  346M  669M  35% /boot
  /dev/sdb1             45M  1.1M   40M   3% /home/cs/myfiles
  Downloads            931G  321G  610G  35% /media/sf_Downloads
  tmpfs                182M   12K  182M   1% /run/user/42
  tmpfs                182M  4.0K  182M   1% /run/user/1000
Task:
Создайте директорию ~/mybackup. Создайте раздел с файловая система xfs, временно примонтируйте файловая система в директорию mybackup и перенесите данные из ~/myfiles на эту файловую систему. Отмонтируйте файловая система.
Decision:
[tuser1@thost1 Centos]#  mkdir ~/mybackup
[tuser1@thost1 Centos]#  lsof +D /home/cs/mybackup/
[tuser1@thost1 Centos]#  du -h /home/cs/mybackup/
  0       /home/cs/mybackup/
[tuser1@thost1 Centos]#  fdisk -l /dev/sdb2
  Disk /dev/sdb2: 50 MiB, 52428800 bytes, 102400 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
[tuser1@thost1 Centos]#  mkfs.xfs /dev/sdb2
  meta-data=/dev/sdb2              isize=512    agcount=2, agsize=6400 blks
           =                       sectsz=512   attr=2, projid32bit=1
           =                       crc=1        finobt=1, sparse=1, rmapbt=0
           =                       reflink=1
  data     =                       bsize=4096   blocks=12800, imaxpct=25
           =                       sunit=0      swidth=0 blks
  naming   =version 2              bsize=4096   ascii-ci=0, ftype=1
  log      =internal log           bsize=4096   blocks=1368, version=2
           =                       sectsz=512   sunit=0 blks, lazy-count=1
  realtime =none                   extsz=4096   blocks=0, rtextents=0
[tuser1@thost1 Centos]#  mount /dev/sdb2 /mnt/
[tuser1@thost1 Centos]#  df -h
  Filesystem           Size  Used Avail Use% Mounted on
  devtmpfs             881M     0  881M   0% /dev
  tmpfs                909M     0  909M   0% /dev/shm
  tmpfs                909M  9.1M  900M   2% /run
  tmpfs                909M     0  909M   0% /sys/fs/cgroup
  /dev/mapper/cl-root   47G  5.5G   42G  12% /
  /dev/sda1           1014M  346M  669M  35% /boot
  /dev/sdb1             45M  1.1M   40M   3% /home/cs/myfiles
  Downloads            931G  321G  610G  35% /media/sf_Downloads
  tmpfs                182M   12K  182M   1% /run/user/42
  tmpfs                182M     0  182M   0% /run/user/0
  /dev/sdb2             45M  3.0M   42M   7% /mnt
[tuser1@thost1 Centos]#  mv -v /home/cs/mybackup /mnt
  created directory '/mnt/mybackup'
  removed directory '/home/cs/mybackup'
[tuser1@thost1 Centos]#  mv -v /home/cs/myfiles /mnt
  created directory '/mnt/myfiles'
  created directory '/mnt/myfiles/lost+found'
  copied '/home/cs/myfiles/group' -> '/mnt/myfiles/group'
  copied '/home/cs/myfiles/passwd' -> '/mnt/myfiles/passwd'
  removed '/home/cs/myfiles/passwd'
  removed directory '/home/cs/myfiles/lost+found'
  removed '/home/cs/myfiles/group'
  mv: cannot remove '/home/cs/myfiles': Device or resource busy
[tuser1@thost1 Centos]#  ls /mnt/
  mybackup  myfiles
[tuser1@thost1 Centos]#  umount /mnt
[tuser1@thost1 Centos]#  df -h
  Filesystem           Size  Used Avail Use% Mounted on
  devtmpfs             881M     0  881M   0% /dev
  tmpfs                909M     0  909M   0% /dev/shm
  tmpfs                909M  9.1M  900M   2% /run
  tmpfs                909M     0  909M   0% /sys/fs/cgroup
  /dev/mapper/cl-root   47G  5.5G   42G  12% /
  /dev/sda1           1014M  346M  669M  35% /boot
  /dev/sdb1             45M  1.1M   40M   3% /home/cs/myfiles
  Downloads            931G  321G  610G  35% /media/sf_Downloads
  tmpfs                182M   12K  182M   1% /run/user/42
  tmpfs                182M     0  182M   0% /run/user/0
Task:
Управление логическими томами - LVM
Создайте LVM, состоящий из двух разделов и одного целого диска.
Внутри группы томов создайте два логических раздела, каждый из которых должен занимать 30% пространства группы томов.
При включении файловая система на первом логическом разделе должна монтироваться в директорию /data, а файловая система второго логического раздела должна монтироваться в директорию /backup.
Decision:
[tuser1@thost1 Centos]#  df -h
  Filesystem           Size  Used Avail Use% Mounted on
  devtmpfs             881M     0  881M   0% /dev
  tmpfs                909M     0  909M   0% /dev/shm
  tmpfs                909M  9.3M  900M   2% /run
  tmpfs                909M     0  909M   0% /sys/fs/cgroup
  /dev/mapper/cl-root   47G  5.5G   42G  12% /
  /dev/sda1           1014M  346M  669M  35% /boot
  Downloads            931G  322G  610G  35% /media/sf_Downloads
  tmpfs                182M   32K  182M   1% /run/user/1000
  /dev/sr0              59M   59M     0 100% /run/media/cs/VBox_GAs_6.1.29
[tuser1@thost1 Centos]#  lsblk
  NAME        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
  sda           8:0    0   50G  0 disk
  ├─sda1        8:1    0    1G  0 part /boot
  └─sda2        8:2    0   49G  0 part
    ├─cl-root 253:0    0   47G  0 lvm  /
    └─cl-swap 253:1    0  2.1G  0 lvm  [SWAP]
  sdb           8:16   0    1G  0 disk
  sdc           8:32   0    1G  0 disk
  sr0          11:0    1 58.3M  0 rom  /run/media/cs/VBox_GAs_6.1.29
[tuser1@thost1 Centos]#  sudo fdisk /dev/sdb
  Welcome to fdisk (util-linux 2.32.1).
  Changes will remain in memory only, until you decide to write them.
  Be careful before using the write command.
  Device does not contain a recognized partition table.
  Created a new DOS disklabel with disk identifier 0x45b7ad47.
Command (m for help): g
  Created a new GPT disklabel (GUID: F214B3AC-4B25-C44A-9B25-391159BDF128).
Command (m for help): n
Partition number (1-128, default 1):
First sector (2048-2097118, default 2048):
Last sector, +sectors or +size{K,M,G,T,P} (2048-2097118, default 2097118): +200M
  Created a new partition 1 of type 'Linux filesystem' and of size 200 MiB.
Command (m for help): n
Partition number (2-128, default 2):
First sector (411648-2097118, default 411648):
Last sector, +sectors or +size{K,M,G,T,P} (411648-2097118, default 2097118): +400M
  Created a new partition 2 of type 'Linux filesystem' and of size 400 MiB.
Command (m for help): p
  Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: gpt
  Disk identifier: F214B3AC-4B25-C44A-9B25-391159BDF128
  Device      Start     End Sectors  Size Type
  /dev/sdb1    2048  411647  409600  200M Linux filesystem
  /dev/sdb2  411648 1230847  819200  400M Linux filesystem
Command (m for help): w
  The partition table has been altered.
  Calling ioctl() to re-read partition table.
  Syncing disks.
[tuser1@thost1 Centos]#  sudo pvcreate /dev/sdb1
    Physical volume "/dev/sdb1" successfully created.
[tuser1@thost1 Centos]#  sudo pvs
    PV         VG Fmt  Attr PSize   PFree
    /dev/sda2  cl lvm2 a--  <49.00g      0
    /dev/sdb1     lvm2 ---  200.00m 200.00m
[tuser1@thost1 Centos]#  sudo pvdisplay /dev/sdb1
    "/dev/sdb1" is a new physical volume of "200.00 MiB"
    --- NEW Physical volume ---
    PV Name               /dev/sdb1
    VG Name
    PV Size               200.00 MiB
    Allocatable           NO
    PE Size               0
    Total PE              0
    Free PE               0
    Allocated PE          0
    PV UUID               Zh9vy1-BMtC-NwkZ-uelY-PTFf-XEO8-nINDjc
[tuser1@thost1 Centos]#  sudo vgcreate myvg /dev/sdb1
    Volume group "myvg" successfully created
[tuser1@thost1 Centos]#  sudo vgs
    VG   #PV #LV #SN Attr   VSize   VFree
    cl     1   2   0 wz--n- <49.00g      0
    myvg   1   0   0 wz--n- 196.00m 196.00m
[tuser1@thost1 Centos]#  sudo vgdisplay myvg
    --- Volume group ---
    VG Name               myvg
    System ID
    Format                lvm2
    Metadata Areas        1
    Metadata Sequence No  1
    VG Access             read/write
    VG Status             resizable
    MAX LV                0
    Cur LV                0
    Open LV               0
    Max PV                0
    Cur PV                1
    Act PV                1
    VG Size               196.00 MiB
    PE Size               4.00 MiB
    Total PE              49
    Alloc PE / Size       0 / 0
    Free  PE / Size       49 / 196.00 MiB
    VG UUID               jAA7BR-mEHr-V2F8-yu8A-Bzoq-POr1-VSdD2q
[tuser1@thost1 Centos]#  sudo lvcreate myvg -n mylv -L 200M
    Volume group "myvg" has insufficient free space (49 extents): 50 required.
[tuser1@thost1 Centos]#  sudo lvcreate myvg -n mylv -l 30%FREE
    Logical volume "mylv" created.
[tuser1@thost1 Centos]#  sudo lvcreate myvg -n mylv2 -l 30%FREE
    Logical volume "mylv2" created.
[tuser1@thost1 Centos]#  sudo lvs
    LV    VG   Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
    root  cl   -wi-ao---- <46.94g
    swap  cl   -wi-ao----  <2.06g
    mylv  myvg -wi-a-----  56.00m
    mylv2 myvg -wi-a-----  40.00m
[tuser1@thost1 Centos]#  sudo lvdisplay myvg
    --- Logical volume ---
    LV Path                /dev/myvg/mylv
    LV Name                mylv
    VG Name                myvg
    LV UUID                BXxmLe-zWBY-Syui-ifdb-uQ5h-7W8d-ER1fKc
    LV Write Access        read/write
    LV Creation host, time cs.virtualbox, 2022-02-12 10:27:18 +0800
    LV Status              available
    # open                 0
    LV Size                56.00 MiB
    Current LE             14
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:2
    --- Logical volume ---
    LV Path                /dev/myvg/mylv2
    LV Name                mylv2
    VG Name                myvg
    LV UUID                UO5u2O-61IE-niam-EogM-8WDg-jP8y-vMyzjf
    LV Write Access        read/write
    LV Creation host, time cs.virtualbox, 2022-02-12 10:33:40 +0800
    LV Status              available
    # open                 0
    LV Size                40.00 MiB
    Current LE             10
    Segments               1
    Allocation             inherit
    Read ahead sectors     auto
    - currently set to     8192
    Block device           253:3
[tuser1@thost1 Centos]#  ls /dev/myvg
  mylv  mylv2
[tuser1@thost1 Centos]#  sudo mkfs.ext4 /dev/myvg/mylv
  mke2fs 1.45.6 (20-Mar-2020)
  Creating filesystem with 57344 1k blocks and 14336 inodes
  Filesystem UUID: 4e2490cc-9a96-4cac-af6d-12f7835067ad
  Superblock backups stored on blocks:
          8193, 24577, 40961
  Allocating group tables: done
  Writing inode tables: done
  Creating journal (4096 blocks): done
  Writing superblocks and filesystem accounting information: done
[tuser1@thost1 Centos]#  sudo mkfs.ext4 /dev/myvg/mylv2
  mke2fs 1.45.6 (20-Mar-2020)
  Creating filesystem with 40960 1k blocks and 10240 inodes
  Filesystem UUID: 0c48275d-16e2-4054-a1c6-1d0da548eba3
  Superblock backups stored on blocks:
          8193, 24577
  Allocating group tables: done
  Writing inode tables: done
  Creating journal (4096 blocks): done
  Writing superblocks and filesystem accounting information: done
[tuser1@thost1 Centos]#  ll /dev/myvg/
  total 0
  lrwxrwxrwx. 1 root root 7 Feb 12 10:37 mylv -> ../dm-2
  lrwxrwxrwx. 1 root root 7 Feb 12 10:37 mylv2 -> ../dm-3
[tuser1@thost1 Centos]#  ll /dev/dm-*
  brw-rw----. 1 root disk 253, 0 Feb 10 09:25 /dev/dm-0
  brw-rw----. 1 root disk 253, 1 Feb 10 09:25 /dev/dm-1
  brw-rw----. 1 root disk 253, 2 Feb 12 10:37 /dev/dm-2
  brw-rw----. 1 root disk 253, 3 Feb 12 10:37 /dev/dm-3
[tuser1@thost1 Centos]#  sudo lsblk -f /dev/myvg/mylv
  NAME      FSTYPE LABEL UUID                                 MOUNTPOINT
  myvg-mylv ext4         4e2490cc-9a96-4cac-af6d-12f7835067ad
[tuser1@thost1 Centos]#  sudo lsblk -f /dev/myvg/mylv2
  NAME       FSTYPE LABEL UUID                                 MOUNTPOINT
  myvg-mylv2 ext4         0c48275d-16e2-4054-a1c6-1d0da548eba3
[tuser1@thost1 Centos]#  cat /etc/fstab
#
# /etc/fstab
# Created by anaconda on Fri Jan 14 04:46:51 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk/'.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run 'systemctl daemon-reload' to update systemd
# units generated from this file.
#
/dev/mapper/cl-root     /                       xfs     defaults        0 0
UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot                   xfs     defaults        0 0
/dev/mapper/cl-swap     none                    swap    defaults        0 0
[tuser1@thost1 Centos]#  ll /dev/mapper
  total 0
  lrwxrwxrwx. 1 root root       7 Feb 10 09:25 cl-root -> ../dm-0
  lrwxrwxrwx. 1 root root       7 Feb 10 09:25 cl-swap -> ../dm-1
  crw-------. 1 root root 10, 236 Feb 10 09:25 control
  lrwxrwxrwx. 1 root root       7 Feb 12 10:37 myvg-mylv -> ../dm-2
  lrwxrwxrwx. 1 root root       7 Feb 12 10:37 myvg-mylv2 -> ../dm-3
[tuser1@thost1 Centos]#  sudo vim /etc/fstab
[tuser1@thost1 Centos]#  cat /etc/fstab
#
# /etc/fstab
# Created by anaconda on Fri Jan 14 04:46:51 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk/'.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run 'systemctl daemon-reload' to update systemd
# units generated from this file.
#
/dev/mapper/cl-root     /                       xfs     defaults        0 0
UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot                   xfs     defaults        0 0
/dev/mapper/cl-swap     none                    swap    defaults        0 0
/dev/mapper/myvg-mylv   /data                   ext4    noatime         0 0
/dev/mapper/myvg-mylv2  /backup                 ext4    noatime         0 0
[tuser1@thost1 Centos]#  sudo mkdir /data
  mkdir: cannot create directory ‘/data’: File exists
[tuser1@thost1 Centos]#  sudo mkdir /backup
[tuser1@thost1 Centos]#  sudo mount /data
[tuser1@thost1 Centos]#  sudo mount /backup
[tuser1@thost1 Centos]#  df -h /data
  Filesystem             Size  Used Avail Use% Mounted on
  /dev/mapper/myvg-mylv   51M  1.1M   46M   3% /data
[tuser1@thost1 Centos]#  df -h /backup
  Filesystem              Size  Used Avail Use% Mounted on
  /dev/mapper/myvg-mylv2   35M  782K   32M   3% /backup
Source:
https://codernotes.ru/articles/administrirovanie-linux/chem-zanyato-mesto-na-diske-linux.html
https://losst.ru/komanda-du-v-linux
https://www.youtube.com/watch?v=qXq7qH_MdV8&list=PLtSGboPf3g50Aejrp6KjQsqqjxvAO4aKw&index=4
https://basis.gnulinux.pro/ru/latest/basis/25/25._%D0%9F%D1%80%D0%B0%D0%BA%D1%82%D0%B8%D0%BA%D0%B0.html#"
Task:
Добавьте 2 диска по 1Гб к виртуалке. На первом диске создайте ТР MBR и 3 основных раздела по 50Мб, на втором ТР GPT и 2 раздела по 100Мб. Сохраните и покажите список разделов.
Decision:
[tuser1@thost1 Centos]#  sudo poweroff
- VirtualBox - Настроить - Носители - Контроллер SATA - Добавить жесткий диск - Создать - 1гб - выбрать - ок - запустить
[tuser1@thost1 Centos]#  lsscsi -s
  [1:0:0:0]    cd/dvd  VBOX     CD-ROM           1.0   /dev/sr0   61.1MB
  [2:0:0:0]    disk    ATA      VBOX HARDDISK    1.0   /dev/sda   53.6GB
  [3:0:0:0]    disk    ATA      VBOX HARDDISK    1.0   /dev/sdb   1.07GB
  [4:0:0:0]    disk    ATA      VBOX HARDDISK    1.0   /dev/sdc   1.07GB
[tuser1@thost1 Centos]#  sudo fdisk /dev/sdb
  [sudo] password for cs:
  Welcome to fdisk (util-linux 2.32.1).
  Changes will remain in memory only, until you decide to write them.
  Be careful before using the write command.
  Device does not contain a recognized partition table.
  Created a new DOS disklabel with disk identifier 0x357e75ef.
Command (m for help): m
  Help:
    DOS (MBR)
     a   toggle a bootable flag
     b   edit nested BSD disklabel
     c   toggle the dos compatibility flag
    Generic
     d   delete a partition
     F   list free unpartitioned space
     l   list known partition types
     n   add a new partition
     p   print the partition table
     t   change a partition type
     v   verify the partition table
     i   print information about a partition
    Misc
     m   print this menu
     u   change display/entry units
     x   extra functionality (experts only)
    Script
     I   load disk layout from sfdisk script file
     O   dump disk layout to sfdisk script file
    Save & Exit
     w   write table to disk and exit
     q   quit without saving changes
    Create a new label
     g   create a new empty GPT partition table
     G   create a new empty SGI (IRIX) partition table
     o   create a new empty DOS partition table
     s   create a new empty Sun partition table
Command (m for help): p
  Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: dos
  Disk identifier: 0x357e75ef
Command (m for help): o
  Created a new DOS disklabel with disk identifier 0x87f777ab.
Command (m for help): n
  Partition type
     p   primary (0 primary, 0 extended, 4 free)
     e   extended (container for logical partitions)
Select (default p): p
Partition number (1-4, default 1): 3
First sector (2048-2097151, default 2048):
Last sector, +sectors or +size{K,M,G,T,P} (2048-2097151, default 2097151): +50M
  Created a new partition 3 of type 'Linux' and of size 50 MiB.
Command (m for help): n
  Partition type
     p   primary (1 primary, 0 extended, 3 free)
     e   extended (container for logical partitions)
Select (default p): p
Partition number (1,2,4, default 1): 1
First sector (104448-2097151, default 104448):
Last sector, +sectors or +size{K,M,G,T,P} (104448-2097151, default 2097151): +50M
  Created a new partition 1 of type 'Linux' and of size 50 MiB.
Command (m for help): n
  Partition type
     p   primary (2 primary, 0 extended, 2 free)
     e   extended (container for logical partitions)
Select (default p): p
Partition number (2,4, default 2): 2
First sector (206848-2097151, default 206848):
Last sector, +sectors or +size{K,M,G,T,P} (206848-2097151, default 2097151): +50M
  Created a new partition 2 of type 'Linux' and of size 50 MiB.
Command (m for help): p
  Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: dos
  Disk identifier: 0x87f777ab
  Device     Boot  Start    End Sectors Size Id Type
  /dev/sdb1       104448 206847  102400  50M 83 Linux
  /dev/sdb2       206848 309247  102400  50M 83 Linux
  /dev/sdb3         2048 104447  102400  50M 83 Linux
  Partition table entries are not in disk order.
Command (m for help): w
  The partition table has been altered.
  Calling ioctl() to re-read partition table.
  Syncing disks.
[tuser1@thost1 Centos]#  sudo fdisk /dev/sdc
[sudo] password for cs:
  Welcome to fdisk (util-linux 2.32.1).
  Changes will remain in memory only, until you decide to write them.
  Be careful before using the write command.
  Device does not contain a recognized partition table.
  Created a new DOS disklabel with disk identifier 0x275ab546.
Command (m for help): p
  Disk /dev/sdc: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: dos
  Disk identifier: 0x275ab546
Command (m for help): g
  Created a new GPT disklabel (GUID: 1ED9FC80-4FEE-934E-A504-725D4C9F611F).
Command (m for help): n
Partition number (1-128, default 1): 1
First sector (2048-2097118, default 2048):
Last sector, +sectors or +size{K,M,G,T,P} (2048-2097118, default 2097118): +100M
  Created a new partition 1 of type 'Linux filesystem' and of size 100 MiB.
Command (m for help): n
Partition number (2-128, default 2): 2
First sector (206848-2097118, default 206848):
Last sector, +sectors or +size{K,M,G,T,P} (206848-2097118, default 2097118): +100M
  Created a new partition 2 of type 'Linux filesystem' and of size 100 MiB.
Command (m for help): p
  Disk /dev/sdc: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: gpt
  Disk identifier: 1ED9FC80-4FEE-934E-A504-725D4C9F611F
  Device      Start    End Sectors  Size Type
  /dev/sdc1    2048 206847  204800  100M Linux filesystem
  /dev/sdc2  206848 411647  204800  100M Linux filesystem
Command (m for help): w
  The partition table has been altered.
  Calling ioctl() to re-read partition table.
  Syncing disks.
[tuser1@thost1 Centos]#  sudo fdisk -l /dev/sdb
  Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: dos
  Disk identifier: 0x87f777ab
  Device     Boot  Start    End Sectors Size Id Type
  /dev/sdb1       104448 206847  102400  50M 83 Linux
  /dev/sdb2       206848 309247  102400  50M 83 Linux
  /dev/sdb3         2048 104447  102400  50M 83 Linux
  Partition table entries are not in disk order.
[tuser1@thost1 Centos]#  sudo fdisk -l /dev/sdc
  Disk /dev/sdc: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: gpt
  Disk identifier: 1ED9FC80-4FEE-934E-A504-725D4C9F611F
  Device      Start    End Sectors  Size Type
  /dev/sdc1    2048 206847  204800  100M Linux filesystem
  /dev/sdc2  206848 411647  204800  100M Linux filesystem
Task:
Добавьте на первом диске ещё 2 раздела по 100Мб, при этом не удаляя ранее созданные разделы.
Decision:
Command (m for help): p
  Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: dos
  Disk identifier: 0x87f777ab
  Device     Boot  Start    End Sectors Size Id Type
  /dev/sdb1       104448 206847  102400  50M 83 Linux
  /dev/sdb2       206848 309247  102400  50M 83 Linux
  /dev/sdb3         2048 104447  102400  50M 83 Linux
  Partition table entries are not in disk order.
Command (m for help): n
  Partition type
     p   primary (3 primary, 0 extended, 1 free)
     e   extended (container for logical partitions)
Select (default e): e
  Selected partition 4
First sector (309248-2097151, default 309248):
Last sector, +sectors or +size{K,M,G,T,P} (309248-2097151, default 2097151): +100M
  Created a new partition 4 of type 'Extended' and of size 100 MiB.
Command (m for help): n
  All primary partitions are in use.
  Adding logical partition 5
First sector (311296-514047, default 311296):
Last sector, +sectors or +size{K,M,G,T,P} (311296-514047, default 514047): +100M
  Value out of range.
Last sector, +sectors or +size{K,M,G,T,P} (311296-514047, default 514047):
  Created a new partition 5 of type 'Linux' and of size 99 MiB.
Command (m for help): p
  Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: dos
  Disk identifier: 0x87f777ab
  Device     Boot  Start    End Sectors  Size Id Type
  /dev/sdb1       104448 206847  102400   50M 83 Linux
  /dev/sdb2       206848 309247  102400   50M 83 Linux
  /dev/sdb3         2048 104447  102400   50M 83 Linux
  /dev/sdb4       309248 514047  204800  100M  5 Extended
  /dev/sdb5       311296 514047  202752   99M 83 Linux
  Partition table entries are not in disk order.
Command (m for help): w
  The partition table has been altered.
  Calling ioctl() to re-read partition table.
  Syncing disks.
Task:
Удалите со второго диска второй раздел.
Decision:
[tuser1@thost1 Centos]#  sudo fdisk /dev/sdc
  Welcome to fdisk (util-linux 2.32.1).
  Changes will remain in memory only, until you decide to write them.
  Be careful before using the write command.
Command (m for help): d
Partition number (1,2, default 2): 2
  Partition 2 has been deleted.
Command (m for help): p
  Disk /dev/sdc: 1 GiB, 1073741824 bytes, 2097152 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: gpt
  Disk identifier: 1ED9FC80-4FEE-934E-A504-725D4C9F611F
  Device     Start    End Sectors  Size Type
  /dev/sdc1   2048 206847  204800  100M Linux filesystem
Command (m for help): w
  The partition table has been altered.
  Calling ioctl() to re-read partition table.
  Syncing disks.
Task:
Создайте сжатый архив файлов, измененных за последнюю неделю (tar, gzip, find, cpio)
Decision:
$ find / -type f -mtime -7 > files.txt 2>/dev/null
$ tar -cf arch.tar -T files.txt 2>/dev/null
$ gzip arch.tar
$ gzip -l arch.tar.gz
compressed uncompressed ratio uncompressed_name
60560158 163093504 62.9% arch.tar
Task:
Переведите часы на зимнее время (на 1 час назад)
Decision:
$ date
Fri Nov 30 15:58:48 2007
$ date --s -1hour
Fri Nov 30 14:58:54 2007
Task:
Исключить обновление определенного пакета
Decision:
# dnf update
  Последняя проверка окончания срока действия метаданных: 0:33:32 назад, Пн 21 фев 2022 12:18:38.
  Зависимости разрешены.
  ================================================================================
   Пакет                Архитектура    Версия          Репозиторий          Размер
  ================================================================================
  Обновление:
   sublime-text         x86_64         4126-1          sublime-text          20 M
  Результат транзакции
  ================================================================================
  Обновление  1 Пакет
  Объем загрузки: 20 M
  Продолжить? [д/Н]: n
  Операция отменена.
# cat /etc/dnf/dnf.conf
[main]
gpgcheck=1
installonly_limit=3
clean_requirements_on_remove=True
best=True
skip_if_unavailable=False
# vim /etc/dnf/dnf.conf
# cat /etc/dnf/dnf.conf
[main]
gpgcheck=1
installonly_limit=3
clean_requirements_on_remove=True
best=True
skip_if_unavailable=False
## Exclude following Packages Updates ##
exclude=sublime-text
# dnf update
  Последняя проверка окончания срока действия метаданных: 0:33:57 назад, Пн 21 фев 2022 12:18:38.
  Зависимости разрешены.
  Отсутствуют действия для выполнения.
  Выполнено!
Task:
Adding the Ubuntu using wsl
Decision:
C:\Users\dd>powershell "start-process powershell -verb runas"
PS C:\Windows\system32> wsl --list --online
PS C:\Windows\system32> wsl --install -d Ubuntu-20.04
PS C:\Windows\system32> Restart-Computer
Task:
чтобы увеличить звук проигрывателя
Decision:
- пуск -> K-lite codec -> Media Player Classi-c -> вид -> настройки -> встроенные фильтры -> аудиопереключатель можно поставить галочку на нормализацию -> убрать галочку на восстанавливать громкость -> настроить усиление по больше.
Task:
восстановление системы даже под обычной загрузки
Decision: 
- пробуем в командной строке открыть доступ к папке с файлами, которые следует заменить С:\windows\System32\config.С флешки эту папку нужно открыть и внутри удалить/вырезать 5 файлов DEFAUT,SAM, SECURITY,SOFTWARE,SYSTEM,и с regpack переношу эти же файлы в конфиг и перезагружаюсь
Task:
Установить Sublimetext
Decision:
$ sudo rpm -v --import https://download.sublimetext.com/sublimehq-rpm-pub.gpg
$ sudo dnf config-manager --add-repo https://download.sublimetext.com/rpm/stable/x86_64/sublime-text.repo
$ sudo dnf -y install sublime-text
Source:
https://www.sublimetext.com/docs/linux_repositories.html#dnf
Task:
Установить Visualstudio в Linux
Decision:
$ sudo rpm --import https://packages.microsoft.com/keys/microsoft.asc
$ sudo sh -c 'echo -e "[code]\nname=Visual Studio Code\nbaseurl=https://packages.microsoft.com/yumrepos/vscode\nenabled=1\ngpgcheck=1\ngpgkey=https://packages.microsoft.com/keys/microsoft.asc" > /etc/yum.repos.d/vscode.repo'
$ dnf check-update
$ sudo dnf install code -y
$ code
Source:
https://code.visualstudio.com/docs/setup/linux
Task:
Vim.
Заменить все вхождения “old” на “new”
Decision:
:%s/OldWords/NewWords/g
Task:
Составьте crontab файл для следующих процессов: 
1. daily1.sh - ежедневно в 23:55. 
2. daily2.sh - ежедневно в 8:00 и 17:00 
3. hourly.sh - каждый час в рабочее время (пн-пт, 8:00-17:30) 
4. happy_new_year.sh - в момент наступления нового года 
5. quatre.sh - каждые 4 часа
Decision:
$ crontab -l
...
55 23 * * * /tdir/daily1.sh > /tdir/addtestfile
0 8-17 * * * /tdir/daily2.sh > /tdir/addtestfile
0 8-17 * * 1-5 /tdir/hourly.sh > /tdir/addtestfile
0 0 1 1 * /tdir/happy_new_year.sh > /tdir/addtestfile
* */4 * * * /tdir/quatre.sh > /tdir/addtestfile
Task:
допустим у нас есть файл testcron.sh.
$ cat testcron.sh
#!/bin/bash
echo "It is now $(date +%T) on (date +%A)"
$chmod +x testcron.sh
если его выполнить
$ ./testcron.sh
It is now 08:04:32 on (date +%A)
Выполнить тестовый скрипт каждую минуту
Decision:
$ crontab -e
No modification made
$ crontab -e
* * * * * /home/administrator/testcron.sh
Task:
Выполнить тестовый скрипт каждую минуту и добавим вывод в лог.
Decision:
$ crontab -e
* * * * * /home/administrator/testcron.sh >> /home/administrator/test.log
$ ls
examples.desktop Видео Изображения 'Рабочий стол'
testcron.sh Документы Музыка Шаблоны
test.log Загрузки Общедоступные
$ cat test.log
$ cat test.log
It is now 08:05:01 on (date +%A)
$ crontab -l
# Edit this file to introduce tasks to be run by cron.
#
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
#
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').#
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)
#
# m h dom mon dow command
* * * * * /home/linux/testcron.sh >> /home/linux/test.log
$ sudo crontab -l
no crontab for root
Task:
Отредактируем таблицу cron root. Мы перезагрузим сервер в 4:15, вывод в null. /dev/null - вывода не будет, чтобы не спамило журнал системы.
Decision:
$ sudo crontab -e
15 4 * * * /sbin/reboot > /dev/null 2>&1 #
0 */2 * * * /etc/init.d/nginx restart >> /dev/null 2>&1 #Перезапустить nginx каждый чётный час - */2
$ sudo crontab -l
# Edit this file to introduce tasks to be run by cron.
#
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
#
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').#
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)
#
# m h dom mon dow command
15 4 * * * /sbin/reboot > /dev/null 2>&1
0 */2 * * * /etc/init.d/nginx restart >> /dev/null 2>&1
$ cat test.log
It is now 08:05:01 on (date +%A)
It is now 08:06:01 on (date +%A)
$ date
Сб мар 7 08:06:01 MSK 2020
$ journalctl -e
 мар 07 08:03:19 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:19 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:24 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:24 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces
 мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Successfully made thread 2635 of
 мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 5 threads of 3 proces
 мар 07 08:03:35 VirtualBox rtkit-daemon[1069]: Supervising 5 threads of 3 proces
 мар 07 08:03:35 VirtualBox rtkit-daemon[1069]: Supervising 5 threads of 3 proces
 мар 07 08:04:01 VirtualBox CRON[2678]: pam_unix(cron:session): session opened fo
 мар 07 08:04:01 VirtualBox CRON[2679]: (linux) CMD (/home/linux/testcron.sh >> /
 мар 07 08:04:01 VirtualBox CRON[2678]: (CRON) info (No MTA installed, discarding
 мар 07 08:04:01 VirtualBox CRON[2678]: pam_unix(cron:session): session closed fo
 мар 07 08:05:01 VirtualBox CRON[2699]: pam_unix(cron:session): session opened fo
 мар 07 08:05:01 VirtualBox CRON[2700]: (linux) CMD (/home/linux/testcron.sh >> /
 мар 07 08:05:01 VirtualBox CRON[2699]: pam_unix(cron:session): session closed fo
 мар 07 08:05:09 VirtualBox gnome-shell[1033]: JS WARNING: [resource:///org/gnome
 мар 07 08:06:01 VirtualBox CRON[2719]: pam_unix(cron:session): session opened fo
 мар 07 08:06:01 VirtualBox CRON[2720]: (linux) CMD (/home/linux/testcron.sh >> /
 мар 07 08:06:01 VirtualBox CRON[2719]: pam_unix(cron:session): session closed fo
$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
# m h dom mon dow user command
17 * * * * root cd / && run-parts --report /etc/cron.hourly
25 6 * * * root test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6 1 * * root test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
Task:
Редактировать таблицу cron пользователя linux
Decision:
$ sudo crontab -u linux -e
Task:
Создайте скрипт, который создаёт файл. Настройте запуск этого скрипта раз в минуту. Проверьте результат.
Decision:
$ vim BASH-CronScript1.sh
$ cat BASH-CronScript1.sh
#!/bin/bash
touch testfile
$ ./BASH-CronScript1.sh
$ sudo cp BASH-CronScript1.sh /usr/bin/
$ BASH-CronScript1.sh
$ ls -l testfile
-rw-rw-r--. 1 ur ur 0 мая  4 09:48 testfile
$ cat /etc/crontab
SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
# For details see man 4 crontabs
# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * ur-name  command to be executed
$ crontab -e
no crontab for ur - using an empty one
crontab: installing new crontab
$ crontab -l
*  *  *  *  *  /usr/bin/BASH-CronScript1.sh
$ ls -l testfile
-rw-rw-r--. 1 ur ur 0 мая  4 09:58 testfile
$ ls -l testfile
-rw-rw-r--. 1 ur ur 0 мая  4 09:59 testfile
Task:
Настройте в at задачу, чтобы она создала файл через 3 минуты.
Decision:
$ at now + 3 minutes
warning: commands will be executed using /bin/sh
at> /usr/bin/BASH-CronScript1.sh
at> <EOT>
job 3 at Wed May  4 10:34:00 2022
$ ls -l testfile
-rw-rw-r--. 1 ur ur 0 мая  4 10:34 testfile
Task:
Настройте cron, чтобы он создавал директорию при каждой перезагрузке.
Decision:
$ crontab -e
crontab: installing new crontab
$ ls
$ crontab -l
#*  *  *  *  *  /usr/bin/BASH-CronScript1.sh
@reboot mkdir testdir
$ ls -l
...
drwxr-xr-x. 2 ur ur    4096 мая  4 10:37  testdir
...
Task:
Создайте пользователя backup и настройте для него cron, чтобы тот раз в день находил файлы старее 5 дней в директории /data и добавлял эти файлы в архив /backup/archive.tar, после чего удалял из исходной директории. Настройте cron у пользователя ur, чтобы он каждые 10 минут создавал файл в директории /data.
Также у пользователя root создайте cron, чтобы он каждую пятницу в 23:30 записывал содержимое директории /data и содержимое архива /backup/archive.tar в файл /var/log/reports/текущаядата.
Decision:
$ sudo useradd backup2
$ sudo passwd backup2
$ sudo mkdir /backup/
$ ls -l /data
итого 0
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile1
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile2
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile3
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile4
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile5
$ su - backup2
$ ls -l /data/
итого 0
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile1
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile2
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile3
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile4
-rw-r--r--. 1 root root 0 апр 14 13:14 testfile5
$ vim Linux-Gnulinux-TaskScheduler1.sh
$ cat Linux-Gnulinux-TaskScheduler1.sh
#!/bin/bash
# Создайте пользователя backup и настройте для него cron, чтобы тот раз в день находил файлы старее 5 дней в директории /data и добавлял эти файлы в архив /backup/archive.tar, после чего удалял из исходной директории.
if find /data/ -type f -mtime +5; then
cd /data
tar -cvf /backup/archive.tar testfile*
rm -rf /data/testfile*
else
echo "No files"
fi
$ sudo rm -rf /backup/archive.tar
$ sudo ./Linux-Gnulinux-TaskScheduler1.sh
/data/testfile5
/data/testfile1
/data/testfile3
/data/testfile2
/data/testfile4
testfile1
testfile2
testfile3
testfile4
testfile5
$ ls -l /data/
итого 0
$ ls -l /backup/
итого 12
-rw-r--r--. 1 root root 10240 мая 11 11:19 archive.tar
$ sudo tar -tf /backup/archive.tar
testfile1
testfile2
testfile3
testfile4
testfile5
$ crontab -e
no crontab for backup2 - using an empty one
crontab: installing new crontab
$ crontab -l
5 11 * * * tar --totals -cvf /backup/archive.tar /data/testfile{1..2} | rm -rf /data/testfile{1..2}
$ sudo mv Linux-Gnulinux-TaskScheduler1.sh /usr/bin/
$ exit
$ sudo vim /var/spool/cron/backup2
$ sudo cat /var/spool/cron/backup2
@daily /usr/bin/Linux-Gnulinux-TaskScheduler1.sh
$ vim Linux-Gnulinux-TaskScheduler2.sh
$ cat Linux-Gnulinux-TaskScheduler2.sh
#!/bin/bash
touch /data/testfile0
$ sudo chown user:user /data
$ ls -l /
...
drwxr-xr-x.   2 user user  4096 мая 11 11:19 data
...
$ sudo mv Linux-Gnulinux-TaskScheduler2.sh /usr/bin
$ whoami
user
$ crontab -e
crontab: installing new crontab
$ crontab -l
#*  *  *  *  *  /usr/bin/BASH-CronScript1.sh
@reboot mkdir testdir
*/10  *  *  *  *  /usr/bin/Linux-Gnulinux-TaskScheduler2.sh
$ ls -l /data/
итого 0
-rw-r--r--. 1 user user 0 мая 12 08:57 testfile0
$ sudo vim /usr/bin/Linux-Gnulinux-TaskScheduler3.sh
$ sudo cat /usr/bin/Linux-Gnulinux-TaskScheduler3.sh
#!/bin/bash
# Также у пользователя root создайте cron, чтобы он каждую пятницу в 23:30 записывал содержимое директории /data и содержимое архива /backup/archive.tar в файл /var/log/reports/текущаядата.
mkdir /var/log/reports
ls -l /data > /var/log/reports/$(date +"%d.%m.%Y")
tar -tf /backup/archive.tar >> /var/log/reports/$(date +"%d.%m.%Y")
$ sudo vim /var/spool/cron/root
$ sudo cat /var/spool/cron/root
30  23  *  *  5  /usr/bin/Linux-Gnulinux-TaskScheduler3.sh
Source:
https://basis.gnulinux.pro/ru/latest/
Task:
Установить qemu-kvm.
Decision:
$ egrep -c '(vmx|svm)' /proc/cpuinfo
$ sudo apt install qemu-kvm libvirt-daemon-system virtinst libvirt-clients bridge-utils virt-manager
$ systemctl start libvirtd
$ systemctl enable libvirtd
$ kvm-ok
$ sudo usermod -aG kvm Tuser
$ sudo usermod -aG libvirt Tuser
$ ip link | grep virb
Task:
Установить виртуальную машину в qemu-kvm
Decision:
$ sudo virt-install \
--name thost \
--ram 2048 \
--disk path=/var/lib/libvirt/images/thost.qcow2,size=50 \
--vcpus 2 \
--os-variant ubuntu22.04 \
--network default \
--cdrom /var/lib/libvirt/images/ubuntu-22.04.3-desktop-amd64.iso
$ virt-viewer --connect qemu:///system --wait thost
Source:
https://winitpro.ru/index.php/2020/02/10/virsh-upravlenie-virtualnymi-mashinami-kvm/
https://winitpro.ru/index.php/2020/02/04/ustanovka-zapusk-kvm-v-linux-centos/
https://www.server-world.info/en/note?os=CentOS_Stream_9&p=kvm&f=1
https://www.server-world.info/en/note?os=CentOS_Stream_9&p=initial_conf&f=3
https://www.server-world.info/en/note?os=CentOS_Stream_9&p=kvm&f=2
https://bozza.ru/art-260.html
Task:
How to create snapshots of QEMU/KVM guests
Decision:
$ virsh snapshot-create-as thost snapshot0 --description "update+ssh"
$ virsh snapshot-list thost
Name    Creation Time       State
--------------------------------------------------
snapshot0 2024-03-09 09:46:33 +0800 running
Source:
Creating snapshots with virsh - https://linuxconfig.org/how-to-create-snapshots-of-qemu-kvm-guests
Task:
Установить dbeaver
Decision:
$ wget https://dbeaver.io/files/dbeaver-ce_latest_amd64.deb
$ sudo apt install ./dbeaver-ce_latest_amd64.deb
Task:
Добавить нового пользователя в posgresql, добавить ему пароль и создать новую базу с таблицей
Decision:
# CREATE USER tuser2 WITH PASSWORD 'tpassword2';
# CREATE DATABASE tdb2;
# \c tdb2
# CREATE TABLE ttable3 (
name varchar(80),
location point
);
# \d
    List of relations
Schema | Name | Type | Owner 
--------+--------+-------+-------
public | cities | table | tuser
(1 row)
Source:
Создание таблицы - https://postgrespro.ru/docs/postgrespro/9.5/tutorial-table
Task:
Изменить пароль в базе
Decision:
$ mysql -u root -p
mysql> SELECT user,authentication_string,plugin,host FROM mysql.user;
mysql> ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'tP@ssw0rd';
mysql> \q
Task:
Install PostgreSQL, добавить новую учетную запись и перенести базу данных в posgresql
Decision:
$ sudo apt install postgresql postgresql-contrib
$ sudo usermod -aG postgres tuser2
$ sudo -i -u postgres
$ psql
# \q
$ createuser --interactive
Enter name of role to add: tuser2
Shall the new role be a superuser? (y/n) y
$ createdb tdb2
$ exit
$ sudo -i -u tuser2
$ psql -U tuser2 -d tdb2
# \password
# GRANT ALL PRIVILEGES ON DATABASE tdb2 to tuser2;
# GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO "tuser2";
# ALTER DATABASE tdb2 OWNER TO tuser2;
# GRANT pg_read_all_settings TO tuser2;
# \conninfo
# \l+
# SHOW config_file;
...
/etc/postgresql/14/main/postgresql.conf
# \q
$ cat /etc/postgresql/14/main/postgresql.conf
...
#listen_addresses = 'localhost'       # what IP address(es) to listen on;
...
$ sudo vim /etc/postgresql/14/main/postgresql.conf
$ cat /etc/postgresql/14/main/postgresql.conf
...
listen_addresses = 'tip, tip2'       # what IP address(es) to listen on;
...
$ sudo cat /etc/postgresql/14/main/pg_hba.conf
...
# "local" is for Unix domain socket connections only
local all       all                   peer
...
$ sudo vim /etc/postgresql/14/main/pg_hba.conf
$ sudo cat /etc/postgresql/14/main/pg_hba.conf
...
# "local" is for Unix domain socket connections only
host  tdb2   tuser2      tip2/21   md5
local all       all                   peer
...
$ sudo systemctl restart postgresql
$ psql -U tuser2 -d tdb2 -h tip
Source:
How To Install PostgreSQL on Ubuntu 22.04 [Quickstart] - https://www.digitalocean.com/community/tutorials/how-to-install-postgresql-on-ubuntu-22-04-quickstart
Измените пароль для выбранного пользователя - https://uchet-jkh.ru/i/kak-izmenit-parol-k-baze-dannyx-postgresql/
Grant Role to the non-default user - https://asvignesh.in/how-to-get-the-postgresql-conf-file-location/
Task:
Просмотр занятого места на разделах
Decision:
$ sudo df -h
Filesystem   Size Used Avail Use% Mounted on
tmpfs     196M 1.6M 195M 1% /run
/dev/sda3    49G 31G 16G 67% /
tmpfs     980M   0 980M 0% /dev/shm
tmpfs     5.0M 4.0K 5.0M 1% /run/lock
/dev/sda2   512M 6.1M 506M 2% /boot/efi
tmpfs     196M 76K 196M 1% /run/user/127
tmpfs     196M 64K 196M 1% /run/user/1001
Source:
Просмотр занятого места на разделах командой du - https://winitpro.ru/index.php/2021/02/20/svobodnoe-mesta-na-diske-v-linux/
Task:
Настроить диск с файловой системой exfat.
Decision:
$ sudo apt install exfat-fuse
$ sudo mkfs -t exfat /dev/sdc1
Task:
На физическом сервере критически было мало места на диске. В связи с этим настроил подключение к другому физическому диску для хранилища виртуальных машин и баз данных, а сервер оставил для корректной работы с Веб-сервером на Django.
Decision:
$ lsblk
...
sdc   8:32 0 931,5G 0 disk 
$ sudo fdisk /dev/sdc
...
Команда (m для справки): n
...
Выберите (по умолчанию - p): p
...
$ lsblk
...
sdc   8:32 0 931,5G 0 disk 
└─sdc1 8:33 0 931,5G 0 part 
$ sudo mkfs -t ext4 /dev/sdc1
$ sudo mount /dev/sdc1 /var/lib/libvirt/images/
$ sudo cp -p ubuntu22.04.qcow2 /var/lib/libvirt/images/
$ sudo virt-install \
--name Ubuntu2204 \
--ram 2048 \
--vcpus 2 \
--disk /var/lib/libvirt/images/ubuntu22.04.qcow2,bus=sata \
--import \
--os-variant ubuntu22.04 \
--network default
$ virsh shutdown Ubuntu2204
$ sudo virt-install \
--name Centos9 \
--ram 2048 \
--vcpus 2 \
--disk /var/lib/libvirt/images/Centos_9.img,bus=sata \
--import \
--os-variant rhel9-unknown \
--network default
$ sudo qemu-img info /var/lib/libvirt/images/Kali.qcow2
$ virt-install --os-variant list | grep debian
$ sudo virt-install \
--name Kali \
--ram 2048 \
--vcpus 2 \
--disk /var/lib/libvirt/images/Kali.qcow2,bus=sata \
--import \
--os-variant debian11 \
--network default
$ sudo virt-install \
--name Windows \
--ram 2048 \
--vcpus 2 \
--disk path=/var/lib/libvirt/images/Windows.qcow2,bus=sata \
--import \
--os-variant win10 \
--network default
$ sudo virt-install \
--name Windows12 \
--ram 2048 \
--vcpus 2 \
--disk path=/var/lib/libvirt/images/Windows12.qcow2,bus=sata \
--import \
--os-variant win2k12 \
--network default
$ sudo umount /var/lib/libvirt/images/
$ sudo systemctl stop postgresql
$ sudo -i -u postgres
$ cp -r 14 14.backup
$ ls -l
итого 8
drwxr-xr-x 3 postgres postgres 4096 фев 25 19:33 14
drwxr-xr-x 3 postgres postgres 4096 фев 25 19:57 14.backup
$ sudo mount /dev/sdc1 /var/lib/postgresql/14
$ sudo cp -pr /var/lib/postgresql/14.backup /var/lib/postgresql/14/
$ sudo mv /var/lib/postgresql/14/14.backup /var/lib/postgresql/14/14
$ sudo ls -l /var/lib/postgresql/14
итого 87992628
drwxr-xr-x 3 postgres postgres    4096 фев 25 19:57 14
drwx------ 2 root   root     16384 фев 21 20:50 lost+found
-rw------- 1 tuser   tuser   90104397824 фев 24 19:44 ubuntu22.04.qcow2
$ sudo umount /var/lib/postgresql/14
$ sudo mount /dev/sdc1 /var/lib/postgresql
$ sudo systemctl start postgresql
$ sudo -u tuser psql -d tdb
# \d
    List of relations
Schema | Name | Type | Owner 
--------+--------+-------+-------
public | cities | table | tuser
(1 row)
# CREATE TABLE countries (
  name      varchar(80),
  location    point
);
# exit
$ sudo systemctl stop postgresql
$ sudo umount /var/lib/postgresql
$ sudo systemctl start postgresql
Source:
Import Qcow2 images using virt-install command - https://ostechnix.com/create-a-kvm-virtual-machine-using-qcow2-image-in-linux/
Перенос базы - https://etogeek.dev/posts/move-psql/
копирование файлов с правами и пользователями - https://www.linux.org.ru/forum/general/8186570
Importing a virtual machine image - https://access.redhat.com/documentation/ru-ru/red_hat_enterprise_linux/7/html/virtualization_deployment_and_administration_guide/sect-guest_virtual_machine_installation_overview-creating_guests_with_virt_install
Task:
Установить и настроить SSH в Ubuntu 22.04
Decision:
$ sudo apt update && sudo apt upgrade
$ sudo apt install openssh-server
$ sudo systemctl enable --now ssh
Source:
Как установить и настроить SSH в Ubuntu 22.04 - https://timeweb.cloud/tutorials/ubuntu/kak-ustanovit-i-nastroit-ssh-v-ubuntu-22-04
Task:
Добавьте новый ключ для безопасной авторизации по ssh
Decision:
$ ssh-keygen -t rsa -q -N '' -f ~/.ssh/tkey
$ cat .ssh/tkey.pub 
ssh-rsa ...tuser@tkey
$ ssh-copy-id -i ~/.ssh/tkey.pub tuser@tip
Source:
Создание SSH-ключей - https://beget.com/ru/kb/how-to/ssh/avtomaticheskaya-ssh-avtorizacziya-po-klyuchu#sozdanie-ssh-klyuchey
Task:
Создание пользователя
Decision:
$ cat /etc/passwd | grep tuser
tuser:x:1000:1000:Tuser,,,:/home/tuser:/bin/bash
$ sudo useradd -m -d /home/tuser1 -u 1001 -s /bin/bash Tuser1
$ cat /etc/passwd | grep tuser1
Tuser1:x:1001:1001::/home/tuser1:/bin/bash
$ sudo passwd Tuser1
$ id Tuser1
$ sudo usermod -aG sudo tuser1
Source:
Манипуляции с пользователями - https://www.inp.nsk.su/~bolkhov/teach/inpunix/setup_users.ru.html
Команда useradd - https://losst.pro/kak-sozdat-polzovatelya-linux
Task:
Переименовать пользователя в Linux (также переименовать группу и домашний каталог)
Decision:
$ sudo usermod -l tuser1 Tuser
$ sudo groupmod -n tuser1 Tuser
Source:
Изменить имя пользователя на Linux - https://itsecforu.ru/2020/04/29/%F0%9F%90%A7-%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%B8%D0%BC%D0%B5%D0%BD%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F-%D0%B2-linux/
Task:
Создать директорию или файл с пробелом в названии
Decision:
$ mkdir /mnt/Program\ Files
Task:
Скопировать файлы с теми же правами
Decision:
$ sudo cp -pr /var/lib/postgresql/14.backup /var/lib/postgresql/14/
Source:
копирование файлов с правами и пользователями - https://www.linux.org.ru/forum/general/8186570
Task:
Общие папки Linux
Decision:
$ sudo mkdir /var/share
$ sudo chmod ugo+rw -R /var/share
Source:
Общие папки в Linux - https://losst.pro/obshhie-papki-linux
Task:
Создать ссылку на директорию tdir1.
Decision:
$ mkdir tdir1
$ mkdir tdir2
$ touch tdir1/tfile1
$ ln -s /home/tuser/tdir1 /home/tuser/tdir2
Task:
Переименовать имя хоста
Decision:
$ hostname
thost1.twc1.net
$ sudo hostname thost.twc1.net
$ cat /etc/hosts
127.0.0.1 thost1.twc1.net
$ sudo vim /etc/hosts
$ cat /etc/hostname
thost1.twc1.net
$ sudo vim /etc/hostname
$ sudo cat /etc/hostname
thost.twc1.net
$ cat /etc/hosts
127.0.0.1 thost.twc1.net
$ sudo reboot
Source:
https://serverspace.ru/support/help/osnovnye-komandy-ufw/
 Task:
Установить vscode.
Decision:
$ wget https://vscode.download.prss.microsoft.com/dbazure/download/stable/903b1e9d8990623e3d7da1df3d33db3e42d80eda/code_1.86.2-1707854558_amd64.deb
$ sudo apt install ./code_1.86.2-1707854558_amd64.deb
Source:
Debian and Ubuntu based distributions - https://code.visualstudio.com/docs/setup/linux
Task:
Миграция виртуальных машин с Qemu-Kvm в VirtualBox
У руководителя уже установлена тестовая система Centos в машине Qemu-Kvm. Наша первая задача скоипровать у него систему 
Decision:
$ sudo virsh list --all
 ID   Имя           Состояние
-------------------------------
 2    Centos9       работает
 -    Alt           выключен
 -    Centos        выключен
 -    Kali          выключен
 -    ubuntu22.04   выключен
 -    Windows       выключен
$ sudo virsh shutdown Centos9
$ sudo virsh domblklist Centos9
 Назначение   Источник
---------------------------------------------------
 vda          /images/Centos9.img
 sda          -
$ rsync -avzP user@tipcentos:/images/Centos9.img Centos/.
$ sudo virsh dumpxml Centos9 > Centos9.xml
$ head Centos9.xml
<domain type='kvm'>
  <name>Centos9</name>
  <uuid>8cdbcba9-a955-4ca1-b75e-ab3145255c8d</uuid>
  <metadata>
    <libosinfo:libosinfo xmlns:libosinfo="http://libosinfo.org/xmlns/libvirt/domain/1.0">
      <libosinfo:os id="http://centos.org/centos-stream/9"/>
    </libosinfo:libosinfo>
  </metadata>
  <memory unit='KiB'>2097152</memory>
  <currentMemory unit='KiB'>2097152</currentMemory>
$ sudo head /etc/libvirt/qemu/Centos9.xml
<!--
WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE
OVERWRITTEN AND LOST. Changes to this xml configuration should be made using:
  virsh edit Centos9
or other application using the libvirt API.
-->
<domain type='kvm'>
  <name>Centos9</name>
  <uuid>8cdbcba9-a955-4ca1-b75e-ab3145255c8d</uuid>
$ sudo qemu-img info Centos9.img
image: Centos9.img
file format: qcow2
virtual size: 50 GiB (53687091200 bytes)
disk size: 50 GiB
cluster_size: 65536
Snapshot list:
ID        TAG               VM SIZE                DATE     VM CLOCK     ICOUNT
1         snapshot1             0 B 2023-09-28 13:18:14 00:00:00.000          0
Format specific information:
    compat: 1.1
    compression type: zlib
    lazy refcounts: true
    refcount bits: 16
    corrupt: false
    extended l2: false
Child node '/file':
    filename: Centos9.img
    protocol type: file
    file length: 50 GiB (53695545344 bytes)
    disk size: 50 GiB
$ sudo qemu-img convert Centos9.img tmp.bin -p
$ VBoxManage convertdd tmp.bin virtualbox.vdi
$ VBoxManage modifyvdi virtualbox.vdi compact
Task:
Обновление лицензии DrWeb
Decision:
Администрирование, менеджер лицензии, ОРГАНИЗАЦИЯ, распр-ть ключ на группы и станции, EveryOne,Заменить ключи
Task:
Для подготовки стенда:
1. Необходимо скачать архив по ссылке: courses-shop.zip (Зеркало: courses-shop.zip Яндекс.Диск)
2. Распаковать данный архив и перейти в появившуюся директорию courses-shop-prod в терминальной оболочке вашей ОС. Выполнить команду (при запущенном сервисе docker): docker-compose up -d. По адресу http://localhost:1337 появится приложение лабораторного стенда.
Возможные проблемы:
1. На некоторых компьютерах приложение может долго ожидать подключения к базе данных. Это зависит от мощностей вашего компьютера.
2. По той же причине бот (администратор приложения) может не запуститься, если база данных запускалась дольше 15 секунд. В таком случае вы можете перезагрузить сервис бота из папки приложения после загрузки базы данных командой:
docker-compose restart bot
Необходимо находиться в директории приложения, в одном месте с файлом docker-compose.yml
Проанализируйте защищенность механизмов аутентификации административной панели и проэксплуатируйте найденные уязвимости.
В качестве подтверждения успешной эксплуатации предоставьте флаг (секретную строку в формате 32 букв и цифр) из кода страницы панели администратора.
Вопрос для самопроверки на протяжении работы с данным лабораторным стендом:
Что опасного в этой информационной системе может сделать злоумышленник? Какие риски он мог бы реализовать?
Decision:
$ firefox https://disk.yandex.ru/d/bXfeC1DM4vrUsw
$ unzip Downloads/courses-shop.zip
$ cd courses-shop-prod
$ docker-compose up -d
$ firefox https://portswigger.net/burp/releases/professional-community-2023-9-4?requestededition=community&requestedplatform=
$ chmod ugo+x burpsuite_community_linux_v2023_9_4.sh
$ ./burpsuite_community_linux_v2023_9_4.sh
$ /home/tuser/BurpSuiteCommunity/BurpSuiteCommunity &
$ firefox https://github.com/empty-jack/YAWR/blob/master/brute/passwords/realyBest.txt 
Source:
1. https://portswigger.net/burp/documentation/desktop/getting-started/download-and-install
2. https://losst.pro/zapusk-skripta-sh-v-linux
Task:
Проанализируйте существующие поддомены основного домена компании cyber-ed.ru. Выявите домен, который похож на название домена для задания, и изучите его DNS TXT записи.
В качестве подтверждения успешной эксплуатации предоставьте флаг (секретную строку в формате 32 букв и цифр несвязного текста) из DNS записи типа TXT (Чтобы получить TXT записи для домена, выполните команду nslookup -q=TXT domain.name).
Decision:
$ google-chrome https://crt.sh/?q=cyber-ed.ru
$ nslookup -q=TXT task.cyber-ed.ru
Server:		tip.1
Address:	tip.1#53
Non-authoritative answer:
task.cyber-ed.ru	text = "FLAG=ОТВЕТ"
Authoritative answers can be found from:
Task:
Использование симметричного шифрования.
Давайте зашифруем и расшифруем данные с помощью симметричного метода. Для этого выполним команду gpg с опцией -c, которая сообщает, что нужно использовать симметричный режим шифрования. Далее указываем файл, который необходимо зашифровать. По умолчанию применяется алгоритм CAST5, который можно изменить с помощью опции --cipher-algo. Посмотреть доступные алгоритмы можно в выводе команды gpg --version (строка Cipher:).
Decision:
# vim myfile.txt
# cat myfile.txt
        --------SECRTET!!-------
        ---------=)------------
# ls -l
        -rw-r--r--. 1 root   root     49 апр 15 22:42  myfile.txt
# gpg -c myfile.txt
# ls -l
        -rw-r--r--. 1 root   root     49 апр 15 22:42  myfile.txt
        -rw-r--r--. 1 root   root    103 апр 15 22:44  myfile.txt.gpg
# cat myfile.txt.gpg
        ��%��A���V�O��κQ��S��gj�Vyv��cƒ�]��$[)8�]l��S�w�Z���ȝ���<�n�R��y�`W7'�F�⬚�m���
Task:
У меня есть Другая система Убунту, перенесем туда файл. После передачи файла в удаленную/другую систему его необходимо расшифровать. Для этого в команде gpg с помощью опции -o указываем имя для файла, которое будет после расшифровки, а с помощью опции -d указываем зашифрованный файл, который будем расшифровывать.
Decision:
# ls -l
        -rwxrwx--- 1 linux linux   103 апр 16 05:44  myfile.txt.gpg
# cat myfile.txt.gpg
        ��%��A���V�O��κQ��S��gj�Vyv��cƒ�]��$[)8�]l��S�w�Z���ȝ���<�n�R��y�`W7'�F�⬚�m���
# gpg -o myfile -d myfile.txt.gpg
    gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
    gpg: данные зашифрованы алгоритмом AES
    gpg: зашифровано одной фразой-паролем
# ls -l
        -rw-r--r-- 1 root  root     49 апр 16 06:04  myfile
        -rwxrwx--- 1 linux linux   103 апр 16 05:44  myfile.txt.gpg
Task:
Проверим содержимое файла. Как видим, это действительно оригинальный файл с первой машины Centos.
Decision:
# cat myfile
        --------SECRTET!!-------
        ---------=)------------
Task:
Использование асимметричного шифрования начинается с генерации пары ключей — открытого и секретного. Для этого используется команда gpg с опцией --gen-key:
Decision:
# gpg --gen-key
        gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.
        This is free software: you are free to change and redistribute it.
        There is NO WARRANTY, to the extent permitted by law.
        gpg: создан каталог '/root/.gnupg'
        gpg: создан щит с ключами '/root/.gnupg/pubring.kbx'
        Замечание: "gpg --full-generate-key" вызывает полнофункциональный диалог создания ключа.
        GnuPG должен составить идентификатор пользователя для идентификации ключа.
        Ваше полное имя: Admin3
        Адрес электронной почты: testAdmin3@mail.ru
        Вы выбрали следующий идентификатор пользователя:
            "Admin3 <testAdmin3@mail.ru>"
        Сменить (N)Имя, (E)Адрес; (O)Принять/(Q)Выход? o
        Необходимо получить много случайных чисел. Желательно, чтобы Вы
        в процессе генерации выполняли какие-то другие действия (печать
        на клавиатуре, движения мыши, обращения к дискам); это даст генератору
        случайных чисел больше возможностей получить достаточное количество энтропии.
        Необходимо получить много случайных чисел. Желательно, чтобы Вы
        в процессе генерации выполняли какие-то другие действия (печать
        на клавиатуре, движения мыши, обращения к дискам); это даст генератору
        случайных чисел больше возможностей получить достаточное количество энтропии.
        gpg: /root/.gnupg/trustdb.gpg: создана таблица доверия
        gpg: ключ 8EAEFED2A8D76C1E помечен как абсолютно доверенный
        gpg: создан каталог '/root/.gnupg/openpgp-revocs.d'
        gpg: сертификат отзыва записан в '/root/.gnupg/openpgp-revocs.d/CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E.rev'.
        открытый и секретный ключи созданы и подписаны.
        pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]
              CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        uid                      Admin3 <testAdmin3@mail.ru>
        sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]
Task:
Указываем идентификационный номер для ключа, по которому его можно будет отличить от других. Обычно это имя и e-mail адрес владельца ключа. Не всегда процесс генерации ключа идет гладко, чтобы это исправить нужно еще один консоль открыть и сделать активность в системе. Это для тех у кого консольная система. А если у вас графический интерфейс, можете просто мышкой потыкать. После этого должно пойти процесс генерации. После этого в каталоге ~/.gnupg/ будут созданы соответствующие файлы.
Decision:
ls -liR /usr/
ls -l ~/.gnupg/
Task:
Посмотреть ключи можно командой gpg с опцией --list-keys
Decision:
# gpg --list-keys
        gpg: проверка таблицы доверия
        gpg: marginals needed: 3  completes needed: 1  trust model: pgp
        gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u
        gpg: срок следующей проверки таблицы доверия 2022-04-16
        /root/.gnupg/pubring.kbx
        ------------------------
        pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]
              CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        uid         [  абсолютно ] Admin3 <testAdmin3@mail.ru>
        sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]
Task:
Перед использованием вашего публичного ключа другими пользователями его необходимо экспортировать. По умолчанию ключ экспортируется в бинарном формате, что не всегда удобно. С помощью опции --armor мы получим наш публичный ключ на консоль, откуда его можно скопировать и отправить по почте или выложить на свой сайт.
Decision:
# gpg --armor --export Admin3
        -----BEGIN PGP PUBLIC KEY BLOCK-----
        mQENBF6X83gBCACxdea4V0yruICk52BJ4/+i2h7iTLHSBINl4rDFWtFhYYDIjFAs
        BbW3tVT5Pd+vXQyFUD/fedP4n36OY8IrJB44jFGWZysuWYy4+WAQ0gyJh3GbkW6D
        QZ5QFOK3XHcijhK1ejCIWH6qPoVmLuY3KKKqb7Cm8Ufr06mhDO6hNVIPI62/2liv
        ws4g8HYRFqJvif1uhAvPZZUUwIckDnZnxci42wNgsgmVlo9DfXw919Y5M935jySY
        caTk5+yht4DzjwZzFz4cYaNUU1CPudG8rcoWemfiWvtCWwB8RD++chsO+JWizk6l
        PMnqUMq+ZxVIbpBZzPHccW5nLr/MINQ2KxzBABEBAAG0G0FkbWluMyA8dGVzdEFk
        bWluM0BtYWlsLnJ1PokBVAQTAQgAPhYhBM3qKHDgW/OWnvx8oY6u/tKo12weBQJe
        l/N4AhsDBQkDwmcABQsJCAcCBhUKCQgLAgQWAgMBAstrongBAheAAAoJEI6u/tKo12we
        roAIAI/v3/JkkBHDD9QjvHicooo60R52+U+Xdpr5gYnfMUgEPOjHQFwgrhXgvQrT
        Pxf4DMUa1TlbrEgThvOb+y4Q6P22jR7Nc/uy6ZIFsUPWif96kYoyKZX9tlvxXMmV
        IqbSrWdxF6rsEs/CaXKLNRj1bCwb8UPkDODlt1yv/A7Td0mhbKGgISXhZZYMgN6Q
        nrTwZoBZw65cCfGDGGjgGUYZkEZA0Lyke2quTxZjdkq4PHPSThX/eiTjHYgMY95r
        ScJDIMWpnJVeG3wDmWMXwOm+mCZKuRinvUGlyCDkzGDloV0O63FNDKaA1x6wIAyv
        Z8FLXUC0VNI7ZjfDVplUTkH5rHe5AQ0EXpfzeAEIAP6hXCx+24fXfzhOHjb/CVlY
        T7mVDzeWItkQ6gLfoBcidfMLA9pzx6IlchbCzbLGvZEQmpMFilkOGw6Et+2Nw6AG
        RMNRlgZ+PXptlElWTR4mnube5AODBPw+OwUsqogW9V+MSXFA7U6Cia+88jTFE8Zp
        9LJsdNM8vbYgS+X1vTJBLtO1cUQS/8B5ndvKJds5aqC/Lw7JA2UqIU1Eu9BenKKG
        h5NdVbwHwwAiYrYjSr0a/Gl2NPSqo1tfVSDhxkHBe8m+VZt7NffpDMYDdAgfk3At
        8WtuuwMRbVehMRcij8wdSOhVbBXtB5x86biqjKD+7QRM7iPFmIAii6uSsDGTik8A
        EQEAAYkBPAQYAQgAJhYhBM3qKHDgW/OWnvx8oY6u/tKo12weBQJel/N4AhsMBQkD
        wmcAAAoJEI6u/tKo12wevkkIAIL4tg4xRAbL1kDH2u01++3q4dc76JmwV96BuIe0
        O3BdsT8c0zdRRamfRNghI8SHxR42uXg+GnMrNOqOC9FQ7Fpd5Q3+XQxvEjGNrctN
        4YkwjTWQLstrongM8psB7L4fshXK/dEVlm9IGD3Y47+2K3Hrt13Ttt8DQmnTZEjPr3bZ
        29VeUWOqy/UV0ULxKYFqxHuIWmBycW4A3usLm4a0UGm6S6Z/5Yz0xdSIuvXD/2Rc
        CYyxynbLeIxw29LYqLBWATEfJQTkr0jJjkjDSWUd82nSSp9iSdhCQiVN7ytHgbxR
        ms4UCJxlkE2uoZ/VNMKoxFCLWdEsK3mI+f8BtCr2SmQwObY=
        =ooVe
        -----END PGP PUBLIC KEY BLOCK-----
Task:
В удаленной системе импортируем публичный ключ, чтобы мы его могли использовать. Для этого текст публичного ключа сохраняем в текстовый файл и передаем в качестве аргумента команде gpg. вставляем скопированный публичный ключ
Decision:
# vim box-key
# cat box-key
        -----BEGIN PGP PUBLIC KEY BLOCK-----
        mQENBF6X83gBCACxdea4V0yruICk52BJ4/+i2h7iTLHSBINl4rDFWtFhYYDIjFAs
        BbW3tVT5Pd+vXQyFUD/fedP4n36OY8IrJB44jFGWZysuWYy4+WAQ0gyJh3GbkW6D
        QZ5QFOK3XHcijhK1ejCIWH6qPoVmLuY3KKKqb7Cm8Ufr06mhDO6hNVIPI62/2liv
        ws4g8HYRFqJvif1uhAvPZZUUwIckDnZnxci42wNgsgmVlo9DfXw919Y5M935jySY
        caTk5+yht4DzjwZzFz4cYaNUU1CPudG8rcoWemfiWvtCWwB8RD++chsO+JWizk6l
        PMnqUMq+ZxVIbpBZzPHccW5nLr/MINQ2KxzBABEBAAG0G0FkbWluMyA8dGVzdEFk
        bWluM0BtYWlsLnJ1PokBVAQTAQgAPhYhBM3qKHDgW/OWnvx8oY6u/tKo12weBQJe
        l/N4AhsDBQkDwmcABQsJCAcCBhUKCQgLAgQWAgMBAstrongBAheAAAoJEI6u/tKo12we
        roAIAI/v3/JkkBHDD9QjvHicooo60R52+U+Xdpr5gYnfMUgEPOjHQFwgrhXgvQrT
        Pxf4DMUa1TlbrEgThvOb+y4Q6P22jR7Nc/uy6ZIFsUPWif96kYoyKZX9tlvxXMmV
        IqbSrWdxF6rsEs/CaXKLNRj1bCwb8UPkDODlt1yv/A7Td0mhbKGgISXhZZYMgN6Q
        nrTwZoBZw65cCfGDGGjgGUYZkEZA0Lyke2quTxZjdkq4PHPSThX/eiTjHYgMY95r
        ScJDIMWpnJVeG3wDmWMXwOm+mCZKuRinvUGlyCDkzGDloV0O63FNDKaA1x6wIAyv
        Z8FLXUC0VNI7ZjfDVplUTkH5rHe5AQ0EXpfzeAEIAP6hXCx+24fXfzhOHjb/CVlY
        T7mVDzeWItkQ6gLfoBcidfMLA9pzx6IlchbCzbLGvZEQmpMFilkOGw6Et+2Nw6AG
        RMNRlgZ+PXptlElWTR4mnube5AODBPw+OwUsqogW9V+MSXFA7U6Cia+88jTFE8Zp
        9LJsdNM8vbYgS+X1vTJBLtO1cUQS/8B5ndvKJds5aqC/Lw7JA2UqIU1Eu9BenKKG
        h5NdVbwHwwAiYrYjSr0a/Gl2NPSqo1tfVSDhxkHBe8m+VZt7NffpDMYDdAgfk3At
        8WtuuwMRbVehMRcij8wdSOhVbBXtB5x86biqjKD+7QRM7iPFmIAii6uSsDGTik8A
        EQEAAYkBPAQYAQgAJhYhBM3qKHDgW/OWnvx8oY6u/tKo12weBQJel/N4AhsMBQkD
        wmcAAAoJEI6u/tKo12wevkkIAIL4tg4xRAbL1kDH2u01++3q4dc76JmwV96BuIe0
        O3BdsT8c0zdRRamfRNghI8SHxR42uXg+GnMrNOqOC9FQ7Fpd5Q3+XQxvEjGNrctN
        4YkwjTWQLstrongM8psB7L4fshXK/dEVlm9IGD3Y47+2K3Hrt13Ttt8DQmnTZEjPr3bZ
        29VeUWOqy/UV0ULxKYFqxHuIWmBycW4A3usLm4a0UGm6S6Z/5Yz0xdSIuvXD/2Rc
        CYyxynbLeIxw29LYqLBWATEfJQTkr0jJjkjDSWUd82nSSp9iSdhCQiVN7ytHgbxR
        ms4UCJxlkE2uoZ/VNMKoxFCLWdEsK3mI+f8BtCr2SmQwObY=
        =ooVe
        -----END PGP PUBLIC KEY BLOCK-----
# ls -l
        -rw-r--r-- 1 root  root   1753 апр 16 09:02  box-key
# gpg --gen-key
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg (GnuPG) 2.2.4; Copyright (C) 2017 Free Software Foundation, Inc.
        This is free software: you are free to change and redistribute it.
        There is NO WARRANTY, to the extent permitted by law.
        Замечание: "gpg --full-generate-key" вызывает полнофункциональный диалог создания ключа.
        GnuPG должен составить идентификатор пользователя для идентификации ключа.
        Ваше полное имя: Client1
        Адрес электронной почты: testClient1@mail.ru
        Вы выбрали следующий идентификатор пользователя:
            "Client1 <testClient1@mail.ru>"
        Сменить (N)Имя, (E)Адрес; (O)Принять/(Q)Выход? o
        Необходимо получить много случайных чисел. Желательно, чтобы Вы
        в процессе генерации выполняли какие-то другие действия (печать
        на клавиатуре, движения мыши, обращения к дискам); это даст генератору
        случайных чисел больше возможностей получить достаточное количество энтропии.
        Необходимо получить много случайных чисел. Желательно, чтобы Вы
        в процессе генерации выполняли какие-то другие действия (печать
        на клавиатуре, движения мыши, обращения к дискам); это даст генератору
        случайных чисел больше возможностей получить достаточное количество энтропии.
        gpg: ключ 05A2E96C7147C8B8 помечен как абсолютно доверенный
        gpg: создан каталог '/home/linux/.gnupg/openpgp-revocs.d'
        gpg: сертификат отзыва записан в '/home/linux/.gnupg/openpgp-revocs.d/C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8.rev'.
        открытый и секретный ключи созданы и подписаны.
        pub   rsa3072 2020-04-16 [SC] [годен до: 2022-04-16]
              C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8
        uid                      Client1 <testClient1@mail.ru>
        sub   rsa3072 2020-04-16 [E] [годен до: 2022-04-16]
# gpg --import box-key
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: ключ 8EAEFED2A8D76C1E: импортирован открытый ключ "Admin3 <testAdmin3@mail.ru>"
        gpg: Всего обработано: 1
        gpg:               импортировано: 1
Task:
После импорта можно убедиться, что ключ действительно был импортирован. должен быть Dmitry и Eugeny. Для этого используется команда gpg --list-keys. A После импорта ключа его необходимо активировать, а для этого необходимо перейти в режим редактирования этого ключа. Вы попадете в специальный интерфейс.
Decision:
# gpg --list-keys
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: проверка таблицы доверия
        gpg: marginals needed: 3  completes needed: 1  trust model: pgp
        gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u
        gpg: срок следующей проверки таблицы доверия 2022-04-16
        /home/linux/.gnupg/pubring.kbx
        ------------------------------
        pub   rsa3072 2020-04-16 [SC] [годен до: 2022-04-16]
              C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8
        uid         [  абсолютно ] Client1 <testClient1@mail.ru>
        sub   rsa3072 2020-04-16 [E] [годен до: 2022-04-16]
        pub   rsa2048 2020-04-16 [SC] [годен до: 2022-04-16]
              CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        uid         [ неизвестно ] Admin3 <testAdmin3@mail.ru>
        sub   rsa2048 2020-04-16 [E] [годен до: 2022-04-16]
# gpg --edit-key Admin3
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg (GnuPG) 2.2.4; Copyright (C) 2017 Free Software Foundation, Inc.
        This is free software: you are free to change and redistribute it.
        There is NO WARRANTY, to the extent permitted by law.
        pub  rsa2048/8EAEFED2A8D76C1E
             создан: 2020-04-16  годен до: 2022-04-16  назначение: SC  
             доверие: неизвестно достоверность: неизвестно
        sub  rsa2048/764375B485FCFEAF
             создан: 2020-04-16  годен до: 2022-04-16  назначение: E   
        [ неизвестно ] (1). Admin3 <testAdmin3@mail.ru>
gpg> help
Task:
Для начала нужно вывести отпечаток ключа и сравнить его с отпечатком ключа из целевой системы. Можно позвонить к пользователю, попросить чтоб он сообщил отпечаток ключа и сравнить по телефону. F379 B9FC CC0E 825B 476E  E68B 6610 EC5A D37E 27AC - отпечаток ключа пользователя Eugeny. Если они совпадают, то все нормально, ключ можно верифицировать.
Decision:
gpg> fpr
        pub   rsa2048/8EAEFED2A8D76C1E 2020-04-16 Admin3 <testAdmin3@mail.ru>
         Отпечаток первичного ключа: CDEA 2870 E05B F396 9EFC  7CA1 8EAE FED2 A8D7 6C1E
gpg> sign
        pub  rsa2048/8EAEFED2A8D76C1E
             создан: 2020-04-16  годен до: 2022-04-16  назначение: SC  
             доверие: неизвестно достоверность: неизвестно
         Отпечаток первичного ключа: CDEA 2870 E05B F396 9EFC  7CA1 8EAE FED2 A8D7 6C1E
             Admin3 <testAdmin3@mail.ru>
        Срок действия данного ключа истекает 2022-04-16.
        Вы уверены, что хотите подписать этот ключ
        своим ключом "Client1 <testClient1@mail.ru>" (05A2E96C7147C8B8)?
        Действительно подписать? (y/N) y
gpg> check
Task:
На другом компьютере нужно будет проделать то же самое. Единственное отличие — имя ключа будет другим. получатель публикует ключ, копирует его.
Decision:
# gpg --armor --export Client1
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        -----BEGIN PGP PUBLIC KEY BLOCK-----
        mQGNBF6X9VwBDADIWL7gvO1KUpGLzzBewGbkyaBJGEhO3dMAtrGvP1xRcWXRgphK
        AJfVu1t4wIjfWhumv1jo6uE9phk9BHQkqmzCVlPdEOSYsuyP6jNkWQnuc4sNAIqA
        7bKMH9nccojJa7Ba67qx7Kp4jtzXRrdswr8h+ilimwZjpsKSasNZfAIE0XoBUyI+
        EZeEl8SPRyTe09R4kRLcgQgDhrTyUeU9Q2xaok6zeEl39HhivXibSu+/a3DzKOXV
        Q0gdrQZqciAUfxsd0ZNK8SSGWlNt18JMC/uCKFTqsLtaRo/oGMeZTltZzYBXoF5G
        yKakOlAnYKPF6T6RestT8lVOTNsRYfWxSOZFYKkD3gyq9AK6+rOG2ROUAQObAnJg
        DafERktkQQvDW3SB7VkQzJAy0OicaDSlFBdo43snBxAngWNZ/HXYLmw2Zoba4VGv
        /6iJ1AjaDNwu+9WkdNJ6KPQEb932R8wi0savVcfXAw/HNtIgpXT1zPlq3A0UaPpQ
        bW0ZFeAA7gvzDqsAEQEAAbQdQ2xpZW50MSA8dGVzdENsaWVudDFAbWFpbC5ydT6J
        AdQEEwEKAD4WIQTAp/4Bm7DUMMRly8oFoulscUfIuAUCXpf1XAIbAwUJA8JnAAUL
        CQgHAgYVCgkICwIEFgIDAQIeAQIXgAAKCRAFoulscUfIuLU2DACpir1O1XD8AlkR
        6DW+lQL0nJpVAIUo8z664gg0l4raU/EQqp//mxEdRR2jSTRbVj9YgPqqr34AIWqp
        FW7GL6erKpaP33UrKPcDUfZzf3a1t57+0GdulfoPAjxWpmqf11qjaKsJOHEqT2VE
        GvsumaqUvwUfvIfXchQgqpFDaxICk0YbAIub2T0nU49IcMxsF9Exsam3N2VUinlS
        6EPhuRYsbEUH9uTp29BHE8FQDjM4zyQS3nf3HX42snYGeexCx6KiR2MhCuv7VRS4
        VtmfknLv9zJq5z/NbsFSRse3xpVsaT4TdPIC73Dog92wmpwArYScaVy70vI2u78V
        rRDodxp17INMvTY42q5vJqwxgip792bkWGk6w1P/dvOBxJHcOWQa8P346pJOgdcW
        10vIle7bZQ77sWdtBOjpFxmyRo6QvaXlSaWKpoy/qHGX4/FM4LIn5ugVRd3YdBwV
        tJG/rCkduP/BmCggkGrUaCx6DekaGTqoyTsRTct9BPooT278b+q5AY0EXpf1XAEM
        AMRZ7ndZ60strongBBqi9RlAdDh35mouxcy9kv73WK24l7wnoQNq2QIHCkoCCiht7lqT
        AHNGk5cwuiov9hfRbZPbMVoc7444IoQ3D5Vj5tvkaqW3ey92hE0g4P0ITAK7/1MG
        OxZz26yPM/45MWvwlo7vz9QCGTp0hkpJG3fsdPISaV1r/vylD0zpKJ8Yotth07FR
        QmK5ck3vr/GWtP+tYR7JQnP1R+oFfcEi2cP8/VA/lry+I29yc04/wxjbxYqzB1nZ
        9nhJPCCEpWR3oIsrHaLMfTI4pUnguREO/Qv/gtmR2TZwJ2eAXsNJ0jvw4+F2crXk
        nGSxEru0+D2b2bsxN2Gj4JRXCli3sipg19lbTwZTeZFGmpg84OUIaTLjQi39DCFu
        l40lgd/Xvx797eOVeN/QWNwzxiFcDNDQTXcx9LBXRyDkKeCa+ZvDYvH3ezIvJcvi
        so3ZEBdJ5QIvEXzm8q3vbIf7yV1p4+hgw88J6jekIOUlJoHYMzpkJtgaPb6ZYrt4
        5wARAQABiQG8BBgBCgAmFiEEwKf+AZuw1DDEZcvKBaLpbHFHyLgFAl6X9VwCGwwF
        CQPCZwAACgkQBaLpbHFHyLgXRwwAswv05e7mKvYVUphP/ihSxZmEDy/R9DcZiSsI
        f4fWmypv9D5Y2YgCt/2NT3X6MUABAV12QGlwJlQBlRgV9rEExaiZ0p/g0QmK28Fa
        ZQ4+FS1S0+BuUso9MAFbam2Jk+hEFmCNhmK7thJlVgrcSDPppENn6/D4Lw6/WoI3
        8q6vMff7xxNYGjKnqU5aPlmNvff8FoxNYcLwmVk0y9tlI8l0g5c5LVsrRmnJXYPQ
        wtItiv6KzNtEKmbshObqf9gPZAnjLIC8sNytO/78NIJPR3JQyWMd6yudGosrg6NQ
        q0N2C9J5x1aBPPS9x6QvMfiOm2JewEqKSDQ3NEyW+V8y4jOwIr+9G3DLueMLPVPj
        MsAz4P7xxX00TKcYTa2DWlOW4z2kF8qoYPs1nuXWHAvRVQ+QJ0pop3VRZKXN3ZBw
        9pGyrirzjqEqk/1aJTsEK6kgpHDlg71B1ajcZ2pYiMsICnjBowXh87Xgrb/7wTr1
        yKDnyVYRcd3IECbxciuHX49/YffC
        =NM6e
        -----END PGP PUBLIC KEY BLOCK-----
# vim box-key
# ls -l
        -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key
        -rw-r--r--. 1 root   root     49 апр 15 22:42  myfile.txt
        -rw-r--r--. 1 root   root    103 апр 15 22:44  myfile.txt.gpg
# gpg --import box-key
        gpg: ключ 05A2E96C7147C8B8: импортирован открытый ключ "Client1 <testClient1@mail.ru>"
        gpg: Всего обработано: 1
        gpg:                  импортировано: 1
# gpg --edit-key Client1
        gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.
        This is free software: you are free to change and redistribute it.
        There is NO WARRANTY, to the extent permitted by law.
        pub  rsa3072/05A2E96C7147C8B8
              создан: 2020-04-16     годен до: 2022-04-16  назначение: SC  
             доверие: неизвестно достоверность: неизвестно
        sub  rsa3072/58859DC04AFB86B9
              создан: 2020-04-16     годен до: 2022-04-16  назначение: E   
        [ неизвестно ] (1). Client1 <testClient1@mail.ru>
gpg> fpr
        pub   rsa3072/05A2E96C7147C8B8 2020-04-16 Client1 <testClient1@mail.ru>
         Отпечаток первичного ключа: C0A7 FE01 9BB0 D430 C465  CBCA 05A2 E96C 7147 C8B8
gpg> sign
        pub  rsa3072/05A2E96C7147C8B8
              создан: 2020-04-16     годен до: 2022-04-16  назначение: SC  
             доверие: неизвестно достоверность: неизвестно
         Отпечаток первичного ключа: C0A7 FE01 9BB0 D430 C465  CBCA 05A2 E96C 7147 C8B8
             Client1 <testClient1@mail.ru>
        Срок действия данного ключа истекает 2022-04-16.
        Вы уверены, что хотите подписать этот ключ
        своим ключом "Admin3 <testAdmin3@mail.ru>" (8EAEFED2A8D76C1E)?
        Действительно подписать? (y/N) y
gpg> check
gpg> quit
Task:
Зашифруем файл myfile для пользователя Dmitry. Зашифрованный файл получит имя myfile.gpg. r - кто получатель, e - ecrypt операция шифрования
Decision:
# vim myfile
# cat myfile

        ---secret---
# gpg -o myfilenew.gpg -e -r Client1 myfile
        gpg: проверка таблицы доверия
        gpg: marginals needed: 3  completes needed: 1  trust model: pgp
        gpg: глубина: 0  достоверных:   1  подписанных:   1  доверие: 0-, 0q, 0n, 0m, 0f, 1u
        gpg: глубина: 1  достоверных:   1  подписанных:   0  доверие: 1-, 0q, 0n, 0m, 0f, 0u
        gpg: срок следующей проверки таблицы доверия 2022-04-16
# ls -l
        -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key
        -rw-r--r--. 1 root   root     13 апр 16 02:15  myfile
        -rw-r--r--. 1 root   root    478 апр 16 02:21  myfilenew.gpg
# cat myfilenew.gpg
        ��X���J���
                 �+��-$6ٌ�)r+9e��|>N�&�21ʸX��HJMuS�=����o��_��oi�h��:J��Q��U�Y[���5I��`
              {�6U����y$�n��    TS�>����NJ�Tc%���5{��=FW�xv�Zr�����N*��9�ڻ��r(h�x��[ŀ(ў*��~�x��|Sր��u�{
                                   ^���8YA���R&nI�����y�l9��!��yO/J�X�9���%u����q�2��ã%�k'u�i���؍�������g�X�v�bE5IP9�<�"���'�?b]��x���_`Y�Ԡ��I��M�6�B�\�C�h���Q�B�4@�;O�xbԽ��e��x/8\L's����*��)EU��x~�ά��`ȟ�    �BB���M� ,�>�&gkb�ǻ�
        �N�Խ����s��b��-ɘ%�
                         F;.܍5��zD\����
                                       �Kc|=O��:��s�
Task:
После этого зашифрованный файл можно свободно передавать по открытым каналам передачи данных. Файл сможет расшифровать только пользователь Dmitry с помощью своего секретного ключа. Передаем
Decision:
# scp myfilenew.gpg linux@tip.104:/home/linux 
        myfilenew.gpg                                 100%  478   167.8KB/s   00:00
# ls -l
        итого 112
        -rw-r--r-- 1 root  root   1753 апр 16 09:02  box-key
        -rw-r--r-- 1 linux linux   478 апр 16 09:55  myfilenew.gpg
Task:
Расшифровать файл пользователь Dmitry сможет командой, указанной ниже.
Decision:
# gpg -o myfile -d myfilenew.gpg
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: зашифровано 3072-битным ключом RSA с идентификатором 58859DC04AFB86B9, созданным 2020-04-16
              "Client1 <testClient1@mail.ru>"
# ls -l
        итого 116
        -rw-r--r-- 1 root  root   1753 апр 16 09:02  box-key
        -rw-r--r-- 1 root  root     13 апр 16 09:57  myfile
        -rw-r--r-- 1 linux linux   478 апр 16 09:55  myfilenew.gpg
# cat myfile
        ---secret---
Task:
Создание сертификата отзыва
Посмотрим ID публичного ключа, который мы отправим на публичный сервер ключей.
Decision:
# gpg --list-keys
        /root/.gnupg/pubring.kbx
        ------------------------
        pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]
              CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        uid         [  абсолютно ] Admin3 <testAdmin3@mail.ru>
        sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]
        pub   rsa3072 2020-04-16 [SC] [   годен до: 2022-04-16]
              C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8
        uid         [   полное   ] Client1 <testClient1@mail.ru>
        sub   rsa3072 2020-04-16 [E] [   годен до: 2022-04-16]
Task:
С помощью опции --keyserver указываем публичный сервер ключей, с помощью опции --send-key сообщаем, что ключ необходимо отправить на сервер.
Decision:
# gpg --keyserver pgp.mit.edu --send-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        gpg: отправка ключа 8EAEFED2A8D76C1E на hkp://pgp.mit.edu
Task:
После этого любой желающий может получить ваш публичный ключ с сервера ключей, просто указав его ID. Для получения ключа с сервера используется опция --recv-keys. ID ключа также можно выяснить по e-mail адресу владельца или его имени.
Decision:
# gpg --keyserver pgp.mit.edu --recv-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: ключ 8EAEFED2A8D76C1E: "Admin3 <testAdmin3@mail.ru>" не изменен
        gpg: Всего обработано: 1
        gpg:              неизмененных: 1
# gpg --keyserver pgp.mit.edu --search-key testAdmin3@mail.ru
        gpg: data source: http://pgp.mit.edu:11371
        (1)    Admin3 <testAdmin3@mail.ru>
              2048 bit RSA key 8EAEFED2A8D76C1E,      создан: 2020-04-16,    годен до: 2022-04-16
        Keys 1-1 of 1 for "testAdmin3@mail.ru".  Введите числа, N) Следующее; Q) Выход > Q
Task:
Представим ситуацию, что ваш секретный ключ скомпрометирован или просто потерян. Следовательно, больше нет смысла шифровать для вас данные публичным ключом из связки с этим личным ключом и его нужно отозвать. Генерируем сертификат отзыва. После выполнения команды будет создан файл eugeny.asc, это и есть сертификат отзыва.
Decision:
# gpg -o Admin3.asc --gen-revoke Admin3
        sec  rsa2048/8EAEFED2A8D76C1E 2020-04-16 Admin3 <testAdmin3@mail.ru>
        Создать сертификат отзыва данного ключа? (y/N) y
        Укажите причину отзыва:
          0 = Причина не указана
          1 = Ключ был раскрыт
          2 = Ключ заменен другим
          3 = Ключ больше не используется
          Q = Отмена
        (Скорее всего, Вы здесь выберете 1)
        Ваше Decision? 3
        Введите необязательное пояснение; завершите пустой строкой:
        >
        Причина отзыва: Ключ больше не используется
        (Пояснения отсутствуют)
        Все правильно? (y/N) y
        Для вывода использован текстовый формат ASCII.
        Сертификат отзыва создан.
        Поместите его в надежное место; если посторонний получит доступ
        к данному сертификату, он может использовать его, чтобы сделать
        Ваш ключ непригодным к использованию. Можно распечатать данный
        сертификат и спрятать подальше на случай, если Ваш основной
        носитель будет поврежден, но будьте осторожны: система печати
        Вашей машины может сохранить данные и сделать их доступными для других!
# ls -l
        -rw-r--r--. 1 root   root    478 апр 16 02:53  tip.104
        -rw-------. 1 root   root    548 апр 16 03:16  Admin3.asc
        -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key
        drwxr-xr-x. 2 root   root     45 апр  9 21:40  docs
        -rw-r--r--. 1 root   root     13 апр 16 02:15  myfile
        -rw-r--r--. 1 root   root    478 апр 16 02:21  myfilenew.gpg
Task:
Далее сертификат отзыва необходимо импортировать в вашу базу данных ключей. Публичный ключ отозван (revoked).
Decision:
# gpg --import Admin3.asc
        gpg: ключ 8EAEFED2A8D76C1E: сертификат отзыва "Admin3 <testAdmin3@mail.ru>" импортирован
        gpg: Всего обработано: 1
        gpg:           новых отзывов ключей: 1
        gpg: marginals needed: 3  completes needed: 1  trust model: pgp
        gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u
        gpg: срок следующей проверки таблицы доверия 2022-04-16
# gpg --list-keys
        /root/.gnupg/pubring.kbx
        ------------------------
        pub   rsa2048 2020-04-16 [SC] [    отозван: 2020-04-16]
              CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        uid         [   отозван  ] Admin3 <testAdmin3@mail.ru>
        pub   rsa3072 2020-04-16 [SC] [   годен до: 2022-04-16]
              C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8
        uid         [ неизвестно ] Client1 <testClient1@mail.ru>
        sub   rsa3072 2020-04-16 [E] [   годен до: 2022-04-16]
Task:
Загружаем отозванный ключ на публичный сервер ключей.
Decision:
# gpg --keyserver pgp.mit.edu --send-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        gpg: отправка ключа 8EAEFED2A8D76C1E на hkp://pgp.mit.edu
Task:
В удаленной системе, в случае желания получить ваш публичный ключ, будет принят сертификат отзыва. Теперь отозванный ключ нельзя будет использовать для шифрования данных.
Decision:
# gpg --keyserver pgp.mit.edu --recv-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: ключ 8EAEFED2A8D76C1E: добавлен сертификат отзыва "Admin3 <testAdmin3@mail.ru>"
        gpg: ключ 8EAEFED2A8D76C1E: "Admin3 <testAdmin3@mail.ru>" 1 новая подпись
        gpg: Всего обработано: 1
        gpg:         новых подписей: 1
# gpg --list-keys
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: проверка таблицы доверия
        gpg: marginals needed: 3  completes needed: 1  trust model: pgp
        gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u
        gpg: срок следующей проверки таблицы доверия 2022-04-16
        /home/linux/.gnupg/pubring.kbx
        ------------------------------
        pub   rsa3072 2020-04-16 [SC] [годен до: 2022-04-16]
              C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8
        uid         [  абсолютно ] Client1 <testClient1@mail.ru>
        sub   rsa3072 2020-04-16 [E] [годен до: 2022-04-16]
        pub   rsa2048 2020-04-16 [SC] [отозван: 2020-04-16]
              CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E
        uid         [   отозван  ] Admin3 <testAdmin3@mail.ru>
# gpg -o myfile.gpg -e -r Admin3 myfile
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: Admin3: пропущено: Нет открытого ключа
        gpg: myfile: encryption failed: Нет открытого ключа
Task:
Цифровая подпись файлов
Подписать файл myfile можно командой, указанной ниже. Подписанный файл будет сохранен под именем myfile.sig
Decision:
# gpg --gen-key
        gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.
        This is free software: you are free to change and redistribute it.
        There is NO WARRANTY, to the extent permitted by law.
        Замечание: "gpg --full-generate-key" вызывает полнофункциональный диалог создания ключа.
        GnuPG должен составить идентификатор пользователя для идентификации ключа.
        Ваше полное имя: Admin3
        Адрес электронной почты: testAdmin3@mail.ru
        Вы выбрали следующий идентификатор пользователя:
            "Admin3 <testAdmin3@mail.ru>"
        Сменить (N)Имя, (E)Адрес; (O)Принять/(Q)Выход? o
        Необходимо получить много случайных чисел. Желательно, чтобы Вы
        в процессе генерации выполняли какие-то другие действия (печать
        на клавиатуре, движения мыши, обращения к дискам); это даст генератору
        случайных чисел больше возможностей получить достаточное количество энтропии.
        Необходимо получить много случайных чисел. Желательно, чтобы Вы
        в процессе генерации выполняли какие-то другие действия (печать
        на клавиатуре, движения мыши, обращения к дискам); это даст генератору
        случайных чисел больше возможностей получить достаточное количество энтропии.
        gpg: ключ E2EF59C572C2FE68 помечен как абсолютно доверенный
        gpg: сертификат отзыва записан в '/root/.gnupg/openpgp-revocs.d/4D651D448FC062BFFC7602DCE2EF59C572C2FE68.rev'.
        открытый и секретный ключи созданы и подписаны.
        pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]
              4D651D448FC062BFFC7602DCE2EF59C572C2FE68
        uid                      Admin3 <testAdmin3@mail.ru>
        sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]
# gpg -o myfile.sig -s myfile
# ls -l
        -rw-r--r--. 1 root   root    478 апр 16 02:53  tip.104
        -rw-------. 1 root   root    548 апр 16 03:16  Admin3.asc
        -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key
        -rw-r--r--. 1 root   root     13 апр 16 02:15  myfile
        -rw-r--r--. 1 root   root    478 апр 16 02:21  myfilenew.gpg
        -rw-r--r--. 1 root   root    354 апр 16 03:38  myfile.sig
Task:
Проверить подпись в удаленной системе можно с помощью команды gpg с опцией --verify
Decision:
# gpg --verify myfile.sig
        gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'
        gpg: Подпись сделана Чт 16 апр 2020 10:38:31 MSK
        gpg:                ключом RSA с идентификатором 4D651D448FC062BFFC7602DCE2EF59C572C2FE68
Task:
Расшифровка файла myfile.sig
Decision:
#  gpg -o myfile -d myfile.sig
Task:
подписать текстовые файлы, в этом случае подпись будет добавлена в конец файла. Файл получит расширение asc.
Decision:
# gpg --clearsign myfile
# ls -l
        -rw-r--r-- 1 root  root    723 апр 16 10:50  myfile.asc
# cat myfile.asc
        -----BEGIN PGP SIGNED MESSAGE-----
        Hash: SHA512
        - ---secret---
        -----BEGIN PGP SIGNATURE-----
        iQGzBAEBCgAdFiEEwKf+AZuw1DDEZcvKBaLpbHFHyLgFAl6YDjIACgkQBaLpbHFH
        yLhfYgv/fUG4Uc1XWSqfdg39etdp5xIvVx1DUwxy+QNopHqd2MXps6Oe2+qJzLpk
        gthQRGSB60Xqgim2hwDEz0hoBrIoFMskuFpZo8JDOpxjR0fofPAp0i+t3z5ZVbjf
        0Mxp8xzvSnxqgx5bwv7Xew4WZwAdiBaOCWhdJ0mK32zxQ2OKClDODUH6XNLVG/iz
        ecVq3VRUUvkRJHj2q1auPsQm2kopp3kuuIYSub/IY+lsEe25fPj/wV+wmugmzExi
        YMj5j8RVMaJCvojJiso7C4+Fv78x9xazEeJlo+d9DTe/+N+O4HttJjGTlCcY1dxc
        QlMytIRnAmJVVioOI6lcG5lp0ZQ0o5M1rhuP53k9+q1o6n8vKPCj/lSK6wO77NYH
        liMFZaeNuL0XDKCbzNqFUTOgFbOo8vueZ1ob7Jq36V/VKz4lXhzOil20QCG8Mmrk
        3f/cM/KK6Oy2MWDEJyjVCHt2PhoiknES7mppvilFR1Plb4JSQPPMzXQ1WgsjAtoH
        RYFDq2Hc
        =YJ6J
        -----END PGP SIGNATURE-----
Task:
Также есть возможность получить цифровую подпись в отдельный файл. Впоследствии файл с подписью и оригинальный файл будут использоваться для того, чтобы верифицировать подпись.
Decision:
# gpg -o myfile.sig --detach-sig myfile
# gpg --verify myfile.sig myfile
        gpg: Подпись сделана Чт 16 апр 2020 03:53:06 EDT
        gpg:                ключом RSA с идентификатором 4D651D448FC062BFFC7602DCE2EF59C572C2FE68
        gpg: Действительная подпись пользователя "Admin3 <testAdmin3@mail.ru>" [абсолютное]
Task:
Уровень доверия к владельцам ключа
Уровень доверия показывает, насколько сильно вы доверяете владельцу указанного ключа. Изменить его можно, войдя в режим редактирования.
Decision:
# gpg --edit-key Client1
        gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.
        This is free software: you are free to change and redistribute it.
        There is NO WARRANTY, to the extent permitted by law.
        pub  rsa3072/05A2E96C7147C8B8
              создан: 2020-04-16     годен до: 2022-04-16  назначение: SC  
             доверие: неизвестно достоверность: неизвестно
        sub  rsa3072/58859DC04AFB86B9
              создан: 2020-04-16     годен до: 2022-04-16  назначение: E   
        [ неизвестно ] (1). Client1 <testClient1@mail.ru>
gpg> trust
        pub  rsa3072/05A2E96C7147C8B8
              создан: 2020-04-16     годен до: 2022-04-16  назначение: SC  
             доверие: неизвестно достоверность: неизвестно
        sub  rsa3072/58859DC04AFB86B9
              создан: 2020-04-16     годен до: 2022-04-16  назначение: E   
        [ неизвестно ] (1). Client1 <testClient1@mail.ru>
        Укажите, насколько Вы доверяете данному пользователю в вопросах проверки
        достоверности ключей других пользователей (проверяет паспорт,
        сверяет отпечатки ключей из разных источников и т.п.)
         1 = Не знаю или не буду отвечать
         2 = НЕ доверяю
         3 = Доверяю ограниченно
         4 = Полностью доверяю
         5 = Абсолютно доверяю
         m = вернуться в главное меню
Task:
Надежное удаление файлов
Для надежного удаления файлов используется программа shred, входящая в пакет coreutils. Потребность в удалении файла может возникнуть после создания его зашифрованной версии. Место на диске, где находится файл, перезаписывается в несколько проходов, и восстановить его практически невозможно.
Пример удаления файла. По умолчанию программа shred 25 раз перезаписывает то место, где находился файл.
Decision:
# shred -u -v myfile
        shred: myfile: проход 1/3 (random)…
        shred: myfile: проход 2/3 (random)…
        shred: myfile: проход 3/3 (random)…
        shred: myfile: удаление
        shred: myfile: переименован в 000000
        shred: 000000: переименован в 00000
        shred: 00000: переименован в 0000
        shred: 0000: переименован в 000
        shred: 000: переименован в 00
        shred: 00: переименован в 0
        shred: myfile: удалён

# ls -l
        -rw-r--r--. 1 root   root    478 апр 16 02:53  tip.104
        -rw-------. 1 root   root    548 апр 16 03:16  Admin3.asc
        -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key
        -rw-r--r--. 1 root   root     88 апр 16 02:17  myfile.gpg
        -rw-r--r--. 1 root   root    478 апр 16 02:21  myfilenew.gpg
        -rw-r--r--. 1 root   root    310 апр 16 03:53  myfile.sig
Source:
https://scabere.livejournal.com/62886.html?ysclid=lis5xg9t99308663826
Task:
Система безопасности PAM
Конфигурационные файлы для различных программ находятся в /etc/pam.d/.
Decision:
$ ls /etc/pam.d
    atd gdm-launch-environment polkit-1 sudo-i
    chfn gdm-password postlogin su-l
    chsh gdm-pin remote system-auth
    cockpit gdm-smartcard runuser systemd-user
    config-util liveinst runuser-l vlock
    crond login smartcard-auth vmtoolsd
    cups other sshd xserver
    fingerprint-auth passwd sssd-shadowutils
    gdm-autologin password-auth su
    gdm-fingerprint pluto sudo
Task:
выяснить, какие модули PAM присутствуют в системе.
Decision:
$ find / -name pam_*.so
    find: ‘/proc/12490’: No such file or directory
    find: ‘/proc/12491’: No such file or directory
    find: ‘/run/user/1000/gvfs’: Permission denied
    /usr/lib64/security/pam_cap.so
...
    /usr/lib64/security/pam_gnome_keyring.so
    /usr/lib64/security/pam_gdm.so
    /opt/VBoxGuestAdditions-6.1.4/other/pam_vbox.so
Task:
Запретим пользователю tuser1 с сервера с IP tipcentos подключаться по SSH к нашему серверу. В конце файла /etc/security/access.conf вписываем такую строку: - : tuser1 : tipcentos. Узнать IP можно с помощью ifconfig.
Decision:
$ su - tuser1
$ ifconfig
    ....
    inet tipcentos ...
    ...
$ exit
    logout
$ vim /etc/security/access.conf
$ cat /etc/security/access.conf
    # Login access control table.
    ...
    #-:ALL:ALL
    -:tuser1:tipcentos
$ cat /etc/pam.d/sshd
    #%PAM-1.0
    auth substack password-auth
    auth include postlogin
    account required pam_sepermit.so
    account required pam_nologin.so
    account include password-auth
    password include password-auth
    # pam_selinux.so close should be the first session rule
    session required pam_selinux.so close
    session required pam_loginuid.so
    # pam_selinux.so open should only be followed by sessions to be executed in the user context
    session required pam_selinux.so open env_params
    session required pam_namespace.so
    session optional pam_keyinit.so force revoke
    session optional pam_motd.so
    session include password-auth
    session include postlogin
$ vim /etc/pam.d/sshd
$ cat /etc/pam.d/sshd
    #%PAM-1.0
    auth substack password-auth
    auth include postlogin
    account required pam_sepermit.so
    account required pam_nologin.so
    account required pam_access.so
    account include password-auth
    password include password-auth
    # pam_selinux.so close should be the first session rule
    session required pam_selinux.so close
    session required pam_loginuid.so
    # pam_selinux.so open should only be followed by sessions to be executed in the user context
    session required pam_selinux.so open env_params
    session required pam_namespace.so
    session optional pam_keyinit.so force revoke
    session optional pam_motd.so
    session include password-auth
    session include postlogin
Task:
Теперь пользователь tuser1 не сможет подключиться к нашему серверу по SSH. В файле access.conf также есть много других примеров, которые можно использовать в своей ситуации. проверить подключение на другом компе.  Чтобы разрешить это, можно просто закомментить строку в файле.
Decision:
$ ssh tuser1@tipcentos
    The authenticity of host 'tipcentos (tipcentos)' can't be established.
    ECDSA key fingerprint is SHA256:18lZcodItzx9EW0IpFFs7S6p5/JzeQVp6w2DBhQ5ypI.
    Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
    Warning: Permanently added 'tipcentos' (ECDSA) to the list of known hosts.
    tuser1@tipcentos's password:
    Connection closed by tipcentos port 22
$ vim /etc/security/access.conf
$ cat /etc/security/access.conf
    # Login access control table.
    ...
    #-:ALL:ALL
    #-:tuser1:tipcentos
Task:
С помощью pam_limits.so для пользователя tuser1 сделаем следующие ограничения: максимальный размер файла – 20 Мб; приоритет для пользовательских процессов – 15.
Строки в конце файла /etc/security/limits.conf: tuser1 hard fsize 20000; tuser1 hard priority 15.
Decision:
$ vim /etc/security/limits.conf
$ cat /etc/security/limits.conf
    # /etc/security/limits.conf
    ...
    #@student - maxlogins 4
    tuser1 hard fsize 20000
    tuser1 hard priority 15
    # End of file
$ ssh tuser1@tipcentos
    The authenticity of host 'tipcentos (tipcentos)' can't be established.
    ECDSA key fingerprint is SHA256:18lZcodItzx9EW0IpFFs7S6p5/JzeQVp6w2DBhQ5ypI.
    Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
    Warning: Permanently added 'tipcentos' (ECDSA) to the list of known hosts.
    tuser1@tipcentos's password:
    Activate the web console with: systemctl enable --now cockpit.socket
    Last login: Wed Mar 25 23:07:16 2020
$ ls -lh
    итого 0
$ yes > file.txt
    File size limit exceeded (стек памяти сброшен на диск)
$ ls -lh
    итого 20M -rw-rw-r-- 1 tuser1 tuser1 20M мар 25 23:17 file.txt
Task:
Запускаем любой процесс, например, с помощью watch отслеживаем статистику программы free в реальном времени. С другой консоли посмотрим приоритет процесса watch.
Decision:
watch free
ps -C watch -o ni=
    15
Task:
устанавливаем касперский 
Decision: 
kes - setup
Указать имя сервера, записываем имя компа thost
netagent - setup
чтобы активировать касперский заходим через сервер в kasp Sec Center, комп, клиент компr, созд (пр кнопкой мыши), Маст добавл, клиент комп, thost
Task:
Рассмотрим легкий способ анонимной и конфиденциальной переписки на основе i2p + XMPP (протокол обмена сообщениями). Мы создаем свой XMPP сервер на нашем localhost и кинем все его хосты внутри сети i2p, который выделит нам криптографический адрес, по которому наш собеседник может вступить с нами в контакт.
Decision:
Всю реализацию буду делать внутри виртуальной машины. Cначала установим сервис i2p. В Ubuntu это делается так:
$ sudo add-apt-repository ppa:purplei2p/i2pd
$ sudo apt-get update
$ sudo apt-get install i2pd
В Центосе 8:
# curl -s https://copr.fedorainfracloud.org/coprs/r4sas/miniupnpc/repo/epel-8/r4sas-miniupnpc-epel-8.repo -o /etc/yum.repos.d/miniupnpc-epel-8.repo
# curl -s https://copr.fedorainfracloud.org/coprs/supervillain/i2pd/repo/epel-8/supervillain-i2pd-epel-8.repo -o /etc/yum.repos.d/i2pd-epel-8.repo
# yum install epel-release -y
# yum install i2pd -y
# systemctl enable i2pd
    Created symlink /etc/systemd/system/multi-user.target.wants/i2pd.service → /usr/lib/systemd/system/i2pd.service.
# systemctl start i2pd
После установки создаем серверный I2P туннель - это виртуальный адрес, по которому наш XMPP сервер будет доступен.
# find / -name tunnels.conf
    find: ‘/run/user/1000/gvfs’: Permission denied
    /etc/i2pd/tunnels.conf
    /usr/share/doc/i2pd/tunnels.conf
# cat /etc/i2pd/tunnels.conf
    [IRC-IRC2P]
    ...
    #[IRC-ILITA]
    ...
    #[SMTP]
    ...
    #[POP3]
    ...
    # see more examples at https://i2pd.readthedocs.io/en/latest/user-guide/tunnels/
дописываем следующие строки:
# vim /etc/i2pd/tunnels.conf
# cat /etc/i2pd/tunnels.conf
    [IRC-IRC2P]
    ...
    #[IRC-ILITA]
    ...
    #[SMTP]
    ...
    #[POP3]
    ...
    # see more examples at https://i2pd.readthedocs.io/en/latest/user-guide/tunnels/
    [prosody-s2s]
    type=server
    host=127.0.0.1
    port=5269
    inport=5269
    keys=prosody.dat
    [prosody-c2s]
    type=server
    host=127.0.0.1
    port=5222
    inport=5222
    keys=prosody.dat
Перезагружаем i2pd
# systemctl restart i2pd
Узнаем какой у нас будет криптографический адрес через браузер 127.0.0.1:7070. это и будет домен для вашего XMPP сервера, его надо будет сохранить.
Устанавливаем сервер XMPP под cвою ОС.
# yum list | grep prosody
    prosody.x86_64         0.11.5-1.el8       epel
# yum install prosody -y
    Последняя проверка окончания срока действия метаданных: 0:31:19 назад, Сб 06 июн 2020 01:21:39.
    Ошибка:
        Проблема: conflicting requests
        - nothing provides lua-filesystem needed by prosody-0.11.5-1.el8.x86_64
    (try to add '--skip-broken' to skip uninstallable packages or '--nobest' to use not only best candidate packages)
# yum list | grep lua-fi
    lua-fifo.noarch               0.2-2.el8           epel
# rpm -i http://mirror.C.org/C/8/PowerTools/x86_64/os/Packages/lua-filesystem-1.6.3-7.el8.x86_64.rpm
# yum list | grep lua-fi
    lua-filesystem.x86_64         1.6.3-7.el8         @System                                          
    lua-fifo.noarch               0.2-2.el8           epel
# yum install prosody -y
Устанавливаем lua библиотеку bit32
# yum list | grep lua
        ...
        lua5.1-basexx.noarch                                 0.4.0-2.el8 epel                                             
        lua5.1-binaryheap.noarch                             0.4-1.el8 epel                                             
        lua5.1-bitop.x86_64                                  1.0.2-5.el8 epel                                             
        lua5.1-compat53.x86_64                               0.7-3.el8 epel                                             
        lua5.1-cqueues.x86_64                                20190813-3.el8 epel
        lua5.1-fifo.noarch                                   0.2-2.el8 epel                                             
        lua5.1-http.noarch                                   0.3-5.el8 epel                                             
        lua5.1-lpeg.x86_64                                   1.0.2-1.el8 epel                                             
        lua5.1-lpeg-patterns.noarch                          0.5-4.el8 epel                                             
        lua5.1-luaossl.x86_64                                20190731-1.el8 epel                                           
        lua5.1-luv.x86_64                                    1.36.0.0-1.el8 epel
        lua5.1-luv-devel.x86_64                              1.36.0.0-1.el8                                    epel
        lua5.1-mmdb.noarch                                   0.2-2.el8                                         epel    lua5.1-mpack.x86_64                                  1.0.8-3.el8                                       epel   
        ...
# yum install lua5.1-basexx lua5.1-binaryheap lua5.1-compat53 lua5.1-bitop lua5.1-cqueues lua5.1-fifo lua5.1-http lua5.1-lpeg lua5.1-lpeg-patterns lua5.1-luaossl lua5.1-luv lua5.1-luv-devel lua5.1-mmdb lua5.1-mpack -y
Устанавливаем модуль mod_darknet в директорию модулей prosody.
# find / -name modules
    ...
    /usr/lib64/prosody/modules
    ...
# cd /usr/lib64/prosody/modules
# wget https://raw.githubusercontent.com/majestrate/mod_darknet/master/mod_darknet.lua
# ls -l
    ...
    -rw-r--r--. 1 root root 8478 июн 6 02:57 mod_darknet.lua
    ...
Теперь редактируем конфиг
# vim /etc/prosody/prosody.cfg.lua
В самом низу нужно прописать такой код (Замените xxx.b32.i2p на свой адрес, который мы сохраняли ранее):
# cat /etc/prosody/prosody.cfg.lua
    interfaces = { "127.0.0.1" };
    admins = { "admin@xxx.b32.i2p" };
    modules_enabled = {
        "roster"; "saslauth"; "tls"; "dialback"; "disco"; "posix"; "private"; "vcard";  "ping";  "register"; "admin_adhoc"; "darknet";
    };
    modules_disabled = {};
    allow_registration = false;
    darknet_only = true;
    c2s_require_encryption = true;
    s2s_secure_auth = false;
    authentication = "internal_plain";
    -- On Debian/Ubuntu
    daemonize = true;
    pidfile = "/var/run/prosody/prosody.pid";
    log = {
        error = "/var/log/prosody/prosody.err";
        "*syslog";
    }
    certificates = "certs";
    VirtualHost "xxx.b32.i2p";
    ssl = {
        key = "/etc/prosody/certs/xxx.b32.i2p.key";
        certificate = "/etc/prosody/certs/xxx.b32.i2p.crt";
    }
Генерируем сертификаты шифрования всталяя теже значения домена, которые мы сохраняли ранее
# openssl genrsa -out /etc/prosody/certs/xxx.b32.i2p.key 2048
    Generating RSA private key, 2048 bit long modulus (2 primes)
    ......................+++++
    ....+++++
    e is 65537 (0x010001)
# openssl req -new -x509 -key /etc/prosody/certs/xxx.b32.i2p.key -out /etc/prosody/certs/xxx.b32.i2p.crt -days 3650
    You are about to be asked to enter information that will be incorporated
    into your certificate request.
    What you are about to enter is what is called a Distinguished Name or a DN.
    There are quite a few fields but you can leave some blank
    For some fields there will be a default value,
    If you enter '.', the field will be left blank.
    -----
    Country Name (2 letter code) [XX]:
    State or Province Name (full name) []:
    Locality Name (eg, city) [Default City]:
    Organization Name (eg, company) [Default Company Ltd]:
    Organizational Unit Name (eg, section) []:
    Common Name (eg, your name or your server's hostname) []:
    Email Address []:
# chown root:prosody /etc/prosody/certs/*.b32.i2p.{key,crt}
# chmod 640 /etc/prosody/certs/*.b32.i2p.{key,crt}
Перезагрузите сервер prosody
# systemctl enable prosody
    Created symlink /etc/systemd/system/multi-user.target.wants/prosody.service → /usr/lib/systemd/system/prosody.service. 
# systemctl start prosody
Добавляем админский аккаунт
# prosodyctl adduser admin@xxx.b32.i2p
Теперь мы можем законектиться к нашему серверу через pidgin-клиент.
Если вы подключаетесь локально к серверу, то в настройках клиента указываем подключение к серверу 127.0.0.1 порт 5222. Если подключаетесь к серверу удаленно через I2P, то указывайте в настройках прокси Socks5 127.0.0.1:4447 При подключении нас предупредят, сертификаты шифрования самописные, так как мы сами их сгенерировали.
Теперь мы можем подлючить второго собеседника через вторую виртуальную машину. Также на ней установим шлюз i2p, который будет являться нашим локальным прокси i2p.
# add-apt-repository ppa:purplei2p/i2pd
# apt-get update
# apt-get install -y i2pd
# apt-get install -y pidgin
Вернемся в первую машину и создадим для нашего собеседника аккаунт на сервере
# prosodyctl adduser C@xxx.b32.i2p
Во второй машине проверяем
Указываем тут домен нашего сервера, порт 5222, укажем, что трафик должен идти через прокси типа SOCKS 5, который находится на localhost 127.0.0.1, порт - 4447. При подключении нас также предупредят,что сертификаты шифрования самописные, если все сделали правильно. Остается только запросить авторизацию наших собеседников для того, чтобы создать чат.
Source:
1. https://www.youtube.com/playlist?list=PLLqKATfceKNsptsrNP63TukGKETztvf1r
Task:
Пример работы инкапсуляции Модель OSI 
Decision:
- Представим ситуацию, что вы сидите у себя дома за компьютером, а в соседней комнате у вас свой локальный веб-сервер. И вот вам понадобилось скачать файл с него. Вы набираете адрес страницы вашего сайта. Сейчас вы используете протокол HTTP, которые работает на прикладном уровне. Данные упаковываются и спускаются на уровень ниже.
- Полученные данные прибегают на уровень представления. Здесь эти данные структурируются и приводятся в формат, который сможет быть прочитан на сервере. Запаковывается и спускается ниже.
- На этом уровне создается сессия между компьютером и сервером.
- Так как это веб сервер и требуется надежное установление соединения и контроль за принятыми данными, используется протокол TCP. Здесь мы указываем порт, на который будем стучаться и порт источника, чтобы сервер знал, куда отправлять ответ. Это нужно для того, чтобы сервер понял, что мы хотим попасть на веб-сервер (стандартно — это 80 порт), а не на почтовый сервер. Упаковываем и спускаем дальше.
- Здесь мы должны указать, на какой адрес отправлять пакет. Соответственно, указываем адрес назначения (пусть адрес сервера будет 192.168.1.2) и адрес источника (адрес компьютера 192.168.1.1). Заворачиваем и спускаем дальше.
- IP пакет спускается вниз и тут вступает в работу канальный уровень. Он добавляет физические адреса источника и назначения, о которых подробно будет расписано в последующей статье. Так как у нас компьютер и сервер в локальной среде, то адресом источника будет являться MAC-адрес компьютера, а адресом назначения MAC-адрес сервера (если бы компьютер и сервер находились в разных сетях, то адресация работала по-другому). Если на верхних уровнях каждый раз добавлялся заголовок, то здесь еще добавляется концевик, который указывает на конец кадра и готовность всех собранных данных к отправке.
- И уже физический уровень конвертирует полученное в биты и при помощи электрических сигналов (если это витая пара), отправляет на сервер.
Task:
Как посмотреть занятость места на разделах?
Decision:
$ sudo df -h
Task:
Пример работы деинкапусуляции Модель OSI 
Decision:
- На физическом уровне принимаются электрические сигналы и конвертируются в понятную битовую последовательность для канального уровня.
- На канальном уровне проверяется MAC-адрес назначения (ему ли это адресовано). Если да, то проверяется кадр на целостность и отсутствие ошибок, если все прекрасно и данные целы, он передает их вышестоящему уровню.
- На сетевом уровне проверяется IP адрес назначения. И если он верен, данные поднимаются выше. Не стоит сейчас вдаваться в подробности, почему у нас адресация на канальном и сетевом уровне. Это тема требует особого внимания, и я подробно объясню их различие позже. Главное сейчас понять, как данные упаковываются и распаковываются.
- На транспортном уровне проверяется порт назначения (не адрес). И по номеру порта, выясняется какому приложению или сервису адресованы данные. У нас это веб-сервер и номер порта — 80.
- На этом уровне происходит установление сеанса между компьютером и сервером.
- Уровень представления видит, как все должно быть структурировано и приводит информацию в читабельный вид.
- И на этом уровне приложения или сервисы понимают, что надо выполнить.
Task:
Чем роутер отличается от маршрутизатора?
Decision:
роутер и маршрутизатор — это одно и то же устройство. Однако под маршрутизатором часто подразумевают устройство для создания в первую очередь проводной сети, в то время как роутер — для беспроводной
Task:
Чем коммутатор отличается от маршрутизатора?
Decision:
Основные отличия коммутатора и маршрутизатора:
- Свитч проще с технической точки зрения и обладает ограниченной функциональностью.
- Маршрутизаторы сложнее устроены и могут анализировать объём информации, определять IP-адреса.
- Коммутаторы работают исключительно с MAC-адресами.
- Маршрутизаторам свойственен сетевой уровень модели OSI.
- Маршрутизаторы отличаются подключением к интернету.
- Для работы коммутатора и маршрутизатора нужен порт LAN, но последнее устройство также использует и WAN-порт.
Task:
Чем Active Directory отличается от Dns?
Decision:
Active Directory использует DNS как механизм поиска контроллеров домена и других объектов
Task:
Пример работы DNS
Decision:
Ввожу адрес. компьютер понимает только Ip адреса. Поэтому ему надо перевести ваш Url запрос в Ip. Компьютер сначала локально проверят хост файл. в линуксе это reslove. Если в файле прописан жанный адрес, то ответ отправляется пользователю, если нет то проверяется в Dns Серверах на регистрацию адреса. ВОзращается все это по протоколку http. 
Task:
Чем Tcp отличается от Udp?
Decision:
В Tcp отправляется пакет и ждет ответ. в Udp не ждет ответа. Udp используется для трансляции.
Task:
Чем Get отличается от Post?
Decision:
Запрос Get передает данные в Url через ссылку, а Post передает данные в теле запроса
Task:
Какая маска подсети этого Ip 10.20.0.0/23?
Decision:
Если 24 - последняя цифра отходит 255.255.255.0. В нашем случае - 255.255.254.0
Task:
В вашем распоряжении находится подсеть 192.168.1.0/30. Какие Ip адреса доступны для присвоения устройствам?
Decision:
Маска 30 означает, что подряд 30 единиц 11111111.11111111.11111111.11111100. значит ответ 192.168.1.1, 192.168.1.2.
Task:
Способы авторизации
Decision:
- двуфаторный
- по ключу
- по паролю
Task:
типы записей DNS
Decision:
- A записи могут принимать только IP-адрес в качестве значения,  Вы можете направить один и тот же домен / поддомен на несколько IP-адресов, просто добавив еще одну запись A с тем же именем, но с другим IP-адресом в поле “значение”.
- Запись AAAA (также запись quad-A) указывает адрес IPv6 для данного хоста. Таким образом, он работает так же, как запись A, и разница заключается в типе IP-адреса.
- Записи CNAME (Canonical Name Record - запись канонического имени) используется для создания псевдонима для существующей  A и AAAA записи. При этом в поле со значением заполняется именем домена, которое ранее было связано с IP-адресом в файле. Таким образом, разные адреса могут ссылаться на один и тот же сервер. Например, псевдоним «service.google.ru» может использоваться для указания на существующую A-запись «story.google.ru», где размещен сервис.
- Запись ресурса MX ( Mail Exchange - почтовый обмен)  используется специально для отправки электронной почты и указывает сервер обмена почтой для доменного имени DNS. Эта информация используется протоколом SMTP для маршрутизации электронной почты на соответствующие узлы. Здесь определен один или несколько почтовых серверов, которые принадлежат соответствующему домену. При использовании нескольких почтовых серверов (например, для компенсации сбоя), лучше сразу указать разные уровни приоритета. 
- Запись PTR является аналогом записи A. По сути это обратная запись A, где поле «имя» содержит информацию о IP-адресе, а поле «значение» содержит строку имени хоста. Запись PTR используется для сопоставления IP-адреса с соответствующим именем хоста, обычно используется для определения того, какое имя хоста использует указанный IP-адрес.
- Запись TXT или текстовая запись - это особый тип записи DNS. Он не используется для пересылки трафика, а используется для предоставления информации о домене. TXT может быть создан в любой зоне в виде статической или динамической записи. Поле «имя» и поле «значение» могут быть заполнены чем угодно, как того требует программа или протокол. TXT запись часто используется для подтверждения владение доменом ( например, при добавлении Google-метрики на сайт).
- Запись SRV или служебная запись - это тип DNS-записи, используемой для указания служб. Запись SRV предоставляет информацию о том, какие службы доступны в определенной зоне или домене. Запись SRV имеет формат для поле «имя», где она начинается с имени службы, имени протокола, а затем имени зоны или домена. А поле  «значение» будет содержать несколько сведений, таких как приоритет, вес, номер порта службы и имя хоста, на котором находится служба.
- NS запись - это DNS-запись, основная ее цель связывать домен и хостинг, в ней  содержится список доверенных серверов имен для домена. Для этого нужно добавить в запись NS-сервера, которые предоставляет Ваш текущий хостинг провайдер для той или иной услуги. Минимум может быть два NS-сервера
- SOA запись или Start of Authority - это запись DNS, которая содержит имя сервера, на котором хранится вся информация, касающаяся этой записи. Он включает в себя достоверную информацию, такую как идентификационный номер сервера, ответственный почтовый адрес, основной сервер имен и т. д. Предполагается, что сервер, на который есть ссылка в записи SOA, отвечает за любой процесс в соответствующей записи.
Task:
Есть консольная программа для Linux, которая должна вывести результат работы в терминал. Но после запуска никакого вывода не происходит и вы снова видите системное приглашение консоли. Перечислите порядок действий дя выявления причин и инструменты, которыми воспользуетесь для решения данной проблемы.
Decision:
Если код закрыт, то надо перенаправить весь вывод на стандартный:
filename &2>&1
это перенаправляет поток ошибок stderr на стандартный вывод stdout.
А если открыт, то уже смотреть по самому коду скрипта или исполняемого файла.
Проверить штатность поведения - код возврата:
./app; echo $?
если не 0, то посмотрел бы в dmesg на предмет segfault. Может оно просто тихо падает. Потом попробовал бы почитать man, запустил бы с ключом --help или -h. Исключив segfault, запустил бы её через strace, чтобы посмотреть, что она вообще пытается сделать.
Task:
Как создать простое зашифрованное сообщение с помощью командной строки?
Decision:
Использовать OpenSsl для шифрования потока текста в текстовый файл, который содержит зашифрованный текст Aes-256 с использованием ключа доступа
Task:
Как обеспечить надежную работу сайта?
Decision:
Установить Ssl сертификат для безопасности url - https.
Task:
Чем Dos Атака отличается от DDos?
Decision:
DoS-атаки используют всего один хост для перегрузки системы, есть косвенные признаки, по которым их можно отличить от DDoS. Они менее эффективны и более заметны: когда запросы приходят с одного IP-адреса источника, системному администратору становится очевидна их нелегитимность. Как следствие — DoS-атаки гораздо проще подавить, ведь достаточно использовать брандмауэр. 
Task:
Как оркестрации ты знаешь для микросервисов?
Decision:
Оркестрация микросервисов в контексте разработки программного обеспечения и архитектуры микросервисов относится к координации, управлению и контролю взаимодействий и процессов между независимыми микросервисами.
- Kubernetes (K8s) — это открытое программное обеспечение для автоматизации развёртывания, масштабирования и управления контейнеризированными приложениями.
- Amazon ECS - упрощает развертывание контейнеров Docker и управление ими в любом масштабе. 
Task:
Какие характеристики микросервисов ты знаешь?
Decision:
- Все разбито на маленькие компоненты. Например, есть компонент для веб-сервера, есть компонент, который показывает другу страницу и есть компонент, который обращается к базе данных.
- Если что-то ломается, это не страшно, когда есть другие микросервисы.
- Все данные должны сохраняться в какой-нибудь БД, а не в микросервисах.
Task:
Какие решения для CI/CD ты знаешь?
Decision:
- jenkins - программная система, предназначенная для обеспечения процесса непрерывной интеграции программного обеспечения
- gitlab CI - встроенный инструмент, для автоматизации рутинных задач, возникающих в процессе разработки ПО.
Task:
Когда нужно использовать Terraform модули?
Decision:
Когда есть повторяющийся код. Это более удобное решение нескольких ресурсов.
Task:
Тебе нужно соответствовать Rpo 2 часа. Как часто нужно делать Backup?
Rpo
Decision:
Каждые 2 часа
Task:
Пример Rpo/Rto 
Decision:
Раз в день в 1:00 делаете бэкап. в 12:00 сгорает сервер. Поставил новый компьютер, установил ОС, программы и восстанавили бэкап. в 17:00 - полное восстановление. 
Время от последнего бэкапа - Rpo, а время до восстановления - rto. Если организация хочет Rpo 1 час - бэкап надо делать каждый час, а для 1 часа нужно автоматическое создание серверов. Можно сделать реплику потерю данных Rpo на другой сервер. 
Task:
В розетке можно подключить подключить одну витую пару. Но нужно разделить на две витые пары розетку для двух компьютеров.
Decision:
Коммутатуратор вход 1 - 1бо,2о,3бз,6з
Коммутатуратор вход 2 - 1с,2бс,3бк,6к
Патч панель - 1бо,2о,3бз,4с,5бс,6з,7бк,8к
Розетка комп 1 - 1бо,2о,3бз,6з
Розетка комп 2 - 4бо,5о,7бз,8з
Комп 1 - 1бо,2о,3бз,4с,5бс,6з,7бк,8к
Комп 2 - 1бо,2о,3бз,4с,5бс,6з,7бк,8к
Task:
Чем приватный отличается от публичного ключа?
Decision:
Мы можем сгенерировать два ключа - приватный и публичный. После чего закинуть публичный ключ на все свои сервера и подключаться к ним без пароля, используя приватный ключ. Это говорит о том, что приватный ключ нужно беречь,
Админ закидывает публичный ключ на сервера, в домашнюю директорию пользователей, к которым будет подключаться. И при следующем подключении демон ssh увидит наличие подходящего ключа у пользователя и аутентифицирует его.
Task:
Как сгенерировать ssh ключа?
Decision:
Для начала нужно сгенерировать ключи, это делается на стороне клиента, т.е. у администратора. Для генерации ключей используется команда ssh-keygen. По умолчанию ключи и в целом настройки клиента ssh хранятся в домашней директории пользователя, в скрытой директории .ssh. А ключи, по умолчанию, называются id_rsa. По хорошему, когда у нас много серверов, мы можем создать различные ключи и для подключения к разным серверам использовать разные ключи. Тут нажмём enter, чтобы использовать название по умолчанию. Дальше у нас спрашивается пароль для ключа. Так как ssh ключи позволяют заходить на сервера без пароля, они могут быть очень опасны, если попадут в руки злоумышленникам. Поэтому мы можем защитить приватные ключи паролем. При использовании ключа нам нужно будет вводить пароль от ключа, но, если у нас украдут этот ключ, без пароля хакеры ничего не сделают. Для нашего примера мы не будем использовать пароль, чтобы было нагляднее. Поэтому нажимаем два раза Enter и ключ создаётся. Мы видим, что создались два файла - id_rsa и id_rsa.pub - приватный и публичный ключ соответственно. Также внизу есть эдакая картинка, визуализирующая ключ. На самом деле это больше нужно для ключей хоста - вы можете настроить так, чтобы при подключении к серверам вы видели ключ хоста в таком виде. Если вдруг ключ хоста изменится или кто-то встанет посреди трафика, ключ будет другой и визуально вы сразу заметите разницу.
У нас есть ключи, теперь мы можем закинуть наш публичный ключ на какой-нибудь сервер и проверить. Используем эту же виртуалку и пользователя root. Самый простой способ закинуть ключ - команда ssh-copy-id.
Если не использовать никакие опции, она найдёт дефолтный ключ id_rsa.pub и закинет его. При этом, чтобы закинуть ключ, ssh подключается на этот сервер к пользователю, поэтому он попросит пароль пользователя. После чего добавит ключ и предложит нам проверить.
На этот раз никакого пароля не потребовалось, мы можем аутентифицироваться по ключу.
Посмотрим появившиеся файлы, для начала у клиента. В директории .ssh у нас 3 файла - два ключа и файл known_hosts.
Ключи представляют из себя текстовые файлы с непонятным набором символов. А в файле known_hosts указаны адреса, к которым мы подключались, а также отпечатки их ключей. Именно по этому файлу наш клиент будет понимать, изменились ли у сервера ключи или нет.
На сервере, в домашней директории пользователя, к которому я закинул ключ, также появилась директория .ssh с файлом authorized_keys
В этот файл будут попадать публичные ключи пользователей, т.е. это результат команды ssh-copy-id. На самом деле, хоть и не понятно в терминале, в этом файле сейчас одна строчка с одним ключом. Этот тот же id_rsa.pub. Если кто-то ещё добавит ключ, то он будет на второй строчке, т.е. один ключ - одна строчка.
Task:
Принцип работы SElinux
Decision:
SELinux расширяет возможности стандартной системы безопасности (на основе прав доступа к файлам). Она позволяет ограничить доступ процессу, который запускается от имени пользователя, у которого прав больше, чем нужно данному процессу. Чтобы понять наглядно принцип работы SELinux, рассмотрим контекст безопасности — сочетание сущности, роли, домена и категории (не обязательно).
Source:
Принцип работы - https://www.dmosk.ru/miniinstruktions.php?mini=selinux-setting&ysclid=lw1jsobk8866859354
Принудительный контроль доступа - SElinux - https://basis.gnulinux.pro/ru/latest/basis/45/45._%D0%9F%D1%80%D0%B8%D0%BD%D1%83%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_-_SElinux.html